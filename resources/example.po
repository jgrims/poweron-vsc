[**********************************************************************
 Redwood Credit Union - All rights reserved

 Program Name:  SW.DISPUTE
 Written By  :  SBW
 Date        :
 Requested By:
 Department  :
 Track IT #  :

 Frequency   :

 Run Requirements:  This is a complex system of repgens and modified symform code.  Please
   use extreme caution when modifying any of these files, especially SymForms!!  Symforms without the
   ".DRIVER" extension are the "native" symforms and ONLY HAVE PRINT-BLANK capabilities.  Symforms WITH 
   the ".DRIVER" extension are the modified versions that work within this dispute repgen and will populate
   forms based on entries from the main repgen (SW.DISPUTE)  Modifying either will require modifications to
   both file types.
 
 Repgens, Letterfiles, Helpfiles & include files that are executed or used by 
                   this demand repgen include:
                   
Repgens/Include Files required for this process:
-----------------------        
SW.DISPUTE           
SW.DISPUTE.DEF
SW.DISPUTE.PRO

DISPUTE.SYMFORM.PROC
DISPUTE.SYMFORM.DEF

AS1307.DRIVER
AS1307.SYMFORM
AS1307.INC
AS1307

AS1306.DRIVER
AS1306.SYMFORM
AS1306.INC
AS1306

AS1310.DRIVER
AS1310.SYMFORM
AS1310.INC
AS1310

AS1312.DRIVER
AS1312.SYMFORM
AS1312.INC
AS1312

LP1308.DRIVER
LP1308.SYMFORM
LP1308.INC
LP1308

LP1311.DRIVER
LP1311.SYMFORM
LP1311.INC
LP1311

Helpfiles:
----------
SW.CSS

Letterfiles:
---------------
DISPUTE.NUMBERS
DISPUTE.DEBUG+  <----HAS CLAIM NUMBER APPENDED TO LETTERFILE NAME

Repgens/SymForms Executed by this Repgen:
------------------------------------------
JIB.CREATE.CARD
SW.RES.REQ
JIB.MISSINGATMDEP
LR1314
CS230
ES315
AS316


 **********************************************************************

 Description :

 
 **********************************************************************

 Modification History:

 Date      Prog   Description
 --------  ----   -----------------------------------------------------
 01/24/14  sbw    Changes for Patch 3
 02/05/14  sbw    Patch 4
 02/13/14  SBW    Update to include call for LR1314
 02/20/14  sbw    Update to launch service center dispute form CS230
 02/24/14  SBW    Fix for card names not showing for cards above #10
 02/27/14  SBW    Created manual entry mode for LP staff
 03/25/14  SBW    Change email for RCU ATM to mailelectronicservices
 04/15/14  SBW    Change verbiage displayed for older ACH in txn lists. (in DISPUTE.PRO)
 06/03/14  SBW    Change order of ATM email to send email before launching form. T24345
 09/03/14  SBW    Remove "email forms" button T25369
 09/25/14  sbw    Update in SW.DISPUTE.PRO to prevent credits from being able to be 
                   selected for dispute. T25640
 03/12/15  sbw    Several changes to allow for crediting members instantly, suppress some
                   dispute options. Send CAMS info to DB, do secondary prompt to verify
                   card number.      
 03/26/15  sbw    Modify restriction for # of claims receiving instant credit per month 
                   to tighten it down to 3 instead of 4. (PROG-989)
                  Fix issue with Corp VISA Card claims hitting DB as Debit (PROG-929)        
 04/09/15  sbw    Change transaction record 'claim status' fields to match whatever is
                   being sent in claim header claim status field, for all claim types. (PROG-1041)
 03/26/15  grc    Reverted this back to SW.DISPUTE due to clobbering issue on AS316 vs. 316.
                  Added email change to "MCardSecurity@redwoodcu.org".   
 09/10/15 SBW     Integrated updates from Doug Petrosky to fix lost records on DB send.
                   Changes are in this driver and also SW.DISPUTE.PRO    
 09/16/16  grc    Changed "From" email address from MCardSecurity to noreply. (i.e. *not* CREDITEMAIL) (PROG-3170)   
 10/05/16 sbw     Minor change - APPPATH server URL changed from "webapps:160" & "webapps:150" to "disputes-test" & "disputes"            
 10/11/16  sbw    Modifications (also in SW.DISPUTE.PRO) to change dispute limit from $75 to $49.99; also
                    modify status descriptor sent to DB to match. 
 12/06/17 sbw     Reverse last update and set dispute limit to $74.99. Also in .PRO  PROG-5233    
 01/04/18 JWG		Changes for Claims 
 04/10/18  SBW    Update in SW.DISPUTE.PRO for adding HSA debit card, and blocking 
                   automatic provisional credit on HSA accounts. PROG-5585                                                     
 **********************************************************************]

SUBROUTINE DEMAND
WINDOWS
TARGET=ACCOUNT

DEFINE
 
 #INCLUDE "JIB.TRACK.REPGEN.DEF"
 #INCLUDE "RD.GETDATA.DEF"
 #INCLUDE "SW.DISPUTE.DEF"
 
 [INCLUDES FOR SYMFORMS BEGIN HERE]
  #INCLUDE "RD.NAME.AND.ACCOUNT.DEF"
  #INCLUDE "RD.SYMFORM.DEF"
  #INCLUDE "JIB.SIGPAD.DEF"
  #INCLUDE "SW.SYMFORM.DEF"  
  #INCLUDE "DISPUTE.SYMFORM.DEF"
  
  POSTBACKFILE = CHARACTER
  PBERROR      = CHARACTER
  DUMMY = CHARACTER 
END

SETUP
 TRACKFILENAME="SW.DISPUTE"
 #INCLUDE "JIB.TRACK.REPGEN"
 
 [SETUP FILE FOR SYMFORMS]
 #INCLUDE "SW.SYMFORM.SU"
 
 TESTMODE=ON  ["ON" WRITES TO LETTERFILE; "OFF" DOESN'T WRITE TO LETTERFILE]
                            
 IF SYSSYMDIRECTORY<>0 THEN TESTMODE=ON
 
 IF SYSSYMDIRECTORY<>0 THEN 
  APPPATH="http://disputes-test/recordinput.aspx"      [testing path]  [was webapss:160]
 ELSE
  APPPATH="http://disputes/recordinput.aspx"        [live path]  [was webapps:150]

 LOCKED=OFF [WHILE LOCKED=ON, ONLY USER BELOW CAN RUN THIS. FOR LOCKING OUT TESTERS DURING CODE CHANGES]
              [LOCKED=OFF IS NORMAL FUNCTIONAL MODE]
 IF LOCKED=ON AND SYSUSERNUMBER<>797 THEN 
  DO
   DIALOGSTART("Repgen locked",100%,0)
   DIALOGINTROTEXT("This repgen has been locked due to programming changes!!")
   DIALOGINTROTEXT("You can't run this until programming is complete - thank you for your patience.")
   DIALOGINTROTEXT("Contact support desk and ask for programming help if you believe this has been locked in error")
   DIALOGINTROTEXT("This process will now terminate.")
   DIALOGDISPLAY
   DIALOGCLOSE
   TERMINATE
  END
  
 [FOR RCU ATM EMAIL]
 RCUATMEMAIL="MailElectronicServices@redwoodcu.org"
 IF SYSSYMDIRECTORY<>0 THEN 
  DO
   RCUATMEMAIL="scabrera@redwoodcu.org" ["CBalch@redwoodcu.org" ]    ["MailElectronicServices@redwoodcu.org"  ]
   IF SYSUSERNUMBER=797 THEN RCUATMEMAIL="SWalker@redwoodcu.org"
  END 
 
 LOWDATE=DATEOFFSET(SYSTEMDATE,-24,0)
 HIGHDATE=DATEOFFSET(SYSTEMDATE,24,0) 
  
 [FOR CREDITING MEMBERS]
 DISPUTELF="DISPUTE.RESOLUTION.LTR"
 FRAUDLF="DISPUTE.PROVISIONAL.LTR"
 DISPUTELOCK="DISPUTE.LTR.LOCK"
 FRAUDLOCK="FRAUD.LTR.LOCK"
 DELIM=CTRLCHR(9)
  
 CLAIMCOUNT=0		[COUNT OF CLAIMS IN LAST 30 DAYS, INCL. EXPIRED; all claim types (fraud/dispute)]  
 CREDITEMAIL="MCardSecurity@redwoodcu.org"
 IF SYSSYMDIRECTORY<>0 THEN 
  DO
   CREDITEMAIL="scabrera@redwoodcu.org" ["swalker@REDWOODCU.ORG"]
   IF SYSUSERNUMBER=797 THEN CREDITEMAIL="SWalker@redwoodcu.org"
  END
 LOSSGL="87350000000000"
 SWEEPGL="87000200000000"
 CLAIMGL="76900000000000"
 SWEEPGLCODE=73  [870002.00 - for sweeping funds through to get CAMS in GL comment area]
 CLAIMGLCODE=180  [769000.00 - for claims w/total amount up to DISPUTELIMIT]
 LOSSGLCODE=80  [873500.00 - for claims w/total amount over DISPUTELIMIT and up to FRAUDLIMIT]
 DISPUTELIMIT=$74.99  
 FRAUDLIMIT=$1,500.00
 
 CALLCREATECARD=FALSE
 
 FOR X=PINBASED TO SIGBASED
  DO
   CLAIMTOT(X)=$0.00
   CREDITTYPE(X)=0       [0 = UN SET,  1/DISP = DISPUTE, 2/FRAUD=FRAUD]
   GIVECREDIT(X)=-1  [start at neither true nor false; once set to false should not ever turn true]
  END
  
 ISEMPLOYEE=FALSE 
 IF (ACCOUNT:TYPE=1 OR  [EMPLOYEE]
     ACCOUNT:RESTRICT=3 OR  [EMPLOYEE RESTRICT]
     ACCOUNT:RESTRICT=5) THEN [EMPLOYEE SENSITIVE]
  ISEMPLOYEE=TRUE  
   
 Q=CTRLCHR(34)	[DOUBLE QUOTE]

 ACTNUM=ACCOUNT:NUMBER
 FOR EACH LOOKUP WITH LOOKUP:TYPE=20 AND LU20=""
  DO
   LU20="@"+LOOKUP:NUMBER
  END 
  
 DEPARTMENTNAME="Fraud and Security" 
 
 ISBUSINESS=FALSE
 IF ACCOUNT:TYPE=8 THEN ISBUSINESS=TRUE
 THISBRANCH=GETDATANUMBER(GETCONSOLEBRANCH,SYSCONSOLENUM)
 THISUSER=SYSUSERNUMBER
 
 ISFRAUDDEPT=FALSE
 IF THISBRANCH=76 OR THISBRANCH=82 OR  [LOSS RECOVERY & COLLATERAL; AUDIT & SECURITY]
    (SYSSYMDIRECTORY<>0 AND SYSUSERNUMBER=797) THEN
  DO
   ISFRAUDDEPT=TRUE
   [
   GIVECREDIT(PINBASED)=FALSE
   GIVECREDIT(SIGBASED)=FALSE
   NOCREDITREASON(PINBASED)="Claim manually entered by Fraud staff."
   DBNOCREDITREASON(PINBASED)="Claim manually entered by Fraud staff."
   NOCREDITREASON(SIGBASED)="Claim manually entered by Fraud staff."
   DBNOCREDITREASON(SIGBASED)="Claim manually entered by Fraud staff."]
  END   
 
 FOR USER WITH NUMBER FORMAT("9999",THISUSER)
  DO
   TELLEREMAIL=USER:EMAIL
  END

 FOR X=1 TO 20
  DO
   FOR N=0 TO 11
    DO
     NAMEINFO(X,N)=""
    END
  END
 
 CALL GETSHARELIST          [Load in share and loan data]
 CALL GETCARDS              [Find all debit & ATM cards on account]
 CALL MAKEMENUS             [Prep various drop-down menus]
 CALL INITIALIZETXNARRAYS   [Initialize arrays for share transactions]   
 CALL PREPERRORS            [Initialize arrays for error messaging]
 CALL PREPFORMTYPES         [Initialize array relating to forms]
 CALL BUILDDBARRAYS         [Builds DB array labels & pre-sets values to NULL]
 [CALL PREPFOREMAIL          Builds info needed to email forms to Members - removed per ticket 25369]
 CALL LOADNAMEANDACCOUNTFIELDS   [Standard Symitar procedure to grab Member & Account info - mostly used for forms here]
 CALL COUNTCLAIMS          [Count to see if OK to give credit; no credit if 3+ claims in last 30 days] 

 ALLDONE=FALSE
 SCREENORD=1

 WHILE ALLDONE=FALSE
  DO
   WHILE SCREENORD=1 [MAIN SELECTION SCREEN]
    DO  
     CALL SCREEN1    
    END
   WHILE SCREENORD=2   [TRANSACTION SELECTION ]
    DO
     CALL SCREEN2
    END  
   WHILE SCREENORD=3 [QUESTIONS, QUESTIONS, QUESTIONS]
    DO
     CALL SCREEN3    
    END 
   WHILE SCREENORD=4 [FORM HANDLING]
    DO
     CALL SCREEN4    
    END     
   WHILE SCREENORD=99   [ERROR/SUCCESS SCREEN]
    DO
     CALL SCREEN99
    END
  END 
END


PRINT TITLE="SW.DISPUTE"
 HEADER=""
 NONANSISTANDARD
END

TOTAL
END

PROCEDURE SCREEN1
 IF ISFRAUDDEPT=TRUE THEN CREDITOVERRIDE=CHECKED
 WHILE SCREENORD=1
  DO
   SPECIALHANDLING=FALSE
   HTMLVIEWOPEN  								
   HTMLVIEWLINE("<HTML>")      
   HTMLVIEWLINE("<HEAD>")
   HTMLVIEWLINE(" <TITLE>Dispute/Fraud</TITLE>")
   HTMLVIEWLINE("</HEAD>")
 
   [BASIC STYLE]
   HTMLVIEWLINE("<STYLE>")
   HTMLVIEWLINE(" body {font: 12px Arial, sans-serif;}")
   HTMLVIEWLINE(" table {font: 12px Arial, sans-serif;}")
   HTMLVIEWLINE(" h1 {font: bold 26px Arial, sans-serif; margin-bottom: 0;color: #015F44}")
   HTMLVIEWLINE(" h2 {font: bold 14px Arial, sans-serif; margin-bottom: 0;color: #015F44}")
   HTMLVIEWLINE(" h3 {font: bold 11px Arial, sans-serif; margin-bottom: 0;color: #015F44}")
   HTMLVIEWLINE(" hr {color: #015F44}")
   HTMLVIEWLINE(" B {color: #015F44}")
   HTMLVIEWLINE("</STYLE>")
   HTMLVIEWLINE("<BODY BGCOLOR=#FFFFFF>")

   HTMLVIEWLINE("<form name='FraudDispute' METHOD=POST ACTION=symitar://HTMLView~Action=Post>  ")
   HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")
   HTMLVIEWLINE(" <thead>")
   HTMLVIEWLINE("  <tr>")
   HTMLVIEWLINE("   <th align=center>")
   HTMLVIEWLINE("    <IMG SRC=RCULOGO.JPG>")
   HTMLVIEWLINE("   </th>")
   HTMLVIEWLINE("  </tr>")
   
   HTMLVIEWLINE("<SCRIPT SRC='showhideoffcheckbx.js'></SCRIPT>") 
   HTMLVIEWLINE("<SCRIPT SRC='DATEFORMAT.js'></SCRIPT>")
   HTMLVIEWLINE("<SCRIPT SRC='AUTOCURRENCY.js'></SCRIPT>")
   HTMLVIEWLINE("<SCRIPT SRC='RCU_AUTOCURRENCY.js'></SCRIPT>")

   CALL LOADCSS   

   HTMLVIEWLINE("  <tr>")
   HTMLVIEWLINE("   <td align=center>")
   HTMLVIEWLINE("    <h1>Fraud/Dispute Claim</h1>")
   HTMLVIEWLINE(" <hr/>")
   HTMLVIEWLINE("   </td>")
   HTMLVIEWLINE("  </tr>")
   
   HTMLVIEWLINE(" </thead>")
   HTMLVIEWLINE("</table>")
   HTMLVIEWLINE("<body>") 
   
   HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=10 width=90%>")

   HTMLVIEWLINE(" <tr><td align='right'>")
   HTMLVIEWLINE("If this is about an <b>RCU ATM</b> transactions, click here:</td>")
   HTMLVIEWLINE("<td align=left><input type='submit' name='launchClaims' value='RCU ATM' class='rcubuttonwide'>")
   HTMLVIEWLINE("  </td></tr>")
      
   HTMLVIEWLINE(" <tr><td align='right'>")
   HTMLVIEWLINE("If this is about a <b>NON-RCU ATM</b> transactions, click here:</td>")
   HTMLVIEWLINE("<td align=left><input type='submit' name='missingATM' value='NON-RCU ATM' class='rcubuttonwide'>")
   HTMLVIEWLINE("  </td></tr>")
   
   HTMLVIEWLINE(" <tr><td align='right'>")
   HTMLVIEWLINE("If this is about a Loan Transaction, click here:</td>")
   HTMLVIEWLINE("<td align=left>")
   HTMLVIEWLINE("  <input type='submit' name='resReq' value='Research Request' class='rcubuttonwide'>")
   HTMLVIEWLINE("  </td></tr>")   

   HTMLVIEWLINE(" <tr><td align='right'>")
   HTMLVIEWLINE("If this is about a Service Center Transaction, click here:</td>") 
   HTMLVIEWLINE("<td align=left>")
   HTMLVIEWLINE("  <input type='submit' name='servCenter' value='Service Center' class='rcubuttonwide'>")
   HTMLVIEWLINE("  </td></tr>")   
  
   HTMLVIEWLINE(" <tr><td align='center' colspan=2>")
   HTMLVIEWLINE(" <hr>")   
   HTMLVIEWLINE("  </td></tr>")   
   
   IF ECOUNT>0 THEN
    DO
     FOR E=1 TO MAXERROR
      DO
       IF RETURNERROR(E)=TRUE THEN
        DO
         HTMLVIEWLINE(" <tr ><td colspan=2 align='center'>")
         ERRORTEXTOUTPUT=ERRTEXT(E)         
         HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font>")
         HTMLVIEWLINE(" </td></tr>") 
        END
      END
    END   
   
   HTMLVIEWLINE(" <tr><td align='right'>")
   HTMLVIEWLINE("<b>Please select one of the following:</b></td>")
   HTMLVIEWLINE("<td align=left>")
   HTMLVIEWLINE("<select name='SHARELIST'>")
   HTMLVIEWLINE("<option value='" + FORMAT("9",0) + "'>" + SHARELIST(0,SDESC)+"</option>")
   FOR I=1 TO SCOUNTER
    DO
     IF I=SELECTEDSID THEN 
      HTMLVIEWLINE("<option SELECTED value='" + FORMAT("99",I) + "'>" + SHARELIST(I,SINDICATOR)+"-"+SHARELIST(I,SID)+" "+SHARELIST(I,SDESC))
     ELSE
      HTMLVIEWLINE("<option value='" + FORMAT("99",I) + "'>" + SHARELIST(I,SINDICATOR)+"-"+SHARELIST(I,SID)+" "+SHARELIST(I,SDESC))
     IF SHARELIST(I,SCLOSEDATE)<>"" THEN HTMLVIEWLINE(" Closed: "+SHARELIST(I,SCLOSEDATE))
     HTMLVIEWLINE("</option>")
     HTMLVIEWLINE("</br>")
    END
   HTMLVIEWLINE("</select>")
   
    
   HTMLVIEWLINE("</td>")
   HTMLVIEWLINE("</tr>")   
   
   HTMLVIEWLINE(" <tr >")
   HTMLVIEWLINE("  <td align=right width=50%>")
   HTMLVIEWLINE("<b>Please select one of the following:</b>")
   HTMLVIEWLINE("<font color=red></br><strong>NOTE:</strong> it is critical that the correct card is selected.</br>")
   HTMLVIEWLINE(" You will be prompted to verify the card number.</font>")       
   HTMLVIEWLINE("</td>")

   HTMLVIEWLINE("<td align=left width=50%>")
   
   [member selection]
   HTMLVIEWLINE("<select name='nameChoice' >") 
   FOR X = 0 TO CARDCOUNT [NAMECOUNT ]
    DO
     IF X=SELECTEDNAME THEN 
      HTMLVIEWLINE("<option SELECTED value='" + FORMAT("99",X) + "' >"+ CARDDESC(X)+"</option>")
     ELSE     
      HTMLVIEWLINE("<option value='" + FORMAT("99",X) + "' >"+ CARDDESC(X)+"</option>")
     HTMLVIEWLINE("</br>")
    END
   HTMLVIEWLINE("</select></td></tr>") 
   
   HTMLVIEWLINE(" <tr><td align='center' colspan=2>")
   HTMLVIEWLINE("<b>If multiple cards are involved, please submit separate claims for each card.</br> If there are card")
   HTMLVIEWLINE(" <u>and</u> non-card claims to be submitted, please select the card that is involved.</b>")
   HTMLVIEWLINE("  </td></tr>")      
   
   HTMLVIEWLINE("<tr><td colspan=2 align=center><hr/></td></tr><tr><td align=right>")
   HTMLVIEWLINE(" <input type='submit' name='Continue' value='Click To Continue' class='rcubutton'>")
   HTMLVIEWLINE("</td><td align=left><input type='submit' name='quit' value='Click To Exit' class='rcubutton'> </td>")
   HTMLVIEWLINE("</tr>")
   
   IF THISBRANCH=76 OR THISBRANCH=82 OR 
     (SYSSYMDIRECTORY<>0 AND SYSUSERNUMBER=797) THEN
    DO
     HTMLVIEWLINE("<tr><td colspan=2 align=center><hr/></td></tr>")
     HTMLVIEWLINE("<tr><td colspan=2 align=center><h2>")
     HTMLVIEWLINE(DEPARTMENTNAME+" staff only: </h2></td></tr>")
     HTMLVIEWLINE("<tr><td align=center><h3>AUTOMATIC CREDITS</H3><b>If this box is checked, the repgen will allow automatic credits for ")
     HTMLVIEWLINE("your department (within all other guidelines)</b>")
     IF CREDITOVERRIDE=CHECKED THEN HTMLVIEWLINE("<input type = 'checkbox' "+CHECKED+" name = 'creditOverride' align = 'left' value ='"+CREDITOVERRIDE+"'/>")
     IF CREDITOVERRIDE=UNCHECKED THEN HTMLVIEWLINE("<input type = 'checkbox' "+UNCHECKED+" name = 'creditOverride' align = 'left' value ='"+CREDITOVERRIDE+"'/>")
     HTMLVIEWLINE("</br></br></br><b> Use the button below for manually entering unposted Transactions.</b></br></br>")
     HTMLVIEWLINE("<input type='submit' name='LPContinue' value='Enter Unposted Txns' class='rcubuttonwide'></td>")
     HTMLVIEWLINE("<td align=center>")
     HTMLVIEWLINE("<b>Fill in this section for RCU Corporate Card disputes:</b></br>")
     HTMLVIEWLINE("Cardholder First Name: <input type='text' name='corpnamefirst' value ='")
     HTMLVIEWLINE(RCUNAMEF)
     HTMLVIEWLINE("' size=20 maxlength=20></br>")
     HTMLVIEWLINE("Cardholder Last Name: <input type='text' name='corpnamelast' value ='")
     HTMLVIEWLINE(RCUNAMEL)
     HTMLVIEWLINE("' size=20 maxlength=20></br>")      
     HTMLVIEWLINE("Card Number: <input type='text' name='corpcardnum' value ='")
     HTMLVIEWLINE(RCUCARDNUM)
     HTMLVIEWLINE("' size=20 maxlength=20></br>")     
     HTMLVIEWLINE("<select name='dummyAcct'>")
     HTMLVIEWLINE("<option value='0'>Please Select:</option>")
     HTMLVIEWLINE("<option value='1'>This person is a member on this account</option>")
     HTMLVIEWLINE("<option value='2'>This person is NOT on this account</option>")
     HTMLVIEWLINE("</select>")
     HTMLVIEWLINE("</br>")
     HTMLVIEWLINE("<input type='submit' name='CorpContinue' value='RCU Corp Card Dispute' class='rcubuttonwide'></td>")     
     HTMLVIEWLINE("</tr>")
    END   
         
   HTMLVIEWLINE("</table>")     
   HTMLVIEWLINE("</body></html>")   
     
   HTMLVIEWDISPLAY


   INPUTCOUNT	= 0
   FOR I = 1 TO MAXINPUT
    DO
     INPUTFORM(I)	= ""
    END
   WHILE	INPUTFORM(INPUTCOUNT)	<> "EOD" AND INPUTCOUNT < MAXINPUT
    DO   
     INPUTCOUNT			= INPUTCOUNT + 1
     INPUTFORM(INPUTCOUNT)	= ENTERLINE(0)
    END
   CALL GETPOSTBACK1     
  END
END  [screen 1]

PROCEDURE SCREEN2
 WHILE SCREENORD=2
  DO
   HTMLVIEWOPEN  								
   HTMLVIEWLINE("<HTML>")      
   HTMLVIEWLINE("<HEAD>")
   HTMLVIEWLINE(" <TITLE>Dispute/Fraud</TITLE>")
   HTMLVIEWLINE("</HEAD>")
 
   [BASIC STYLE]
   HTMLVIEWLINE("<STYLE>")
   HTMLVIEWLINE(" body {font: 12px Arial, sans-serif;}")
   HTMLVIEWLINE(" table {font: 12px Arial, sans-serif;}")
   HTMLVIEWLINE(" h1 {font: bold 26px Arial, sans-serif; margin-bottom: 0;color: #015F44}")
   HTMLVIEWLINE(" h2 {font: bold 14px Arial, sans-serif; margin-bottom: 0;color: #015F44}")
   HTMLVIEWLINE(" h3 {font: bold 11px Arial, sans-serif; margin-bottom: 0;color: #015F44}")
   HTMLVIEWLINE(" hr {color: #015F44}")
   HTMLVIEWLINE(" B {color: #015F44}")
   HTMLVIEWLINE("</STYLE>")
   HTMLVIEWLINE("<BODY BGCOLOR=#FFFFFF>")

   HTMLVIEWLINE("<form name='FraudDispute' METHOD=POST ACTION=symitar://HTMLView~Action=Post>  ")
   HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")
   HTMLVIEWLINE(" <thead>")
   HTMLVIEWLINE("  <tr>")
   HTMLVIEWLINE("   <th align=center>")
   HTMLVIEWLINE("    <IMG SRC=RCULOGO.JPG>")
   HTMLVIEWLINE("   </th>")
   HTMLVIEWLINE("  </tr>")
   
   HTMLVIEWLINE("<SCRIPT SRC='showhideoffcheckbx.js'></SCRIPT>") 
   HTMLVIEWLINE("<SCRIPT SRC='DATEFORMAT.js'></SCRIPT>")
   HTMLVIEWLINE("<SCRIPT SRC='AUTOCURRENCY.js'></SCRIPT>")
   HTMLVIEWLINE("<SCRIPT SRC='RCU_AUTOCURRENCY.js'></SCRIPT>")

   CALL LOADCSS   

   HTMLVIEWLINE("  <tr>")
   HTMLVIEWLINE("   <td align=center>")
   HTMLVIEWLINE("    <h1>Dispute/Fraud Claim</h1>")
   HTMLVIEWLINE(" <hr/>")
   HTMLVIEWLINE("   </td>")
   HTMLVIEWLINE("  </tr>")
   
   HTMLVIEWLINE(" </thead>")
   HTMLVIEWLINE("</table>")
   HTMLVIEWLINE("<body>")  
   
   
   HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")

     
   [SECTION FOR IF SHARE IS SELECTED]
   IF SHARELIST(SELECTEDSID,SINDICATOR)<>"V" AND SPECIALHANDLING=FALSE AND RCUCORP=FALSE THEN
    DO
     HTMLVIEWLINE("<tr>")
     HTMLVIEWLINE("<td colspan=2 align=center>")
     HTMLVIEWLINE("<h3>Transactions for Share "+SHARELIST(SELECTEDSID,SID)+" "+SHARELIST(SELECTEDSID,SDESC)+"</h3>")
     HTMLVIEWLINE("Please enter a start and end date and click search to list transactions; up to 200 transactions ")
     HTMLVIEWLINE("will be listed for you to select from.</br>")
     HTMLVIEWLINE("You will be asked for more details on the next screen.</br></br>")
     HTMLVIEWLINE("<B>Note: If you select a mix of transaction (form) types, you may need to complete multiple forms.</B>")
     IF CARDNUMS(SELECTEDNAME)="" THEN
      DO
       HTMLVIEWLINE("</br><font color='red'><strong>NOTE:</strong> You did not select a Debit, ATM or Credit card; ")
       HTMLVIEWLINE("therefore these transaction types will not be selectable.</font>")
      END
     HTMLVIEWLINE("</td></tr>")
     
     [set some defaults]    
     IF SEARCHSTARTDATE='--/--/--' THEN SEARCHSTARTDATE=(SYSTEMDATE-30)
     IF SEARCHENDDATE='--/--/--' THEN SEARCHENDDATE=SYSTEMDATE     
     
     HTMLVIEWLINE(" <tr >") 
     HTMLVIEWLINE("  <td align=right>")
     HTMLVIEWLINE("Start date:")
     HTMLVIEWLINE(" <input type='text' size = 10 maxlength = 10 name='startDate' value ='"+FORMAT("99/99/9999",SEARCHSTARTDATE)+"'")
     HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
     HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
     HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q)
     HTMLVIEWLINE("      >")
     HTMLVIEWLINE("</td><td align=left>")   
     HTMLVIEWLINE("End Date: ")
     HTMLVIEWLINE(" <input type='text' size = 10 maxlength = 10 name='endDate' value ='"+FORMAT("99/99/9999",SEARCHENDDATE)+"'")
     HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
     HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
     HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q)
     HTMLVIEWLINE("      >")  
     HTMLVIEWLINE("</td>")
     HTMLVIEWLINE(" </tr>")   
     HTMLVIEWLINE("<tr>")
     HTMLVIEWLINE(" <td align=center colspan=2>")
     HTMLVIEWLINE("  <input type='submit' name='Search' value='Search' class='rcubutton'>")
     HTMLVIEWLINE(" </td>")
     HTMLVIEWLINE(" </tr>")   
    
     IF ECOUNT>0 THEN
      DO
       FOR E=1 TO MAXERROR
        DO
         IF RETURNERROR(E)=TRUE THEN
          DO
           HTMLVIEWLINE(" <tr ><td colspan=3 align=center>")
           ERRORTEXTOUTPUT=ERRTEXT(E)         
           HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font>")
           HTMLVIEWLINE(" </tr ></td>") 
          END
        END
      END    
    
     HTMLVIEWLINE("</table>") 
  
     IF TXNSEARCH=TRUE THEN
      DO  
       HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")    
       IF TXNFOUND=0 AND ECOUNT=0 THEN
        DO
         HTMLVIEWLINE("<tr>")
         HTMLVIEWLINE("<td colspan=5 align=center>")
         HTMLVIEWLINE("<h2>No Transactions Found</h2>")
         HTMLVIEWLINE("Please select a different date range and click search again.")
         HTMLVIEWLINE("</td>")
         HTMLVIEWLINE("</tr>")
        END 
       IF TXNFOUND>0 THEN
        DO      
         HTMLVIEWLINE("<tr><td colspan=5 align=center>Select the transaction(s) that the member wishes to dispute or report as fraud and click continue")
         HTMLVIEWLINE("</td></tr>")        
         HTMLVIEWLINE("<tr>")
         HTMLVIEWLINE("<td><b>Select</b></td>")
         HTMLVIEWLINE("<td><b>Date</b></td>")
         HTMLVIEWLINE("<td><b>Amount </b></td>")
         HTMLVIEWLINE("<td><b>Description</b></td>")
         HTMLVIEWLINE("<td><b>Form Type</b></td>")
         HTMLVIEWLINE("</tr>")      
         FOR T=1 TO TXNFOUND
          DO
           HTMLVIEWLINE("<tr>")
           HTMLVIEWLINE("<td>")
           IF TXN(T,TSELECTABLE)="Y" THEN
            DO
             IF TSELECT(T)=TRUE THEN HTMLVIEWLINE("<input type = 'checkbox' "+CHECKED+" name = '"+FORMAT("l999:",T)+"TSelect' align = 'left' value ='"+ FORMAT("99",T) +"'/>")
             IF TSELECT(T)=FALSE THEN HTMLVIEWLINE("<input type = 'checkbox' name = '"+FORMAT("l999:",T)+"TSelect' align = 'left' value ='"+ FORMAT("99",T) +"'/>")
            END
           IF TXN(T,TSELECTABLE)="N" THEN
            DO
             HTMLVIEWLINE(" ")
            END
           HTMLVIEWLINE("</td>")
           HTMLVIEWLINE("<td>"+ TXN(T,TDATE) +"</td>")
           HTMLVIEWLINE("<td>$"+ TXN(T,TAMT) +"</td>")
           HTMLVIEWLINE("<td>"+ TXN(T,TDESC)+ "</td>")
           HTMLVIEWLINE("<td>"+ TXN(T,TTYPE)+ "</td>")
           HTMLVIEWLINE("</tr>")
          END 
        END
       HTMLVIEWLINE("<tr><td align=center colspan=5 >")
       HTMLVIEWLINE("  <input type='submit' name='TContinue' value='Click To Continue' class='rcubutton'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")
       HTMLVIEWLINE("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type='submit' name='quit' value='Click To Exit' class='rcubutton'>") 
       HTMLVIEWLINE("</td>")
       HTMLVIEWLINE("</tr>") 
       HTMLVIEWLINE("</table>")           
      END    
    END  [FOR NON-VISA TXNS]
    
   IF SHARELIST(SELECTEDSID,SINDICATOR)="V" OR RCUCORP=TRUE THEN
    DO
     HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>") 
     
     HTMLVIEWLINE("<tr>")
     HTMLVIEWLINE("<td colspan=3 align=center>")
     HTMLVIEWLINE("<h3>Transactions for Visa card ending in "+CARDTRUNC+"</h3>")
     HTMLVIEWLINE("Please enter the basic information for the transaction(s) the member wishes to dispute or claim as fraud. ")
     HTMLVIEWLINE("</br>You will be asked for more details on the next screen.")
     HTMLVIEWLINE(" </td>")
     HTMLVIEWLINE("</tr>") 
     
     IF ECOUNT>0 THEN
      DO
       FOR E=1 TO MAXERROR
        DO
         IF RETURNERROR(E)=TRUE THEN
          DO
           HTMLVIEWLINE(" <tr ><td colspan=3 align=center>")
           ERRORTEXTOUTPUT=ERRTEXT(E)         
           HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font>")
           HTMLVIEWLINE(" </tr ></td>") 
          END
        END      
      END      
     
     HTMLVIEWLINE("<tr align=center>")    
     HTMLVIEWLINE("<td><b>Date</b></td>")
     HTMLVIEWLINE("<td><b>Amount</b></td>")
     HTMLVIEWLINE("<td><b>Description</b></td>") 
     HTMLVIEWLINE("</tr>")
     
     FOR T=1 TO 18
      DO
       HTMLVIEWLINE("<tr align=center>")
       [DATE]
       HTMLVIEWLINE("<td><input type='text' size = 10 maxlength = 10 name='"+FORMAT("vDate99",T)+"' value ='"+TXN(T,TDATE)+"'")
       HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
       HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
       HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q)
       HTMLVIEWLINE("      ></td>")     
       [AMOUNT]
       HTMLVIEWLINE("<td><input type='text'  name='vAmt"+FORMAT("99",T)+"' value ='"+TXN(T,TAMT)+"' size=9 maxlength=9")
       HTMLVIEWLINE("onKeyDown="+Q+"return(RCUCurrencyFormat(this,',','.',event)); "+Q)
       HTMLVIEWLINE("onKeyUp="+Q+"return false;"+Q+" />")
       HTMLVIEWLINE("</td>")
       
       [DESCRIPTION]
       HTMLVIEWLINE("<td><input type='text'  name='vdescr"+FORMAT("99",T)+"' value ='")
       HTMLVIEWLINE(TXN(T,TDESC))
       HTMLVIEWLINE("' size=40 maxlength=40> </td>")                          
      END
     HTMLVIEWLINE("<tr><td colspan=3 align=center >")
     HTMLVIEWLINE("  <input type='submit' name='VContinue' value='Click To Continue' class='rcubutton'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")
     HTMLVIEWLINE("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type='submit' name='quit' value='Click To Exit' class='rcubutton'> ")
     HTMLVIEWLINE(" </td>")
     HTMLVIEWLINE("</tr>") 
     HTMLVIEWLINE("</table>")     
    END   [FOR VISA TXNS]
   
   [SPECIALHANDLING TXNS - allow entry of unposted txns if run by LP department] 
   IF SHARELIST(SELECTEDSID,SINDICATOR)<>"V" AND SPECIALHANDLING=TRUE THEN
    DO
     HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>") 
     
     HTMLVIEWLINE("<tr>")
     HTMLVIEWLINE("<td colspan=3 align=center>")
     HTMLVIEWLINE("<h3>Unposted Transactions for "+SHARELIST(SELECTEDSID,SDESC)+"</h3>")     
     HTMLVIEWLINE("Please enter the basic information for the transaction(s) the member wishes to dispute or claim as fraud. ")
     HTMLVIEWLINE("</br>You will be asked for more details on the next screen.")
     HTMLVIEWLINE(" </td>")
     HTMLVIEWLINE("</tr>") 
     
     IF ECOUNT>0 THEN
      DO
       FOR E=1 TO MAXERROR
        DO
         IF RETURNERROR(E)=TRUE THEN
          DO
           HTMLVIEWLINE(" <tr ><td colspan=3 align=center>")
           ERRORTEXTOUTPUT=ERRTEXT(E)         
           HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font>")
           HTMLVIEWLINE(" </tr ></td>") 
          END
        END      
      END      
     
     HTMLVIEWLINE("<tr align=center>")    
     HTMLVIEWLINE("<td><b>Date</b></td>")
     HTMLVIEWLINE("<td><b>Amount</b></td>")
     HTMLVIEWLINE("<td><b>Description</b></td>") 
     HTMLVIEWLINE("</tr>")
     
     FOR T=1 TO 18
      DO
       HTMLVIEWLINE("<tr align=center>")
       [DATE]
       HTMLVIEWLINE("<td><input type='text' size = 10 maxlength = 10 name='"+FORMAT("vDate99",T)+"' value ='"+TXN(T,TDATE)+"'")
       HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
       HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
       HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q)
       HTMLVIEWLINE("      ></td>")     
       [AMOUNT]
       HTMLVIEWLINE("<td><input type='text'  name='vAmt"+FORMAT("99",T)+"' value ='"+TXN(T,TAMT)+"' size=9 maxlength=9")
       HTMLVIEWLINE("onKeyDown="+Q+"return(RCUCurrencyFormat(this,',','.',event)); "+Q)
       HTMLVIEWLINE("onKeyUp="+Q+"return false;"+Q+" />")
       HTMLVIEWLINE("</td>")
       
       [DESCRIPTION]
       HTMLVIEWLINE("<td><input type='text'  name='vdescr"+FORMAT("99",T)+"' value ='")
       HTMLVIEWLINE(TXN(T,TDESC))
       HTMLVIEWLINE("' size=40 maxlength=40> </td>")                          
      END
     HTMLVIEWLINE("<tr><td colspan=3 align=center >")
     HTMLVIEWLINE("  <input type='submit' name='VContinue' value='Click To Continue' class='rcubutton'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")
     HTMLVIEWLINE("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type='submit' name='quit' value='Click To Exit' class='rcubutton'> ")
     HTMLVIEWLINE(" </td>")
     HTMLVIEWLINE("</tr>") 
     HTMLVIEWLINE("</table>")     
    END   [FOR UNPOSTED TXNS]    
       
   
   HTMLVIEWLINE("</body></html>")   
     
   HTMLVIEWDISPLAY


   INPUTCOUNT	= 0
   FOR I = 1 TO MAXINPUT
    DO
     INPUTFORM(I)	= ""
    END
   WHILE	INPUTFORM(INPUTCOUNT)	<> "EOD" AND INPUTCOUNT < MAXINPUT
    DO   
     INPUTCOUNT			= INPUTCOUNT + 1
     INPUTFORM(INPUTCOUNT)	= ENTERLINE(0)
    END
   CALL GETPOSTBACK2     
  END
END  [screen 2]

PROCEDURE SCREEN3
 WHILE SCREENORD=3
  DO
   HTMLVIEWOPEN  
   	 					
   HTMLVIEWLINE("<HTML>")      
   HTMLVIEWLINE("<HEAD>")
   HTMLVIEWLINE(" <TITLE>Dispute/Fraud</TITLE>")
   HTMLVIEWLINE("</HEAD>")
 
   [BASIC STYLE]
   HTMLVIEWLINE("<STYLE>")
   HTMLVIEWLINE(" body {font: 12px Arial, sans-serif;}")
   HTMLVIEWLINE(" table {font: 12px Arial, sans-serif;}")
   HTMLVIEWLINE(" h1 {font: bold 26px Arial, sans-serif; margin-bottom: 0;color: #015F44}")
   HTMLVIEWLINE(" h2 {font: bold 14px Arial, sans-serif; margin-bottom: 0;color: #015F44}")
   HTMLVIEWLINE(" h3 {font: bold 11px Arial, sans-serif; margin-bottom: 0;color: #015F44}")
   HTMLVIEWLINE(" hr {color: #015F44}")
   HTMLVIEWLINE(" B {color: #015F44}")
   HTMLVIEWLINE("</STYLE>")
   HTMLVIEWLINE("<BODY BGCOLOR=#FFFFFF>")

   HTMLVIEWLINE("<form name='FraudDispute' METHOD=POST ACTION=symitar://HTMLView~Action=Post>  ")
   HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")
   HTMLVIEWLINE(" <thead>")
   HTMLVIEWLINE("  <tr>")
   HTMLVIEWLINE("   <th align=center>")
   HTMLVIEWLINE("    <IMG SRC=RCULOGO.JPG>")
   HTMLVIEWLINE("   </th>")
   HTMLVIEWLINE("  </tr>")
   
   HTMLVIEWLINE("<SCRIPT SRC='showhideoffcheckbx.js'></SCRIPT>") 
   HTMLVIEWLINE("<SCRIPT SRC='DATEFORMAT.js'></SCRIPT>")
   HTMLVIEWLINE("<SCRIPT SRC='AUTOCURRENCY.js'></SCRIPT>")
   HTMLVIEWLINE("<SCRIPT SRC='RCU_AUTOCURRENCY.js'></SCRIPT>")

   CALL LOADCSS   

   HTMLVIEWLINE("  <tr>")
   HTMLVIEWLINE("   <td align=center>")
   HTMLVIEWLINE("    <h1>Dispute/Fraud Claim</h1>")
   HTMLVIEWLINE(" <hr/>")
   HTMLVIEWLINE("   </td>")
   HTMLVIEWLINE("  </tr>")
   
   HTMLVIEWLINE(" </thead>")
   HTMLVIEWLINE("</table>")
   HTMLVIEWLINE("<body>")  
   
   HTMLVIEWLINE("</body></html>")   
        
   HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")
   
   
   [DEFINE FRAUD VS. DISPUTE - HIDE AFTER FRAUD/DISPUTE SIG-BASED OPTION IS CLICKED TO KEEP SCREEN SHORTER
    ONLY DISPLAY IF SIG OR PIN TRANSACTIONS ARE INCLUDED; SUPPRESS FOR ACH/DRAFT]
   IF BUTTONCLICKED=0 AND (FORMTYPES(SIGBASED)<>FALSE OR FORMTYPES(PINBASED)<>FALSE)  THEN
    DO
     HTMLVIEWLINE("<TR><TD COLSPAN=4 ALIGN=CENTER><H3>Is it Fraud, or is it a Dispute?</H3></br>")
     HTMLVIEWLINE("Categorizing the claim properly will help process the claim more quickly and ensure the proper forms are filled out.</td></tr>")
     HTMLVIEWLINE("<TR><TD COLSPAN=2 ALIGN=left><center><H3>FRAUD</H3></center>In order for a transaction to be considered fraudulent, ")
     HTMLVIEWLINE("one or more of the following must be confirmed by the Member:</TD>")
     HTMLVIEWLINE("<TD COLSPAN=2 ALIGN=left><center><H3>DISPUTE</H3></center>Any other transactions that do not meet the criteria")
     HTMLVIEWLINE(" for fraud will be considered a dispute.  Disputes can include the following:</TD>")
     HTMLVIEWLINE("</TR>")
     
     HTMLVIEWLINE("<TR><TD COLSPAN=2 WIDTH=50% ALIGN=left>")
     HTMLVIEWLINE("<ul>")
     HTMLVIEWLINE("<li>The Member did not originate and/or initiate any of the fraudulent transaction(s).</li>")
     HTMLVIEWLINE("<li>The Member does not have knowledge that his/her spouse or minor child(ren) ")
     HTMLVIEWLINE("made any transactions on or after the date of the first fraudulent transaction. </li>")
     HTMLVIEWLINE("<li>The Member did not give permission to anyone to use their card(s). (This includes, ")
     HTMLVIEWLINE("but is not limited to, caretakers, extended family, friends, significant others and the like.)</li>")
     HTMLVIEWLINE("</ul>")
     HTMLVIEWLINE("Please note that if the Member originated or initiated business with a company and later found out that the company ")
     HTMLVIEWLINE("was fraudulent (or the Member was part of a scam), the Member will need to fill out <U>Dispute</U> documentation. This ")
     HTMLVIEWLINE("would not be considered "+Q+"fraudulent"+Q+" and should not fill out fraud documents. ")
     HTMLVIEWLINE("</td>")
  
  
     HTMLVIEWLINE("<TD COLSPAN=2 WIDTH=50%  ALIGN=left>")
     HTMLVIEWLINE("<ul>")
     HTMLVIEWLINE("<li>The Member found out the company was fake and/or ")
     HTMLVIEWLINE("the transaction was a scam.</li>")
     HTMLVIEWLINE("<li>Membership cancellations; merchant did not issue refund; continued unauthorized billing")
     HTMLVIEWLINE(" of account.</li>")
     HTMLVIEWLINE("<li>Duplicate billing. </li>")
     HTMLVIEWLINE("<li>Overcharge for purchases.</li>")
     HTMLVIEWLINE("<li>Credit(s) posting as sales and/or credit(s) were not issued by the merchant as promised.</li>")
     HTMLVIEWLINE("<li>Merchandise was returned, damaged, defective or never received.</li>")
     HTMLVIEWLINE("<li>Merchant posted transaction before agreed upon date.</li>")
     HTMLVIEWLINE("<li>Any other service dispute.</li>")
     HTMLVIEWLINE("</ul>")
     HTMLVIEWLINE("</td></tr>")     
   END
   HTMLVIEWLINE("<tr><td colspan=4 align=center><h3>Transaction Details</h3>")
   HTMLVIEWLINE("Please answer ALL questions and then continue when finished with all forms.<hr/></td></tr>")   
   HTMLVIEWLINE("</TABLE>")
   
   [begin sections for each form type]
   
   [sig based]
   IF FORMTYPES(SIGBASED)<>FALSE THEN
    DO
    
     HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")    
    
    [this is a hidden/unused button; only here to prevent an inadvertent "click" to the fraud button if user hits enter by accident]   
    HTMLVIEWLINE("<TR><TD COLSPAN=2 ALIGN=CENTER>")
    HTMLVIEWLINE("<input type='submit' name='b' value='Signature-based transactions' class='rcubuttonwidehidden'")
    HTMLVIEWLINE("</TD></TR>")
     
     IF BUTTONCLICKED=0 THEN  [only display this until either fraud or dispute buttons are clicked]
      DO
       HTMLVIEWLINE("<TR><TD COLSPAN=2 ALIGN=CENTER>The information required for signature based transactions ")
       HTMLVIEWLINE("is different depending upon whether the transactions are Fraud or Dispute.  Please read ")
       HTMLVIEWLINE("the descriptions above and determine whether these are Fraud or Dispute transactions. Then ")
       HTMLVIEWLINE("select the claim type and click the appropriate button to get the correct set of questions.")
       HTMLVIEWLINE("</TD></TR>")
      END
      
     IF ECOUNT>0 THEN
      DO
       HTMLVIEWLINE(" <tr ><td colspan=4 align=center>")
       IF RETURNERROR(SCLAIMTYPE)=TRUE THEN
        DO           
         ERRORTEXTOUTPUT=ERRTEXT(SCLAIMTYPE)         
         HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font></br>")            
        END            
       HTMLVIEWLINE(" </td></tr >")
      END     
 
     HTMLVIEWLINE("<TR>")
     HTMLVIEWLINE("<TD ALIGN=RIGHT WIDTH=50%><input type='submit' name='fraudbutton' value='Fraud' class='rcubutton'> ")
     HTMLVIEWLINE("</TD>")
     HTMLVIEWLINE("<TD ALIGN=LEFT WIDTH=50%><input type='submit' name='disputebutton' value='Dispute' class='rcubutton'> ")
     HTMLVIEWLINE("</TD>")
     HTMLVIEWLINE("</TR>")

     HTMLVIEWLINE("</table>")
     
     IF BUTTONCLICKED<>FALSE THEN
      DO      
       IF BUTTONCLICKED=1 THEN  [FRAUD] 
        DO
         IF ISBUSINESS=TRUE THEN 
          DO
           FORMTOUSE(SIGBASED)="LP1311"
           TEMPNAME="Business"
          END
         IF ISBUSINESS=FALSE THEN 
          DO
           FORMTOUSE(SIGBASED)="LP1308"
           TEMPNAME="Member"
          END  
           
         HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")
         
         IF FORMTYPES(SIGBASED)>18 THEN
          DO
           ECOUNT=ECOUNT+1
           RETURNERROR(SFTOOMANYTXNS)=TRUE
          END
         
         IF ECOUNT>0 THEN
          DO
           HTMLVIEWLINE(" <tr ><td colspan=4 align=center>")
           FOR E=27 TO 34  [SIG-BASED FRAUD TRAN SECTION ERRORS]
            DO
             IF RETURNERROR(E)=TRUE THEN
              DO           
               ERRORTEXTOUTPUT=ERRTEXT(E)         
               HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font></br>")            
              END
            END
           E=SDISPUTETYPE
           IF RETURNERROR(E)=TRUE THEN
            DO           
             ERRORTEXTOUTPUT=ERRTEXT(E)         
             HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font></br>")            
            END   
           E=SFTOOMANYTXNS
           IF RETURNERROR(E)=TRUE THEN
            DO           
             ERRORTEXTOUTPUT=ERRTEXT(E)         
             HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font></br>")            
            END
           E=BADPHONE
           IF RETURNERROR(E)=TRUE THEN
            DO           
             ERRORTEXTOUTPUT=ERRTEXT(E)         
             HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font></br>")            
            END     
           E=BADDATE
           IF RETURNERROR(E)=TRUE THEN
            DO           
             ERRORTEXTOUTPUT=ERRTEXT(E)         
             HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font></br>")            
            END                                                      
           HTMLVIEWLINE(" </td></tr >")
          END          
         
         IF FOUNDCLAIMNOTE>0 THEN
          DO      
           FOR F=1 TO FOUNDCLAIMNOTE
            DO
             IF SEGMENT(CLAIMNUM(F),8,8)="F" AND 
                ((SHARELIST(SELECTEDSID,SINDICATOR)<>"V" AND SEGMENT(CLAIMNUM(F),11,11)="D") OR
                 (SHARELIST(SELECTEDSID,SINDICATOR)="V" AND SEGMENT(CLAIMNUM(F),11,11)="C")) THEN
              DO
               FOUNDSIGFRAUDNOTE=TRUE
               HTMLVIEWLINE("<tr><td colspan=4><b>There is one or more open signature-based Fraud claim on this share.</b></td></tr>")
               HTMLVIEWLINE("<tr>")
               HTMLVIEWLINE("<td colspan=2>")
               HTMLVIEWLINE("<b>What would you like to do?</b>")
               HTMLVIEWLINE("</td>") 
               HTMLVIEWLINE("<td colspan=2>")   
               HTMLVIEWLINE("<select name='sappendClaim'>")
               IF SAPPENDCLAIM=0 THEN HTMLVIEWLINE("<option SELECTED value='0' >Please Select:</option>")
                ELSE
               HTMLVIEWLINE("<option value='0' >Please Select:</option>")
               FOR F=1 TO FOUNDCLAIMNOTE
                DO
                 IF SEGMENT(CLAIMNUM(F),8,8)="F" AND 
                    ((SHARELIST(SELECTEDSID,SINDICATOR)<>"V" AND SEGMENT(CLAIMNUM(F),11,11)="D") OR
                     (SHARELIST(SELECTEDSID,SINDICATOR)="V" AND SEGMENT(CLAIMNUM(F),11,11)="C")) THEN
                  DO            
                   IF F=SAPPENDCLAIM THEN 
                    HTMLVIEWLINE("<option SELECTED value='" + FORMAT("99",F) + "' >Append to claim "+ CLAIMNUM(F)+"</option>")
                   ELSE     
                    HTMLVIEWLINE("<option value='" + FORMAT("99",F) + "' >Append to claim "+ CLAIMNUM(F)+"</option>")
                   HTMLVIEWLINE("</br>")
                  END
                END
               IF SAPPENDCLAIM=99 THEN HTMLVIEWLINE("<option SELECTED value='99' >Create New Claim</option>") 
                ELSE
               HTMLVIEWLINE("<option value='99' >Create New Claim</option>") 
               
               HTMLVIEWLINE("</select></td>")      
               HTMLVIEWLINE("</tr>")          
              END
            END
          END
        
         IF FOUNDCLAIMNOTE=0 OR FOUNDSIGFRAUDNOTE=FALSE THEN
          DO
           HTMLVIEWLINE("<TR><TD COLSPAN=4><i>No existing signature-based Fraud claims found for this card/share. ")
           HTMLVIEWLINE("A new claim number will be assigned.</i></td>") 
           HTMLVIEWLINE("</tr>")
          END       
         
         HTMLVIEWLINE("<TR><TD COLSPAN=4>The following transaction(s) will appear on the form:")
         HTMLVIEWLINE("<OL>")
         FOR T=1 TO 200
          DO    
           IF TSELECT(T)=TRUE AND CHARACTERSEARCH(TXN(T,TTYPE),"Signature")>0 THEN 
            DO
             HTMLVIEWLINE("<LI>"+TXN(T,TDATE)+" "+TXN(T,TAMT)+" "+TXN(T,TDESC)+"</LI>")        
            END
          END
         HTMLVIEWLINE("</OL></TD></TR>")     
                    
         HTMLVIEWLINE("<tr>")
         HTMLVIEWLINE("<td colspan=2><b>"+TEMPNAME+" requested card?</b></td>")
         HTMLVIEWLINE("<td colspan=2>")   
         HTMLVIEWLINE("<select name='sb1'>")
         FOR X=0 TO 2
          DO
           IF X=SBSELECT1 THEN 
            HTMLVIEWLINE("<option SELECTED value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
           ELSE     
            HTMLVIEWLINE("<option value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
           HTMLVIEWLINE("</br>")
          END
         HTMLVIEWLINE("</select></td>")         
         HTMLVIEWLINE("</tr>")
         
         HTMLVIEWLINE("<tr><td colspan=2><b>Number of Cards Issued: </b></td>")
         HTMLVIEWLINE("<td colspan=2><input type='text'  name='sb2' value ='"+SB2+"' size=2 maxlength=2> </td>") 
         HTMLVIEWLINE("</tr>")
         
         IF CHARACTERSEARCH(CARDDESC(SELECTEDNAME),"Debit")>0 THEN 
          CARDTYPE="Debit"
         ELSE
          CARDTYPE="ATM"     
         
         HTMLVIEWLINE("<tr><td colspan=2><b>At the time of the transaction, the card was: </b></td>") 
         HTMLVIEWLINE("<td colspan=2><select name='sb3'>")
         FOR X=0 TO 4
          DO
           IF X=SBSELECT3 THEN 
           HTMLVIEWLINE("<option SELECTED value='" + FORMAT("9",X) + "' >"+ CARDWAS(X)+"</option>")
          ELSE
           HTMLVIEWLINE("<option value='" + FORMAT("9",X) + "' >"+ CARDWAS(X)+"</option>")
          HTMLVIEWLINE("</br>")
          END
         HTMLVIEWLINE("</select></td></tr>") 
         
         HTMLVIEWLINE("<tr>")
         HTMLVIEWLINE("<td colspan=2><b>Was law enforcement notified?</b></td>")
         HTMLVIEWLINE("<td colspan=2>")   
         HTMLVIEWLINE("<select name='sb4a'>")
         FOR X=0 TO 2
          DO
           IF X=SBSELECT4 THEN 
            HTMLVIEWLINE("<option SELECTED value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
           ELSE     
            HTMLVIEWLINE("<option value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
           HTMLVIEWLINE("</br>")
          END
         HTMLVIEWLINE("</select></td>")         
         HTMLVIEWLINE("</tr>")  
         
         HTMLVIEWLINE("<tr><td></td><td colspan=2><b>If yes, enter police report #</b></td>")                
         HTMLVIEWLINE("<td><input type='text' size = 15 maxlength = 15 name='sb4b' value ='"+SB4+"'></td></tr>")
         
         HTMLVIEWLINE("<tr>")
         HTMLVIEWLINE("<td colspan=2>")
         HTMLVIEWLINE("<b>Date cardholder discovered loss:</b>")
         HTMLVIEWLINE("</td>")
         HTMLVIEWLINE("<td colspan=2>Date: <input type='text' size = 10 maxlength = 10 name='sb5' value ='"+SB5+"'")
         HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
         HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
         HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q+"></td></tr>")
         
         HTMLVIEWLINE("<tr>")
         HTMLVIEWLINE("<td colspan=2>")
         HTMLVIEWLINE("<b>Date cardholder reported loss to Credit Union/Processor:</b>")
         HTMLVIEWLINE("</td>")
         HTMLVIEWLINE("<td colspan=2>Date: <input type='text' size = 10 maxlength = 10 name='sb6' value ='"+SB6+"'")
         HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
         HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
         HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q+"></td></tr>")         
         
         
         HTMLVIEWLINE("<tr>")
         HTMLVIEWLINE("<td colspan=2>")
         HTMLVIEWLINE("<b>Date of first fraudulent transaction:</b>")
         HTMLVIEWLINE("</td>")
         HTMLVIEWLINE("<td colspan=2>Date: <input type='text' size = 10 maxlength = 10 name='sb7' value ='"+SB7+"'")
         HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
         HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
         HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q+"></td></tr>") 
         
         HTMLVIEWLINE("<tr><td colspan=2><b>Unauthorized User's Name (if Known):</b></td>")                [ John added MAXLENGTH to these three ]
         HTMLVIEWLINE("<td colspan=2><input type='text' size=40 maxlength = 40  name='sb8' value ='"+SB8+"'></td></tr>")          

         HTMLVIEWLINE("<tr><td colspan=2><b>Unauthorized User's Phone (if Known): </b></td>")                
         HTMLVIEWLINE("<td colspan=2><input type='text' size=12 maxlength = 12  name='sb9' value ='"+SB9+"' ></td></tr>")
       
         HTMLVIEWLINE("<tr><td colspan=4><b>Unauthorized User's Mailing Address (if Known):</b></td></tr>") 
          
         HTMLVIEWLINE("<tr><td colspan=2 align=right>Street</td>")                
         HTMLVIEWLINE("<td colspan=2><input type='text'  name='sb_10' size=40 maxlength = 40 value ='"+SB10+"'></td></tr>")       
         
         HTMLVIEWLINE("<tr><td colspan=2 align=right>City</td>")                
         HTMLVIEWLINE("<td colspan=2><input type='text'  name='sb_11' size=40 maxlength = 40 value ='"+SB11+"'></td></tr>")                
         
         HTMLVIEWLINE("<tr><td colspan=2 align=right>State</td>")                
         HTMLVIEWLINE("<td colspan=2><input type='text'  name='sb_12' size=2 maxlength = 2 value ='"+SB12+"'></td></tr>")                         
         
         HTMLVIEWLINE("<tr><td colspan=2 align=right>Zipcode</td>")                
         HTMLVIEWLINE("<td colspan=2><input type='text'  name='sb_13' size=10 maxlength = 10 value ='"+SB13+"'></td></tr>")                                  

         HTMLVIEWLINE("</table>")
        END  [BUTTONCLICK=FRAUD]
        
       IF BUTTONCLICKED=2 THEN  [DISPUTE] 
        DO
         IF ISBUSINESS=TRUE THEN 
          DO
           FORMTOUSE(SIGBASED)="AS1310"
           TEMPNAME="Business"
          END
         IF ISBUSINESS=FALSE THEN 
          DO
           FORMTOUSE(SIGBASED)="AS1306"
           TEMPNAME="Member" 
          END   
    
         HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")
                  
         IF FORMTYPES(SIGBASED)>28 THEN
          DO
           ECOUNT=ECOUNT+1
           RETURNERROR(SDTOOMANYTXNS)=TRUE
          END         
         
         IF ECOUNT>0 THEN
          DO
           HTMLVIEWLINE(" <tr ><td colspan=4 align=center>")
           FOR E=35 TO 54  [SIG-BASED DISPUTE TRAN SECTION ERRORS]
            DO
             IF RETURNERROR(E)=TRUE THEN
              DO           
               ERRORTEXTOUTPUT=ERRTEXT(E)         
               HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font></br>")            
              END
            END
           E=SDTOOMANYTXNS  
           IF RETURNERROR(E)=TRUE THEN
            DO           
             ERRORTEXTOUTPUT=ERRTEXT(E)         
             HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font></br>")            
            END  
           E=SDISPUTEAMT  
           IF RETURNERROR(E)=TRUE THEN
            DO           
             ERRORTEXTOUTPUT=ERRTEXT(E)         
             HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font></br>")            
            END 
           E=BADDATE
           IF RETURNERROR(E)=TRUE THEN
            DO           
             ERRORTEXTOUTPUT=ERRTEXT(E)         
             HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font></br>")            
            END                                   
           HTMLVIEWLINE(" </td></tr >")
          END        
         
         IF FOUNDCLAIMNOTE>0 THEN
          DO      
           FOR F=1 TO FOUNDCLAIMNOTE
            DO
             IF SEGMENT(CLAIMNUM(F),8,8)="D" AND 
                ((SHARELIST(SELECTEDSID,SINDICATOR)<>"V" AND SEGMENT(CLAIMNUM(F),11,11)="D") OR
                 (SHARELIST(SELECTEDSID,SINDICATOR)="V" AND SEGMENT(CLAIMNUM(F),11,11)="C")) THEN
              DO
               FOUNDSIGDISPUTENOTE=TRUE
               HTMLVIEWLINE("<tr><td colspan=4><b>There is one or more open signature-based Dispute claim on this share for this card.</b></td></tr>")
               HTMLVIEWLINE("<tr>")
               HTMLVIEWLINE("<td colspan=3>")
               HTMLVIEWLINE("<b>What would you like to do?</b>")
               HTMLVIEWLINE("</td>") 
               HTMLVIEWLINE("<td colspan=1>")   
               HTMLVIEWLINE("<select name='sappendClaim'>")
               IF SAPPENDCLAIM=0 THEN HTMLVIEWLINE("<option SELECTED value='0' >Please Select:</option>")
                ELSE
               HTMLVIEWLINE("<option value='0' >Please Select:</option>")
               FOR F=1 TO FOUNDCLAIMNOTE
                DO
                 IF SEGMENT(CLAIMNUM(F),8,8)="D" AND 
                    ((SHARELIST(SELECTEDSID,SINDICATOR)<>"V" AND SEGMENT(CLAIMNUM(F),11,11)="D") OR
                     (SHARELIST(SELECTEDSID,SINDICATOR)="V" AND SEGMENT(CLAIMNUM(F),11,11)="C"))THEN
                  DO            
                   IF F=SAPPENDCLAIM THEN 
                    HTMLVIEWLINE("<option SELECTED value='" + FORMAT("99",F) + "' >Append to claim "+ CLAIMNUM(F)+"</option>")
                   ELSE     
                    HTMLVIEWLINE("<option value='" + FORMAT("99",F) + "' >Append to claim "+ CLAIMNUM(F)+"</option>")
                   HTMLVIEWLINE("</br>")
                  END
                END
               IF SAPPENDCLAIM=99 THEN HTMLVIEWLINE("<option SELECTED value='99' >Create New Claim</option>") 
                ELSE
               HTMLVIEWLINE("<option value='99' >Create New Claim</option>") 
               
               HTMLVIEWLINE("</select></td>")      
               HTMLVIEWLINE("</tr>")          
              END
            END
          END
        
         IF FOUNDCLAIMNOTE=0 OR FOUNDSIGDISPUTENOTE=FALSE THEN
          DO
           HTMLVIEWLINE("<TR><TD COLSPAN=4><i>No existing signature-based Dispute claims found for this card & share.")
           HTMLVIEWLINE(" A new claim number will be assigned.</i></td>") 
           HTMLVIEWLINE("</tr>")
          END       
         HTMLVIEWLINE("</table>")
         
         
         HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=2 width=90%>")
         
         HTMLVIEWLINE("<TR><TD COLSPAN=4>The following transaction(s) will appear on the form; ")
         HTMLVIEWLINE("<b><font color=red>please enter amount being disputed, leave blank for full amount.</font></b>")
         HTMLVIEWLINE("</td></tr><tr><td width=25%></td><td width=25%></td><td width=25%></td><td width=25%></td></tr>")
         TEMPCOUNT=0
         FOR T=1 TO 200
          DO    
           IF TSELECT(T)=TRUE AND CHARACTERSEARCH(TXN(T,TTYPE),"Signature")>0 THEN 
            DO
             TEMPCOUNT=TEMPCOUNT+1
             HTMLVIEWLINE("<tr><td colspan=3>"+FORMAT("##9.",TEMPCOUNT)+"&nbsp;&nbsp;")
             HTMLVIEWLINE(TXN(T,TDATE)+" "+TXN(T,TAMT)+" "+TXN(T,TDESC))
             HTMLVIEWLINE("</td><td>Dispute Amount: <input type='text'  name='vdAmt"+FORMAT("99",T)+"' value ='"+TXN(T,TDAMT)+"' size=15 maxlength=15")
             HTMLVIEWLINE("onKeyDown="+Q+"return(RCUCurrencyFormat(this,',','.',event)); "+Q)
             HTMLVIEWLINE("onKeyUp="+Q+"return false;"+Q+" />")
             HTMLVIEWLINE("</td></tr>")
            END
          END
         HTMLVIEWLINE("<tr><td colspan=4></TD></TR>")  
         
         HTMLVIEWLINE("<tr><td colspan=4>Please Note: Only <b><u>ONE</u></b> dispute reason may be used per claim.  If there is ")
         HTMLVIEWLINE(" more than one dispute reason, please create a separate claim. <i>(You may select the 'back' button  ")
         HTMLVIEWLINE(" and un-select transactions that don't belong to this claim.)</i></td></tr>")
                
         HTMLVIEWLINE("<tr><td colspan=4> Please select a dispute reason by clicking the button the transaction(s) ")
         HTMLVIEWLINE("correspond to, and answer the appropriate questions for the dispute reason. <i>(You may also ")
         HTMLVIEWLINE(" hover over each button for a description.)</i></td></tr>")
         
         HTMLVIEWLINE("<tr><td colspan=4><b><i><font size=2>Please Note: The "+TEMPNAME+" must attempt to contact the merchant to correct the situation before")
         HTMLVIEWLINE(" filing a dispute with RCU.</font></i></b></td></tr>")         
         HTMLVIEWLINE("</table>")
         
         [begin buttons for dispute reasons]
         HTMLVIEWLINE("<table align='center' border='0' width='90%'>")
      
         HTMLVIEWLINE("  <tr align='center'><td align='center' width='33%'>")
         HTMLVIEWLINE("<input type='submit' name='dispute01' value='Duplicate Billing' class='rcubuttonwidepale'")
         HTMLVIEWLINE(" title='Use this if one transaction is valid, but was posted more than once.'")
         HTMLVIEWLINE("  onClick="+Q+"javascript:show('disputeBlock01');")
         HTMLVIEWLINE("javascript:hide('disputeBlock02');javascript:hide('disputeBlock03');")
         HTMLVIEWLINE("javascript:hide('disputeBlock04');javascript:hide('disputeBlock05');")
         HTMLVIEWLINE("javascript:hide('disputeBlock06');javascript:hide('disputeBlock07');")
         HTMLVIEWLINE("javascript:hide('disputeBlock08');javascript:hide('disputeBlock09');")
         HTMLVIEWLINE("javascript:hide('disputeBlock10');javascript:hide('disputeBlock11');")         
         HTMLVIEWLINE("javascript:hide('disputeBlock12');"+Q+"></td>") 
      
         HTMLVIEWLINE("  <td align='center' width='33%'>")
         HTMLVIEWLINE("<input type='submit' name='dispute02' value='Overcharged' class='rcubuttonwidepale'")
         HTMLVIEWLINE(" title='Use this if the transaction posted for more than the correct amount.'")
         HTMLVIEWLINE("  onClick="+Q+"javascript:show('disputeBlock02');")
         HTMLVIEWLINE("javascript:hide('disputeBlock01');javascript:hide('disputeBlock03');")
         HTMLVIEWLINE("javascript:hide('disputeBlock04');javascript:hide('disputeBlock05');")
         HTMLVIEWLINE("javascript:hide('disputeBlock06');javascript:hide('disputeBlock07');")
         HTMLVIEWLINE("javascript:hide('disputeBlock08');javascript:hide('disputeBlock09');")
         HTMLVIEWLINE("javascript:hide('disputeBlock10');javascript:hide('disputeBlock11');")         
         HTMLVIEWLINE("javascript:hide('disputeBlock12');"+Q+"></td>")   
      
         HTMLVIEWLINE("  <td align='center' width='33%'>")
         HTMLVIEWLINE("<input type='submit' name='dispute03' value='Credit posted as sale' class='rcubuttonwidepale'")
         HTMLVIEWLINE("title='Use this if a credit was posted as a charge.'")
         HTMLVIEWLINE("  onClick="+Q+"javascript:show('disputeBlock03');")
         HTMLVIEWLINE("javascript:hide('disputeBlock01');javascript:hide('disputeBlock02');")
         HTMLVIEWLINE("javascript:hide('disputeBlock04');javascript:hide('disputeBlock05');")
         HTMLVIEWLINE("javascript:hide('disputeBlock06');javascript:hide('disputeBlock07');")
         HTMLVIEWLINE("javascript:hide('disputeBlock08');javascript:hide('disputeBlock09');")
         HTMLVIEWLINE("javascript:hide('disputeBlock10');javascript:hide('disputeBlock11');")         
         HTMLVIEWLINE("javascript:hide('disputeBlock12');"+Q+"></td>")   
         
         HTMLVIEWLINE(" <tr align='center'> <td align='center' width='33%'>")
         HTMLVIEWLINE("<input type='submit' name='dispute04' value='Credit not posted' class='rcubuttonwidepale'")
         HTMLVIEWLINE(" title='Use this if the credit was never posted to the account.'")
         HTMLVIEWLINE("  onClick="+Q+"javascript:show('disputeBlock04');")
         HTMLVIEWLINE("javascript:hide('disputeBlock02');javascript:hide('disputeBlock03');")
         HTMLVIEWLINE("javascript:hide('disputeBlock01');javascript:hide('disputeBlock05');")
         HTMLVIEWLINE("javascript:hide('disputeBlock06');javascript:hide('disputeBlock07');")
         HTMLVIEWLINE("javascript:hide('disputeBlock08');javascript:hide('disputeBlock09');")
         HTMLVIEWLINE("javascript:hide('disputeBlock10');javascript:hide('disputeBlock11');")         
         HTMLVIEWLINE("javascript:hide('disputeBlock12');"+Q+"></td>")           
        [ HTMLVIEWLINE("</tr>") ]        
      
      
         [HTMLVIEWLINE("  <td align='center' width='25%'>")
         HTMLVIEWLINE("<input type='submit' name='dispute05' value='Service Dispute' class='rcubuttonwidepale'")
         HTMLVIEWLINE(" title='Use this if there is a dispute about service rendered.'")
         HTMLVIEWLINE("  onClick="+Q+"javascript:show('disputeBlock05');")
         HTMLVIEWLINE("javascript:hide('disputeBlock02');javascript:hide('disputeBlock03');")
         HTMLVIEWLINE("javascript:hide('disputeBlock04');javascript:hide('disputeBlock01');")
         HTMLVIEWLINE("javascript:hide('disputeBlock06');javascript:hide('disputeBlock07');")
         HTMLVIEWLINE("javascript:hide('disputeBlock08');javascript:hide('disputeBlock09');")
         HTMLVIEWLINE("javascript:hide('disputeBlock10');javascript:hide('disputeBlock11');")         
         HTMLVIEWLINE("javascript:hide('disputeBlock12');"+Q+"></td>") 
         HTMLVIEWLINE("</td>")]
      
         HTMLVIEWLINE("  <td align='center' width='33%'>")
         HTMLVIEWLINE("<input type='submit' name='dispute06' value='Membership Cancellation' class='rcubuttonwidepale'")
         HTMLVIEWLINE(" title='Use this to dispute a charge about a canceled membership.'")
         HTMLVIEWLINE("  onClick="+Q+"javascript:show('disputeBlock06');")
         HTMLVIEWLINE("javascript:hide('disputeBlock01');javascript:hide('disputeBlock03');")
         HTMLVIEWLINE("javascript:hide('disputeBlock04');javascript:hide('disputeBlock05');")
         HTMLVIEWLINE("javascript:hide('disputeBlock02');javascript:hide('disputeBlock07');")
         HTMLVIEWLINE("javascript:hide('disputeBlock08');javascript:hide('disputeBlock09');")
         HTMLVIEWLINE("javascript:hide('disputeBlock10');javascript:hide('disputeBlock11');")         
         HTMLVIEWLINE("javascript:hide('disputeBlock12');"+Q+"></td>")   
      
         HTMLVIEWLINE("  <td align='center' width='33%'>")
         HTMLVIEWLINE("<input type='submit' name='dispute07' value='Product returned/damaged' class='rcubuttonwidepale'")
         HTMLVIEWLINE(" title='Use this if merchandise was returned, damaged, or defective.'")
         HTMLVIEWLINE("  onClick="+Q+"javascript:show('disputeBlock07');")
         HTMLVIEWLINE("javascript:hide('disputeBlock01');javascript:hide('disputeBlock02');")
         HTMLVIEWLINE("javascript:hide('disputeBlock04');javascript:hide('disputeBlock05');")
         HTMLVIEWLINE("javascript:hide('disputeBlock06');javascript:hide('disputeBlock03');")
         HTMLVIEWLINE("javascript:hide('disputeBlock08');javascript:hide('disputeBlock09');")
         HTMLVIEWLINE("javascript:hide('disputeBlock10');javascript:hide('disputeBlock11');")         
         HTMLVIEWLINE("javascript:hide('disputeBlock12');"+Q+"></td>")   
         HTMLVIEWLINE("</tr>") 
         
         
         HTMLVIEWLINE("<tr align='center'>  <td align='center' width='33%'>")
         HTMLVIEWLINE("<input type='submit' name='dispute08' value='Merchandise not received' class='rcubuttonwidepale'")
         HTMLVIEWLINE(" title='Use this if merchandise was paid for but never received.'")
         HTMLVIEWLINE("  onClick="+Q+"javascript:show('disputeBlock08');")
         HTMLVIEWLINE("javascript:hide('disputeBlock02');javascript:hide('disputeBlock03');")
         HTMLVIEWLINE("javascript:hide('disputeBlock04');javascript:hide('disputeBlock05');")
         HTMLVIEWLINE("javascript:hide('disputeBlock06');javascript:hide('disputeBlock07');")
         HTMLVIEWLINE("javascript:hide('disputeBlock01');javascript:hide('disputeBlock09');")
         HTMLVIEWLINE("javascript:hide('disputeBlock10');javascript:hide('disputeBlock11');")         
         HTMLVIEWLINE("javascript:hide('disputeBlock12');"+Q+"></td>")           
              
      
         HTMLVIEWLINE("  <td align='center' width='33%'>")
         HTMLVIEWLINE("<input type='submit' name='dispute09' value='Paid by other means' class='rcubuttonwidepale'")
         HTMLVIEWLINE(" title='Use this if payment was made by another method but card was still charged.'")
         HTMLVIEWLINE("  onClick="+Q+"javascript:show('disputeBlock09');")
         HTMLVIEWLINE("javascript:hide('disputeBlock02');javascript:hide('disputeBlock03');")
         HTMLVIEWLINE("javascript:hide('disputeBlock04');javascript:hide('disputeBlock05');")
         HTMLVIEWLINE("javascript:hide('disputeBlock06');javascript:hide('disputeBlock07');")
         HTMLVIEWLINE("javascript:hide('disputeBlock08');javascript:hide('disputeBlock01');")
         HTMLVIEWLINE("javascript:hide('disputeBlock10');javascript:hide('disputeBlock11');")         
         HTMLVIEWLINE("javascript:hide('disputeBlock12');"+Q+"></td>")
      
         HTMLVIEWLINE("  <td align='center' width='33%'>")
         HTMLVIEWLINE("<input type='submit' name='dispute10' value='Travel cancellation' class='rcubuttonwidepale'")
         HTMLVIEWLINE(" title=")
         HTMLVIEWLINE("'Use this if a hotel room, car rental or flight was canceled but the transaction still posted to the card.'")
         HTMLVIEWLINE("  onClick="+Q+"javascript:show('disputeBlock10');")
         HTMLVIEWLINE("javascript:hide('disputeBlock02');javascript:hide('disputeBlock03');")
         HTMLVIEWLINE("javascript:hide('disputeBlock04');javascript:hide('disputeBlock05');")
         HTMLVIEWLINE("javascript:hide('disputeBlock06');javascript:hide('disputeBlock07');")
         HTMLVIEWLINE("javascript:hide('disputeBlock08');javascript:hide('disputeBlock09');")
         HTMLVIEWLINE("javascript:hide('disputeBlock01');javascript:hide('disputeBlock11');")         
         HTMLVIEWLINE("javascript:hide('disputeBlock12');"+Q+"></td>")   
      
         [options for "service dispute", "do not recognize" and "other" temporarily removed until forms can be improved sbw 11/24/14]
         [HTMLVIEWLINE("  <td align='center' width='25%'>")
         HTMLVIEWLINE("<input type='submit' name='dispute11' value='Do not recognize' class='rcubuttonwidepale'")
         HTMLVIEWLINE("title='Use this if transaction(s) are not recognized.'")
         HTMLVIEWLINE("  onClick="+Q+"javascript:show('disputeBlock11');")
         HTMLVIEWLINE("javascript:hide('disputeBlock02');javascript:hide('disputeBlock03');")
         HTMLVIEWLINE("javascript:hide('disputeBlock04');javascript:hide('disputeBlock05');")
         HTMLVIEWLINE("javascript:hide('disputeBlock06');javascript:hide('disputeBlock07');")
         HTMLVIEWLINE("javascript:hide('disputeBlock08');javascript:hide('disputeBlock09');")
         HTMLVIEWLINE("javascript:hide('disputeBlock10');javascript:hide('disputeBlock01');")         
         HTMLVIEWLINE("javascript:hide('disputeBlock12');"+Q+"></td>")   
         
         HTMLVIEWLINE("  <td align='center' width='25%'>")
         HTMLVIEWLINE("<input type='submit' name='dispute12' value='Other' class='rcubuttonwidepale'")
         HTMLVIEWLINE(" title='Use this if the transaction does not fall into any other categories above.'")
         HTMLVIEWLINE("  onClick="+Q+"javascript:show('disputeBlock12');")
         HTMLVIEWLINE("javascript:hide('disputeBlock02');javascript:hide('disputeBlock03');")
         HTMLVIEWLINE("javascript:hide('disputeBlock04');javascript:hide('disputeBlock05');")
         HTMLVIEWLINE("javascript:hide('disputeBlock06');javascript:hide('disputeBlock07');")
         HTMLVIEWLINE("javascript:hide('disputeBlock08');javascript:hide('disputeBlock09');")
         HTMLVIEWLINE("javascript:hide('disputeBlock10');javascript:hide('disputeBlock11');")         
         HTMLVIEWLINE("javascript:hide('disputeBlock01');"+Q+"></td>")  ]        
         HTMLVIEWLINE("</tr>")                                
         HTMLVIEWLINE("</table>")
 
         [billed twice]
         IF DISPUTEBUTTON=1 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock01' style='display:block;' cellspacing=0 CELLPADDING=5 width=90%>")
         IF DISPUTEBUTTON<>1 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock01' style='display:none;' cellspacing=0 CELLPADDING=5 width=90%>")
         HTMLVIEWLINE("<tr><td colspan=4><b>The "+TEMPNAME+" was billed multiple times for a single purchase.</b> The "+TEMPNAME+" certifies that one ")
         HTMLVIEWLINE("transaction is valid, but posted more than once.")
         IF TEMPNAME="Business" THEN HTMLVIEWLINE(" and/or its employees.</td></tr>")
         IF TEMPNAME="Member" THEN HTMLVIEWLINE(".</td></tr>")
         HTMLVIEWLINE("<tr><td align=right>Valid Transaction Amount: </td>")
         HTMLVIEWLINE("<td align=left><input type='text'  name='sd01' value='"+SD01+"' size=15 maxlength=15")
         HTMLVIEWLINE("onKeyDown="+Q+"return(RCUCurrencyFormat(this,',','.',event)); "+Q)
         HTMLVIEWLINE("onKeyUp="+Q+"return false;"+Q+" />")
         HTMLVIEWLINE("</td>") 
         HTMLVIEWLINE("<td align=right>Date Valid Transaction posted: </td>")
         HTMLVIEWLINE("<td align=left><input type='text' size = 10 maxlength = 10 name='sd02' value ='"+SD02+"'")
         HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
         HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
         HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q)
         HTMLVIEWLINE("      ></td></tr>")
         HTMLVIEWLINE("</table>")
         
         [overcharged]
         IF DISPUTEBUTTON=2 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock02' style='display:block;' cellspacing=0 CELLPADDING=5 width=90%>")
         IF DISPUTEBUTTON<>2 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock02' style='display:none;' cellspacing=0 CELLPADDING=5 width=90%>")         
         HTMLVIEWLINE("<tr><td><b>The "+TEMPNAME+" was overcharged for the purchase:</b> A copy of the signed sales receipt, invoice or email confirmation should ")
         HTMLVIEWLINE(" be scanned to "+DEPARTMENTNAME+", referencing the claim number. (The claim number will be available on the next screen.)</td></tr>")
         
         HTMLVIEWLINE("<tr><td><font color=red>Please make sure the disputed amount is the difference the cardholder authorized, ")
         HTMLVIEWLINE("NOT what was charged.</font></td></tr>")
         
         HTMLVIEWLINE("</td></tr>")
         HTMLVIEWLINE("</table>")
         
         [credit posted as sale]
         IF DISPUTEBUTTON=3 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock03' style='display:block;' cellspacing=0 CELLPADDING=5 width=90%>")
         IF DISPUTEBUTTON<>3 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock03' style='display:none;' cellspacing=0 CELLPADDING=5 width=90%>")                  
         HTMLVIEWLINE("<tr><td><b>The credit posted as a sale.</b> A copy of the credit slip or note of credit from the merchant should be scanned to ")
         HTMLVIEWLINE(DEPARTMENTNAME+", referencing the claim number. (The claim number will be available on the next screen.)</td></tr>")
         HTMLVIEWLINE("</table>")
         
         [credit did not post]
         IF DISPUTEBUTTON=4 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock04' style='display:block;' cellspacing=0 CELLPADDING=5 width=90%>")
         IF DISPUTEBUTTON<>4 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock04' style='display:none;' cellspacing=0 CELLPADDING=5 width=90%>")         
         HTMLVIEWLINE("<tr><td><b>The credit did not post to the "+TEMPNAME+"'s account.</b> A copy of the credit slip or notice of credit from the merchant, ")
         HTMLVIEWLINE(" along with a detailed explanation, should be scanned to "+DEPARTMENTNAME+", referencing the claim number. (The claim number will be ")
         HTMLVIEWLINE(" available on the next screen.)</td></tr>")
         HTMLVIEWLINE("</table>")

         [service dispute]
         IF DISPUTEBUTTON=5 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock05' style='display:block;' cellspacing=0 CELLPADDING=5 width=90%>")
         IF DISPUTEBUTTON<>5 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock05' style='display:none;' cellspacing=0 CELLPADDING=5 width=90%>")         
         HTMLVIEWLINE("<tr><td><b>The "+TEMPNAME+" wishes to dispute services provided by a merchant (e.g., auto repair, home repair, salon services, etc.). </b>")
         HTMLVIEWLINE(" The "+TEMPNAME+" will need to provide a detailed description of the nature of the dispute, including attempts at resolution. Other  ")
         HTMLVIEWLINE(" supporting documents, such as copies of second opinions from certified merchants on their invoice or letterhead, repair bills,  ")
         HTMLVIEWLINE(" contracts or other supporting documents should be scanned to  "+DEPARTMENTNAME+", referencing the claim number. (The claim number ")
         HTMLVIEWLINE(" will be available on the next screen.)</td></tr>")         
         HTMLVIEWLINE("</table>")

         [membership cancellation]
         IF DISPUTEBUTTON=6 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock06' style='display:block;' cellspacing=0 CELLPADDING=5 width=90%>")
         IF DISPUTEBUTTON<>6 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock06' style='display:none;' cellspacing=0 CELLPADDING=5 width=90%>")         
         HTMLVIEWLINE("<tr><td colspan=4><b>The Member canceled with the merchant, but was still charged (e.g., gym membership, etc.). </b>")
         HTMLVIEWLINE(" A copy of the letter, email, or fax informing the merchant of cancellation should be scanned to "+DEPARTMENTNAME+", referencing")
         HTMLVIEWLINE("the claim number. (The claim number will be available on the next screen.)</td></tr>")
         
         HTMLVIEWLINE("<tr><td colspan=2>") 
         HTMLVIEWLINE("What date did "+TEMPNAME+" contact the merchant to cancel?</td>")
         HTMLVIEWLINE("<td colspan=2><input type='text' size = 10 maxlength = 10 name='sd06' value ='"+SD06+"'")
         HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
         HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
         HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q)
         HTMLVIEWLINE("      ></td></tr>") 
         
         HTMLVIEWLINE("<tr><td>Reason for cancellation:</td>")
         HTMLVIEWLINE("<td colspan=3><input type='text'  name='sd07' value ='"+SD07+"' size=80 maxlength=80> </td></tr>")
         
         HTMLVIEWLINE("<tr><td>Date of cancellation:</td>")
         HTMLVIEWLINE("<td><input type='text' size = 10 maxlength = 10 name='sd09' value ='"+SD09+"'")
         HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
         HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
         HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q)  
         HTMLVIEWLINE("      ></td>")
         HTMLVIEWLINE("<td>Cancellation #:</td>")
         HTMLVIEWLINE("<td><input type='text'  name='sd10' value ='"+SD10+"' size=30 maxlength=30> </td>") 
         HTMLVIEWLINE("</tr>") 
         
         HTMLVIEWLINE("<tr><td colspan=2>Was "+TEMPNAME+" advised of a cancellation policy?</td>")
         HTMLVIEWLINE("<td colspan=2><select name='sd11'>")
         FOR X=0 TO 2
          DO
           IF X=SDSELECT11 THEN 
            HTMLVIEWLINE("<option SELECTED value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
           ELSE     
            HTMLVIEWLINE("<option value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
           HTMLVIEWLINE("</br>")
          END
         HTMLVIEWLINE("</select></td></tr>")

         HTMLVIEWLINE("<tr><td>If Yes, what was "+TEMPNAME+" told?</td>")
         HTMLVIEWLINE("<td colspan=3><input type='text'  name='sd12' value ='"+SD12+"' size=80 maxlength=80> </td></tr>")             
         HTMLVIEWLINE("</table>")
         
         [merchandise returned, damaged or defective]
         IF DISPUTEBUTTON=7 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock07' style='display:block;' cellspacing=0 CELLPADDING=5 width=90%>")
         IF DISPUTEBUTTON<>7 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock07' style='display:none;' cellspacing=0 CELLPADDING=5 width=90%>")         
         HTMLVIEWLINE("<tr><td colspan=4><b>Merchandise was returned, damaged or defective.</b> "+TEMPNAME+" must attempt to return the merchandise ")    
         HTMLVIEWLINE(" prior to exercising this right.  Please scan signed proof of return or credit slip and ")
         HTMLVIEWLINE(" scan them to "+DEPARTMENTNAME+", referencing the claim number (you will see this on the next screen).</td></tr>")         

         HTMLVIEWLINE("<tr><td>What was purchased?</td>")
         HTMLVIEWLINE("<td colspan=3><input type='text'  name='sd14' value ='")
         HTMLVIEWLINE(SD14)
         HTMLVIEWLINE("' size=80 maxlength=80> </td></tr>")
         
         HTMLVIEWLINE("<tr><td>What was received?</td>")
         HTMLVIEWLINE("<td colspan=3><input type='text'  name='sd15' value ='")
         HTMLVIEWLINE(SD15)
         HTMLVIEWLINE("' size=80 maxlength=80> </td></tr>")
         
         HTMLVIEWLINE("<tr><td>Reason for returning?</td>")
         HTMLVIEWLINE("<td colspan=3><input type='text'  name='sd16' value ='")
         HTMLVIEWLINE(SD16)
         HTMLVIEWLINE("' size=80 maxlength=80> </td></tr>")
         
         HTMLVIEWLINE("<tr><td>Why was merchandise unsuitable for the purpose intended?</td>")
         HTMLVIEWLINE("<td colspan=3><input type='text'  name='sd17' value ='")
         HTMLVIEWLINE(SD17)
         HTMLVIEWLINE("' size=48 maxlength=48> </td></tr>")
         
         HTMLVIEWLINE("<tr><td>Merchant's response: </td>")
         HTMLVIEWLINE("<td colspan=3><input type='text'  name='sd18' value ='")
         HTMLVIEWLINE(SD18)
         HTMLVIEWLINE("' size=70 maxlength=70> </td></tr>")          
         HTMLVIEWLINE("</table>")

         [did not receive merchandise]
         IF DISPUTEBUTTON=8 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock08' style='display:block;' cellspacing=0 CELLPADDING=5 width=90%>")
         IF DISPUTEBUTTON<>8 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock08' style='display:none;' cellspacing=0 CELLPADDING=5 width=90%>")         
         HTMLVIEWLINE("<tr><td colspan=4><b>The "+TEMPNAME+" has not received the merchandise.</b> The "+ TEMPNAME+" must contact the merchant prior to filing a ")
         HTMLVIEWLINE("dispute, and notify us of the outcome.  Please scan any additional documents or correspondence to "+DEPARTMENTNAME+", referencing the ")
         HTMLVIEWLINE(" claim number. (The claim number will be available on the next screen.)</td></tr>")

         HTMLVIEWLINE("<tr><td colspan=2>What date did "+TEMPNAME+" contact the merchant?</td>")
         HTMLVIEWLINE("<td colspan=2 align=left><input type='text' size = 10 maxlength = 10 name='sd19' value ='"+SD19+"'")
         HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
         HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
         HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q)
         HTMLVIEWLINE("      ></td></tr>") 
         
         HTMLVIEWLINE("<tr><td>What was the outcome of the merchant contact?</td>")
         HTMLVIEWLINE("<td colspan=3><input type='text'  name='sd20' value ='")
         HTMLVIEWLINE(SD20)
         HTMLVIEWLINE("' size=80 maxlength=80 ></td></tr>")
         
         HTMLVIEWLINE("<tr><td>What was the expected delivery date?</td>")
         HTMLVIEWLINE("<td><input type='text' size = 10 maxlength = 10 name='sd22' value ='"+SD22+"'")
         HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
         HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
         HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q)
         HTMLVIEWLINE("      ></td>")         
         HTMLVIEWLINE("<td>Pickup date?</td>")
         HTMLVIEWLINE("<td><input type='text' size = 10 maxlength = 10 name='sd23' value ='"+SD23+"'")
         HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
         HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
         HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q)
         HTMLVIEWLINE("      ></td></tr>") 
         
         HTMLVIEWLINE("<tr><td colspan=2>Did "+TEMPNAME+" cancel with the merchant?</td>")
         HTMLVIEWLINE("<td colspan=2><select name='sd24'>")
         FOR X=0 TO 2
          DO
           IF X=SDSELECT24 THEN 
            HTMLVIEWLINE("<option SELECTED value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
           ELSE     
            HTMLVIEWLINE("<option value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
           HTMLVIEWLINE("</br>")
          END
         HTMLVIEWLINE("</select></td></tr>")
         HTMLVIEWLINE("<tr><td></td><td>If Yes, when?</td>")
         HTMLVIEWLINE("<td colspan=2><input type='text' size = 10 maxlength = 10 name='sd25' value ='"+SD25+"'")
         HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
         HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
         HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q)
         HTMLVIEWLINE("      ></td></tr>")                
         
         HTMLVIEWLINE("<tr><td>How? (e.g., telephone or email)</td>")
         HTMLVIEWLINE("<td colspan=3><input type='text'  name='sd26' value ='"+SD26+"' size=40 maxlength=40 ></td></tr>")
         
         HTMLVIEWLINE("<tr><td>What was the merchandise that was ordered?</td>")
         HTMLVIEWLINE("<td colspan=3><input type='text'  name='sd27' value ='"+SD27+"' size=40 maxlength=40 ></td></tr>")         
         HTMLVIEWLINE("</table>")

         [paid by other means]
         IF DISPUTEBUTTON=9 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock09' style='display:block;' cellspacing=0 CELLPADDING=5 width=90%>")
         IF DISPUTEBUTTON<>9 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock09' style='display:none;' cellspacing=0 CELLPADDING=5 width=90%>")         
         HTMLVIEWLINE("<tr><td colspan=4><b>The "+TEMPNAME+" has paid by other means (e.g., cash, different credit card, etc.).</b> The "+TEMPNAME+" must provide")
         HTMLVIEWLINE(" proof of payment by other means, such as a copy of the")
         HTMLVIEWLINE(" cancelled check (front & back), a cash receipt, or a billing statement from another credit card. Please scan the documentation ")
         HTMLVIEWLINE(" to "+DEPARTMENTNAME+", referencing the claim number. (The claim number will be available on the next screen.)</td></tr>")
         
         HTMLVIEWLINE("<tr><td colspan=2>What date did "+TEMPNAME+" contact the merchant?</td>")
         HTMLVIEWLINE("<td colspan=2><input type='text' size = 10 maxlength = 10 name='sd03' value ='"+SD03+"'")
         HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
         HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
         HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q)
         HTMLVIEWLINE("      ></td></tr>") 
         
         HTMLVIEWLINE("<tr><td>What was the outcome of the merchant contact?</td>")
         HTMLVIEWLINE("<td colspan=3><input type='text'  name='sd04' value ='")
         HTMLVIEWLINE(SD04)
         HTMLVIEWLINE("' size=80 maxlength=80 ></td></tr>")       
         HTMLVIEWLINE("</table>")

         [Travel cancellation; was hotel room cancellation]
         IF DISPUTEBUTTON=10 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock10' style='display:block;' cellspacing=0 CELLPADDING=5 width=90%>")
         IF DISPUTEBUTTON<>10 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock10' style='display:none;' cellspacing=0 CELLPADDING=5 width=90%>")         
         HTMLVIEWLINE("<tr><td colspan=4><b>The "+TEMPNAME+" was charged for a hotel room, car rental or flight that was canceled:</b> Please note: A cancellation ")
         HTMLVIEWLINE("number is required!  Please also obtain a copy of the phone bill indicating the date/time")
         HTMLVIEWLINE(" that the "+TEMPNAME+" contacted the merchant to cancel. This copy should be scanned to "+DEPARTMENTNAME+",")
         HTMLVIEWLINE("referencing the claim number. (The claim number will be available on the next screen.)</td></tr>")
         
         HTMLVIEWLINE("<tr><td colspan=2>Was "+TEMPNAME+" advised of a cancellation policy?</td>")
         HTMLVIEWLINE("<td colspan=2 align=left><select name='sd28'>")
         FOR X=0 TO 2
          DO
           IF X=SDSELECT28 THEN 
            HTMLVIEWLINE("<option SELECTED value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
           ELSE     
            HTMLVIEWLINE("<option value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
           HTMLVIEWLINE("</br>")
          END
         HTMLVIEWLINE("</select></td></tr>") 
         
         HTMLVIEWLINE("<tr><td>If Yes, what was the policy?</td>")
         HTMLVIEWLINE("<td colspan=3><input type='text'  name='sd29' value ='")
         HTMLVIEWLINE(SD29)
         HTMLVIEWLINE("' size=50 maxlength=55 ></td></tr>")        
         
         
         HTMLVIEWLINE("<tr><td>Cancellation Number:</td>")
         HTMLVIEWLINE("<td><input type='text'  name='sd30' value ='"+SD30+"' size=15 maxlength=15 </td>")
         HTMLVIEWLINE("<td>Cancel date:</td>")
         HTMLVIEWLINE("<td><input type='text' size = 10 maxlength = 10 name='sd31' value ='"+SD31+"'")
         HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
         HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
         HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q)
         HTMLVIEWLINE("      ></td></tr>")         
         HTMLVIEWLINE("</table>")

         [does not recognize]
         IF DISPUTEBUTTON=11 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock11' style='display:block;' cellspacing=0 CELLPADDING=5 width=90%>")
         IF DISPUTEBUTTON<>11 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock11' style='display:none;' cellspacing=0 CELLPADDING=5 width=90%>")         
         HTMLVIEWLINE("<tr><td colspan=4><b>"+TEMPNAME+" does not recognize transaction:</b> Please note: No credit will be issued for this dispute reason. ")
         HTMLVIEWLINE("RCU will provide additional information regarding the transaction(s) to help "+TEMPNAME+" identify the transaction.</td></tr>")
         
         HTMLVIEWLINE("<tr><td colspan=2>What date did "+TEMPNAME+" contact the merchant?</td>")
         HTMLVIEWLINE("<td colspan=2><input type='text' size = 10 maxlength = 10 name='sd32' value ='"+SD32+"'")
         HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
         HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
         HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q)
         HTMLVIEWLINE("      ></td></tr>")
               
         HTMLVIEWLINE("<tr><td>What was the outcome of the merchant contact?</td>")
         HTMLVIEWLINE("<td colspan=3><input type='text'  name='sd33' value ='"+SD33+"' size=50 maxlength=50></td></tr>")                                     
         HTMLVIEWLINE("</table>")

         [other]
         IF DISPUTEBUTTON=12 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock12' style='display:block;' cellspacing=0 CELLPADDING=5 width=90%>")
         IF DISPUTEBUTTON<>12 THEN HTMLVIEWLINE("<table align='center' border='0' id='disputeBlock12' style='display:none;' cellspacing=0 CELLPADDING=5 width=90%>")         
         HTMLVIEWLINE("<tr><td><b>The transaction in dispute does not fall in any of the other categories. </b> The "+TEMPNAME+" will need to submit a detailed ")
         HTMLVIEWLINE("description and scan it, and any other supporting documents/correspondence to "+DEPARTMENTNAME+", referencing ")
         HTMLVIEWLINE("the claim number. (The claim number will be available on the next screen.)</td></tr>")
         HTMLVIEWLINE("</table>")
                   
        END   [BUTTONCLICK=DISPUTE]           
     
      END [BUTTONCLICKED<>FALSE] 
     HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")
     HTMLVIEWLINE("<tr><td colspan=4><hr/></td></tr>")     
     HTMLVIEWLINE("</TABLE>")        
    
    END  [SIGBASED]   

   [PIN BASED FORM]
   IF FORMTYPES(PINBASED)<>FALSE THEN
    DO
    
     HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")    
    
     HTMLVIEWLINE("<TR><TD COLSPAN=4 ALIGN=CENTER><h3>PIN-based transactions</h3></TD></TR>")

    IF FORMTYPES(PINBASED)>29 THEN
     DO
      ECOUNT=ECOUNT+1
      RETURNERROR(PTOOMANYTXNS)=TRUE
     END     
  
     IF ECOUNT>0 THEN
      DO   
       HTMLVIEWLINE(" <tr ><td colspan=4 align=center>")
       FOR E=12 TO 26  [PIN-BASED TRAN SECTION ERRORS]
        DO
         IF RETURNERROR(E)=TRUE THEN
          DO           
           ERRORTEXTOUTPUT=ERRTEXT(E)         
           HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font></br>")            
          END
        END
       IF RETURNERROR(PNODESC)=TRUE THEN   [PIN ERROR OUT OF SEQUENCE ABOVE]
        DO
         ERRORTEXTOUTPUT=ERRTEXT(PNODESC)         
         HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font></br>")            
        END    
       IF RETURNERROR(PTOOMANYTXNS)=TRUE THEN
        DO                
         ERRORTEXTOUTPUT=ERRTEXT(PTOOMANYTXNS)         
         HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font></br>")            
        END  
       IF RETURNERROR(BADDATE)=TRUE THEN
        DO           
         ERRORTEXTOUTPUT=ERRTEXT(E)         
         HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font></br>")            
        END                    
       HTMLVIEWLINE(" </td></tr >")
      END      
     
     IF CARDTRUNC<>"00000000" THEN
      HTMLVIEWLINE("<TR><TD COLSPAN=4 ALIGN=CENTER>These will apply to card ending "+CARDTRUNC+" for "+CLONGNAME(SELECTEDNAME)+" </TD></TR>")
     ELSE
      DO
       HTMLVIEWLINE("<TR><TD COLSPAN=4 ALIGN=CENTER><FONT COLOR=RED><STRONG>No card was selected! Please go back and select ")
       HTMLVIEWLINE(" the card that this claim applies to.</STRONG></font></br> You will not be allowed to continue without")
       HTMLVIEWLINE(" selecting a card.</TD></TR>")
       HTMLVIEWLINE("<TR><td colspan=4 align=center><input type='submit' name='gowayback' value='Go Back' class='rcubutton'></td></tr>")
      END
      
     IF ISBUSINESS=TRUE THEN 
      DO
       FORMTOUSE(PINBASED)="AS1312"
       TEMPNAME="Business"
      END
     IF ISBUSINESS=FALSE THEN 
      DO
       FORMTOUSE(PINBASED)="AS1307"
       TEMPNAME="Member"
      END
 
     IF FOUNDCLAIMNOTE>0 THEN
      DO      
       FOR F=1 TO FOUNDCLAIMNOTE
        DO
         IF SEGMENT(CLAIMNUM(F),11,11)="P" THEN
          DO
           FOUNDPINNOTE=TRUE
           HTMLVIEWLINE("<tr><td colspan=4><b>There is one or more open PIN-based claim on this share.</b></td></tr>")
           HTMLVIEWLINE("<tr>")
           HTMLVIEWLINE("<td colspan=2>")
           HTMLVIEWLINE("<b>What would you like to do?</b>")
           HTMLVIEWLINE("</td>") 
           HTMLVIEWLINE("<td colspan=2>")   
           HTMLVIEWLINE("<select name='pappendClaim'>")
           IF PAPPENDCLAIM=0 THEN HTMLVIEWLINE("<option SELECTED value='0' >Please Select:</option>")
            ELSE
           HTMLVIEWLINE("<option value='0' >Please Select:</option>")
           FOR F=1 TO FOUNDCLAIMNOTE
            DO
             IF SEGMENT(CLAIMNUM(F),11,11)="P" THEN
              DO            
               IF F=PAPPENDCLAIM THEN 
                HTMLVIEWLINE("<option SELECTED value='" + FORMAT("99",F) + "' >Append to claim "+ CLAIMNUM(F)+"</option>")
               ELSE     
                HTMLVIEWLINE("<option value='" + FORMAT("99",F) + "' >Append to claim "+ CLAIMNUM(F)+"</option>")
               HTMLVIEWLINE("</br>")
              END
            END
           IF PAPPENDCLAIM=99 THEN HTMLVIEWLINE("<option SELECTED value='99' >Create New Claim</option>") 
            ELSE
           HTMLVIEWLINE("<option value='99' >Create New Claim</option>") 
           
           HTMLVIEWLINE("</select></td>")      
           HTMLVIEWLINE("</tr>")
           HTMLVIEWLINE("<tr>")
           HTMLVIEWLINE("<td colspan=4 align=center>") 
           HTMLVIEWLINE("Note: Claims starting with an "+q+"F"+Q+" are for <b>Fraud</b>; "+Q+"D"+Q+" are for <b>Dispute</b>. If you are appending")
           HTMLVIEWLINE(" to an existing claim, make sure the new claim info is of the same type.") 
           HTMLVIEWLINE("</td></tr>")           
          END
        END
      END
      
     IF FOUNDCLAIMNOTE=0 OR FOUNDPINNOTE=FALSE THEN
      DO
       HTMLVIEWLINE("<TR><TD COLSPAN=4><i>No existing PIN-based claims found for this card & share. A new claim number will be assigned.</i></td>") 
       HTMLVIEWLINE("</tr>")
      END       
     
     HTMLVIEWLINE("<TR><TD COLSPAN=4>The following transaction(s) will appear on the form:")
     HTMLVIEWLINE("<OL>")
     FOR T=1 TO 200
      DO    
       IF TSELECT(T)=TRUE AND CHARACTERSEARCH(TXN(T,TTYPE),"PIN")>0 THEN 
        DO
         HTMLVIEWLINE("<LI>"+TXN(T,TDATE)+" "+TXN(T,TAMT)+" "+TXN(T,TDESC)+"</LI>")        
        END
      END
     HTMLVIEWLINE("</OL></TD></TR>")                
   
     HTMLVIEWLINE("<TR><TD COLSPAN=4><b>Please describe the transaction(s):</b></BR>")   
    
     HTMLVIEWLINE("<input type='text'  name='pbdesc1 ' value ='")
     HTMLVIEWLINE(PBDESC1)
     HTMLVIEWLINE("' size=80 maxlength=80> </BR>")  
     
     HTMLVIEWLINE("<input type='text'  name='pbdesc2 ' value ='")
     HTMLVIEWLINE(PBDESC2)
     HTMLVIEWLINE("' size=80 maxlength=80> </BR>") 
     
     HTMLVIEWLINE("<input type='text'  name='pbdesc3 ' value ='")
     HTMLVIEWLINE(PBDESC3)
     HTMLVIEWLINE("' size=80 maxlength=80></BR>") 
     HTMLVIEWLINE("</TD></tr>")
    
    
     HTMLVIEWLINE("<tr>")
     HTMLVIEWLINE("<td colspan=2>")
     HTMLVIEWLINE("<b>Is this transaction/these transactions a result of fraud?</b>")
     HTMLVIEWLINE("</td>") 
     HTMLVIEWLINE("<td colspan=2>")   
     HTMLVIEWLINE("<select name='pb6'>")
     FOR X=0 TO 2
      DO
       IF X=PBSELECT6 THEN 
        HTMLVIEWLINE("<option SELECTED value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
       ELSE     
        HTMLVIEWLINE("<option value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
       HTMLVIEWLINE("</br>")
      END
     HTMLVIEWLINE("</select></td>")      
     HTMLVIEWLINE("<td colspan=2></td></tr>")      

     HTMLVIEWLINE("<TR><TD COLSPAN=4><b>If these are fraud transactions, please answer these questions:</b></TD></TR>")
 
     HTMLVIEWLINE("<TR>")   
     HTMLVIEWLINE("<td>")
     HTMLVIEWLINE("<b>1. Was the card lost?</b>")
     HTMLVIEWLINE("</td>") 
     HTMLVIEWLINE("<td>")   
     HTMLVIEWLINE("<select name='pb1'>")
     FOR X=0 TO 2
      DO
       IF X=PBSELECT1 THEN 
        HTMLVIEWLINE("<option SELECTED value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
       ELSE     
        HTMLVIEWLINE("<option value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
       HTMLVIEWLINE("</br>")
      END
     HTMLVIEWLINE("</select></td>") 
     HTMLVIEWLINE("<td colspan=2></td></tr>")     
     HTMLVIEWLINE("<tr>")
     HTMLVIEWLINE("<td>")
     HTMLVIEWLINE("<b>2. Was the card stolen?</b>")
     HTMLVIEWLINE("</td>") 
     HTMLVIEWLINE("<td>")   
     HTMLVIEWLINE("<select name='pb2'>")
     FOR X=0 TO 2
      DO
       IF X=PBSELECT2 THEN 
        HTMLVIEWLINE("<option SELECTED value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
       ELSE     
        HTMLVIEWLINE("<option value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
       HTMLVIEWLINE("</br>")
      END
     HTMLVIEWLINE("</select></td>")      
     HTMLVIEWLINE("<td colspan=2></td></tr>")
           
     HTMLVIEWLINE("<TR><TD COLSPAN=4>If "+q+"<b>YES</b>"+q+" was answered for either #1 or #2, please answer the following (a-e):</td></tr>") 

     HTMLVIEWLINE("<TR>")
     HTMLVIEWLINE("<td colspan=4>")
     HTMLVIEWLINE("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a. When did "+TEMPNAME+" first realize the card was missing?")
     HTMLVIEWLINE("</td></tr>")
     HTMLVIEWLINE("<tr><td></td>")
     HTMLVIEWLINE("<td>Date: <input type='text' size = 10 maxlength = 10 name='pb2a1' value ='"+PB2A1+"'")
     HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
     HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
     HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q+"></td>")
     
     HTMLVIEWLINE("<td>Time (incl. AM/PM): <input type='text'  name='pb2a2' value ='")
     HTMLVIEWLINE(PB2A2)
     HTMLVIEWLINE("' size=10 maxlength=10 ></td>") 

     HTMLVIEWLINE("<td>Location: <input type='text'  name='pb2a3' value ='")
     HTMLVIEWLINE(PB2A3)
     HTMLVIEWLINE("' size=30 maxlength=30> </td>")
     HTMLVIEWLINE("</tr>")

     HTMLVIEWLINE("<tr><td colspan=4>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b. Date of last authorized transaction:")
     HTMLVIEWLINE("<input type='text' size = 10 maxlength = 10 name='pb2b' value ='"+PB2B+"'")
     HTMLVIEWLINE("       size='10' maxlength='10' onFocus="+Q+"javascript:vDateType='1'"+Q)
     HTMLVIEWLINE("       onKeyUp="+Q+"DateFormat(this,this.value,event,false,'1')"+Q)
     HTMLVIEWLINE("       onBlur="+Q+"DateFormat(this,this.value,event,true,'1')"+Q+"></td></tr>")
     
     HTMLVIEWLINE("<tr><td colspan=3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c. Law enforcement agency: <input type='text'  name='pb2c1' value ='")
     HTMLVIEWLINE(PB2C1)
     HTMLVIEWLINE("' size=30 maxlength=30> </td>") 
     HTMLVIEWLINE("<td>Police report number:<input type='text'  name='pb2c2' value ='")
     HTMLVIEWLINE(PB2C2)
     HTMLVIEWLINE("' size=20 maxlength=20> </td></tr>") 
     
     HTMLVIEWLINE("<tr><td colspan=4>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d. Describe the Suspect (if applicable): <input type='text'  name='pb2d' value ='")
     HTMLVIEWLINE(PB2D)
     HTMLVIEWLINE("' size=40 maxlength=40 ></td></tr>") 

     HTMLVIEWLINE("<tr><td colspan=4>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e. Describe other items lost/stolen (e.g., ID, Credit Cards):")
     HTMLVIEWLINE(" <input type='text'  name='pb2e' value ='")
     HTMLVIEWLINE(PB2E)
     HTMLVIEWLINE("' size=40 maxlength=40 ></td></tr>") 

     HTMLVIEWLINE("<tr><td colspan=3><b>3. Was the Personal Identification Number (PIN) with the card?</b></td>")
     HTMLVIEWLINE("<td>")
     HTMLVIEWLINE("<select name='pb3'>")
     FOR X=0 TO 2
      DO
       IF X=PBSELECT3 THEN 
        HTMLVIEWLINE("<option SELECTED value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
       ELSE     
        HTMLVIEWLINE("<option value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
       HTMLVIEWLINE("</br>")
      END
     HTMLVIEWLINE("</select></td>")      
     HTMLVIEWLINE("</tr>") 
     
     HTMLVIEWLINE("<tr><td colspan=2><b>4. Was the PIN written anywhere?</b></td>")
     HTMLVIEWLINE("<td>")
     HTMLVIEWLINE("<select name='pb4a'>")
     FOR X=0 TO 2
      DO
       IF X=PBSELECT4 THEN 
        HTMLVIEWLINE("<option SELECTED value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
       ELSE     
        HTMLVIEWLINE("<option value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
       HTMLVIEWLINE("</br>")
      END
     HTMLVIEWLINE("</select></td>")
     HTMLVIEWLINE("<td colspan=2>If yes, where?")      
     HTMLVIEWLINE(" <input type='text'  name='pb4b' value ='")
     HTMLVIEWLINE(PB4B)
     HTMLVIEWLINE("' size=40 maxlength=40 ></td></tr>")     
     
     HTMLVIEWLINE("<tr><td colspan=2><b>5. Has "+TEMPNAME+" ever allowed anyone else to use the card?</b></td>")
     HTMLVIEWLINE("<td>")
     HTMLVIEWLINE("<select name='pb5a'>")
     FOR X=0 TO 2
      DO
       IF X=PBSELECT5 THEN 
        HTMLVIEWLINE("<option SELECTED value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
       ELSE     
        HTMLVIEWLINE("<option value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
       HTMLVIEWLINE("</br>")
      END
     HTMLVIEWLINE("</select></td>")
     HTMLVIEWLINE("<td colspan=2>If yes, who?")      
     HTMLVIEWLINE(" <input type='text'  name='pb5b' value ='")
     HTMLVIEWLINE(PB5B)
     HTMLVIEWLINE("' size=40 maxlength=40 ></td></tr>")                          

     HTMLVIEWLINE("<tr><td colspan=4><hr/></td></tr>")     
     HTMLVIEWLINE("</TABLE>")
    END [PINBASED]

   [draft]
   IF FORMTYPES(DRAFT)<>FALSE THEN
    DO
     HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")    
    
     HTMLVIEWLINE("<TR><TD COLSPAN=4 ALIGN=CENTER><h3>Draft transactions</h3></TD></TR>")
     
     IF ISBUSINESS=TRUE THEN 
      DO
       FORMTOUSE(DRAFT)="ES315"
       TEMPNAME="Business"
      END
     IF ISBUSINESS=FALSE THEN 
      DO
       FORMTOUSE(DRAFT)="ES315"
       TEMPNAME="Member"
      END     
     
     IF ECOUNT>0 THEN
      DO
       HTMLVIEWLINE(" <tr ><td colspan=4 align=center>")
       FOR E=55 TO 57  [DRAFT SECTION ERRORS]
        DO
         IF RETURNERROR(E)=TRUE THEN
          DO           
           ERRORTEXTOUTPUT=ERRTEXT(E)         
           HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font></br>")            
          END
        END
       HTMLVIEWLINE(" </td></tr >")
      END      
         
     HTMLVIEWLINE("<TR><TD COLSPAN=4>The following draft(s) will appear on the Check Affidavit form - please fill in Check Payee for each:")
     HTMLVIEWLINE("<h3>This form requires a notarized signature.</h3>")
     HTMLVIEWLINE("<UL>")
     FOR T=1 TO 200
      DO    
       IF TSELECT(T)=TRUE AND CHARACTERSEARCH(TXN(T,TTYPE),"Draft")>0 THEN 
        DO
         HTMLVIEWLINE("<LI>"+TXN(T,TDATE)+" "+TXN(T,TAMT)+" "+TXN(T,TDESC)+" &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")
         HTMLVIEWLINE("Payee: <input type='text'  name='dPayee"+FORMAT("99",T)+"' value ='")
         HTMLVIEWLINE(DPAYEE(T))
         HTMLVIEWLINE("' size=40 maxlength=40> </LI>")        
        END
      END
     HTMLVIEWLINE("</UL></TD></tr>")

     HTMLVIEWLINE("<TR><TD COLSPAN=4><b>Please Note:</b><ol><li> If the checks are unauthorized,")
     HTMLVIEWLINE(" pre-authorized checks, only one check may be submitted per form - in this case you may")
     HTMLVIEWLINE(" need to use the "+Q+"Go Back"+Q+" button to unselect extra checks and process each one separately.</li>")
     HTMLVIEWLINE("<li>If the check cleared the wrong account or is being questioned for any reason not listed below, ")
     HTMLVIEWLINE(" please submit a Research Request instead.</li></ol></td></TR>")    
    
     FORMTOUSE(DRAFT)="ES315"
     
     HTMLVIEWLINE("</table>")
     
     HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")
     HTMLVIEWLINE("<tr><td colspan=4> Please indicate which of the following scenarios ")
     HTMLVIEWLINE(" applies to this check/these checks:</td></tr>")
     
     HTMLVIEWLINE("<tr><td>")
     IF DRAFT1="" THEN HTMLVIEWLINE("<input type='checkbox' name='draft1' value='draft1'>")
     IF DRAFT1<>"" THEN HTMLVIEWLINE("<input type='checkbox' checked='checked' name='draft1' value='draft1'>")
     HTMLVIEWLINE("</td><td colspan=3>")
     HTMLVIEWLINE("<b> Forged Maker Signature: </b>The signature on the maker on the above described check(s) was not")
     HTMLVIEWLINE(" made by "+TEMPNAME+" nor was it placed upon said check(s) with "+TEMPNAME+"'s knowledge or consent ")
     HTMLVIEWLINE(" and "+TEMPNAME+" has not benefited in any way")    
     HTMLVIEWLINE(" by issuance or negotiation of said check(s). ")
     HTMLVIEWLINE("</td></tr><tr><td>")
     IF DRAFT2="" THEN HTMLVIEWLINE("<input type='checkbox' name='draft2' value='draft2'>")
     IF DRAFT2<>"" THEN HTMLVIEWLINE("<input type='checkbox' name='draft2' value='draft2'>")
     HTMLVIEWLINE("</td><td colspan=3>")
     HTMLVIEWLINE("<b> Forged Endorsement: </b>The signature as endorser on the above described check(s) was not")
     HTMLVIEWLINE(" made by "+TEMPNAME+" nor was it placed upon said check(s) with "+TEMPNAME+"'s knowledge or consent ")    
     HTMLVIEWLINE("and "+TEMPNAME+" has not benefited in any way by issuance or negotiation of said check(s).")
     HTMLVIEWLINE("</td></tr><tr><td>")
     IF DRAFT3="" THEN HTMLVIEWLINE("<input type='checkbox' name='draft3' value='draft3'>")
     IF DRAFT3<>"" THEN HTMLVIEWLINE("<input type='checkbox' checked='checked' name='draft3' value='draft3'>")
     HTMLVIEWLINE("</td><td colspan=3>")
     HTMLVIEWLINE("<b> Alteration: </b> The alteration indicated and described on the attached page was not")
     HTMLVIEWLINE(" made by "+TEMPNAME+" nor was it placed upon said check(s) with "+TEMPNAME+"'s knowledge or consent ")    
     HTMLVIEWLINE(" and "+TEMPNAME+" has not benefited in any way by issuance or negotiation of said check(s).  ")
     HTMLVIEWLINE(" (Have "+TEMPNAME+" submit a written explanation)")
     HTMLVIEWLINE("</td></tr><tr><td>")
     IF DRAFT4="" THEN HTMLVIEWLINE("<input type='checkbox' name='draft4' value='draft4'>")
     IF DRAFT4<>"" THEN HTMLVIEWLINE("<input type='checkbox' checked='checked' name='draft4' value='draft4'>")
     HTMLVIEWLINE("</td><td colspan=3>")
     HTMLVIEWLINE("<b> Unauthorized Preauthorized Check: </b>"+TEMPNAME+" did not authorize the issuance of the check in the amount stated")
     HTMLVIEWLINE(" on the check to the payee stated on the check.  (Complete a separate form for each unauthorized, preauthorized ")
     HTMLVIEWLINE("check.) ")
     HTMLVIEWLINE("</td></tr><tr><td>")
     IF DRAFT5="" THEN HTMLVIEWLINE("<input type='checkbox' name='draft5' value='draft5'>")
     IF DRAFT5<>"" THEN HTMLVIEWLINE("<input type='checkbox' checked='checked' name='draft5' value='draft5'>")
     HTMLVIEWLINE("</td><td colspan=3>")
     HTMLVIEWLINE("<b>Other:</b>  Fill in below.")
     HTMLVIEWLINE("</td></tr>")
     
     HTMLVIEWLINE("<tr><td > </td>")
     HTMLVIEWLINE("<td colspan=3><input type='text'  name='dr1' value ='"+DR1+"' size=70 maxlength=70> </td></tr>") 
     HTMLVIEWLINE("<tr><td></td><td colspan=3><input type='text'  name='dr2' value ='"+DR2+"' size=70 maxlength=70> </td></tr>") 

     HTMLVIEWLINE("<tr><td colspan=4><hr/></td></tr>") 
     HTMLVIEWLINE("</table>")                 
    END   [DRAFT]
    
    
   IF FORMTYPES(ACH)<>FALSE THEN
    DO
     HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")    
    
     HTMLVIEWLINE("<TR><TD COLSPAN=4 ALIGN=CENTER><h3>Unauthorized ACH transactions</h3></TD></TR>")
     
     IF ISBUSINESS=TRUE THEN 
      DO
       FORMTOUSE(ACH)="AS316"
       TEMPNAME="Business"
      END
     IF ISBUSINESS=FALSE THEN 
      DO
       FORMTOUSE(ACH)="AS316"
       TEMPNAME="Member"
      END     
     
     IF ECOUNT>0 THEN
      DO
       HTMLVIEWLINE(" <tr ><td colspan=4 align=center>")
       FOR E=58 TO 61  [ACH SECTION ERRORS]
        DO
         IF RETURNERROR(E)=TRUE THEN
          DO           
           ERRORTEXTOUTPUT=ERRTEXT(E)         
           HTMLVIEWLINE("<font color='red'>Error! "+ERRORTEXTOUTPUT+"</font></br>")            
          END
        END
       HTMLVIEWLINE(" </td></tr >")
      END      
         
     FORMTOUSE(ACH)="AS316"    
         
     HTMLVIEWLINE("<TR><TD COLSPAN=4>The following transaction(s) will appear on the Unauthorized ACH form:")
     HTMLVIEWLINE("<UL>")
     FOR T=1 TO 200
      DO    
       IF TSELECT(T)=TRUE AND CHARACTERSEARCH(TXN(T,TTYPE),"Unauthorized")>0 THEN 
        DO
         HTMLVIEWLINE("<LI>"+TXN(T,TDATE)+" "+TXN(T,TAMT)+" "+TXN(T,TDESC)+"</LI>")        
        END
      END
     HTMLVIEWLINE("</UL></TD></tr>") 
    
     HTMLVIEWLINE("<tr><td colspan=4>"+TEMPNAME+" must be able to attest that: <ol>")
     HTMLVIEWLINE("<li>"+TEMPNAME+" has reviewed the circumstances of the electronic ACH debit to their account</li>")
     HTMLVIEWLINE("<li>The debit was not authorized</li>")
     HTMLVIEWLINE("<li>The following, to the best of their ability to identify, is the reason this was not authorized</li>")
     HTMLVIEWLINE("</ol></td></tr>")
     
     HTMLVIEWLINE("<tr><td colspan=4><B>Please indicate the reason the debit is unauthorized: </B>(select only one)</td></tr>")
    
     HTMLVIEWLINE("<tr><td>")
     IF ACH1="" THEN HTMLVIEWLINE("<input type='checkbox' name='achOpt1' value='ach1'>")
     IF ACH1<>"" THEN HTMLVIEWLINE("<input type='checkbox' checked='checked' name='achOpt1' value='ach1'>")
     HTMLVIEWLINE("</td><td colspan=3>")
     HTMLVIEWLINE(""+TEMPNAME+" has never authorized this Company to initiate payments out of "+TEMPNAME+"'s account.")
     HTMLVIEWLINE("</td></tr><tr><td>")
     IF ACH2="" THEN HTMLVIEWLINE("<input type='checkbox' name='achOpt2' value='ach2'>")
     IF ACH2<>"" THEN HTMLVIEWLINE("<input type='checkbox' checked='checked' name='achOpt2' value='ach2'>")
     HTMLVIEWLINE("</td><td colspan=3>")
     HTMLVIEWLINE(TEMPNAME+" revoked the recurring payment authorization "+TEMPNAME+" had given to the Company/Originator ")
     HTMLVIEWLINE("to debit "+TEMPNAME+"'s account before the debit was initiated. (This can include preauthorized ")
     HTMLVIEWLINE("payments or deposits, international ACH transactions or recurring Internet authorized entries)")
     HTMLVIEWLINE("</td></tr><tr>")
     HTMLVIEWLINE("<td> </td><td colspan=2 width=50%>"+TEMPNAME+" wishes to stop any future debits connected with this revoked authorization: </td>")
     HTMLVIEWLINE("<td><select name='achstop'>")
     FOR X=0 TO 2
      DO
       IF X=ACHSELECT1 THEN 
        HTMLVIEWLINE("<option SELECTED value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
       ELSE     
        HTMLVIEWLINE("<option value='" + FORMAT("9",X) + "' >"+ YESNO(X)+"</option>")
       HTMLVIEWLINE("</br>")
      END
     HTMLVIEWLINE("</select>")
     HTMLVIEWLINE("</td></tr><tr><td>")
     IF ACH3="" THEN HTMLVIEWLINE("<input type='checkbox' name='achOpt3' value='ach3' class='radiocheckbox'>")
     IF ACH3<>"" THEN HTMLVIEWLINE("<input type='checkbox' checked='checked' name='achOpt3' value='ach3' >")
     HTMLVIEWLINE("</td><td colspan=3>")
     HTMLVIEWLINE(""+TEMPNAME+"'s account was debited before the date "+TEMPNAME+" authorized.")
     HTMLVIEWLINE("</td></tr><tr><td>")
     IF ACH4="" THEN HTMLVIEWLINE("<input type='checkbox' name='achOpt4' value='ach4' >")
     IF ACH4<>"" THEN HTMLVIEWLINE("<input type='checkbox' checked='checked' name='achOpt4' value='ach4' >")
     HTMLVIEWLINE("</td><td colspan=3>")
     HTMLVIEWLINE(""+TEMPNAME+"'s account was debited for an amount different from what "+TEMPNAME+" authorized.")
     HTMLVIEWLINE("</td></tr><tr><td>")
     IF ACH5="" THEN HTMLVIEWLINE("<input type='checkbox' name='achOpt5' value='ach5' >")
     IF ACH5<>"" THEN HTMLVIEWLINE("<input type='checkbox' checked='checked' name='achOpt5' value='ach5' >")
     HTMLVIEWLINE("</td><td colspan=3>")
     HTMLVIEWLINE(""+TEMPNAME+"'s check was improperly processed electronically.</br>")
     HTMLVIEWLINE("</td></tr><tr><td>")
     IF ACH6="" THEN HTMLVIEWLINE("<input type='checkbox' name='achOpt6' value='ach6'>")
     IF ACH6<>"" THEN HTMLVIEWLINE("<input type='checkbox' checked='checked' name='achOpt6' value='ach6'>")
     HTMLVIEWLINE("</td><td colspan=3>")
     HTMLVIEWLINE("Other:  Fill in below.")
     HTMLVIEWLINE("</td></tr>")
     
     HTMLVIEWLINE("<tr><td></td><td colspan=3><input type='text' name='achother1' value ='")
     HTMLVIEWLINE(ACHOTHER1)
     HTMLVIEWLINE("' size=70 maxlength=70> </td>") 
     HTMLVIEWLINE("</tr>") 
     HTMLVIEWLINE("<tr><td></td><td colspan=3><input type='text' name='achother2' value ='")
     HTMLVIEWLINE(ACHOTHER2)
     HTMLVIEWLINE("' size=70 maxlength=70> </td>") 
     HTMLVIEWLINE("</tr>")
     HTMLVIEWLINE("<tr><td></td><td colspan=3><input type='text' name='achother3' value ='")
     HTMLVIEWLINE(ACHOTHER3)
     HTMLVIEWLINE("' size=70 maxlength=70> </td>") 
     HTMLVIEWLINE("</tr>")

     HTMLVIEWLINE("<tr><td colspan=4><hr/></td></tr>") 
     HTMLVIEWLINE("</table>")
     
    END  [ACH]  
    
   HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")
   
   HTMLVIEWLINE("<tr>")
   [IF THISBRANCH=53 THEN HTMLVIEWLINE("<td colspan=4 align=center>")
   IF THISBRANCH<>53 THEN ]HTMLVIEWLINE("<td colspan=3 align=center>") 
   HTMLVIEWLINE("<h2>Clicking "+Q+"continue"+Q+" will launch the required form(s) and/or log a dispute number to the account.</h2></td>")
   HTMLVIEWLINE("</tr><tr>")
   HTMLVIEWLINE("<td align=center><input type='submit' name='quit' value='Click To Exit' class='rcubutton'></td>")
   HTMLVIEWLINE("<td align=center> <input type='submit' name='Continue' value='Click To Continue' class='rcubutton'></td>")   
   HTMLVIEWLINE("<td align=center><input type='submit' name='goback' value='Go Back' class='rcubutton'></td>")

[email button removed per ticket 25369
   IF THISBRANCH=53 THEN HTMLVIEWLINE("<td align=center><input type='submit' name='TemailForms' value='Email Blank Forms' class='rcubuttonwide'></td> ")   
]
   HTMLVIEWLINE("</br></tr>")    
    
   HTMLVIEWLINE("</table>")
  
   
   HTMLVIEWLINE("</body></html>")      
   HTMLVIEWDISPLAY


   INPUTCOUNT	= 0
   FOR I = 1 TO MAXINPUT
    DO
     INPUTFORM(I)	= ""
    END
   WHILE	INPUTFORM(INPUTCOUNT)	<> "EOD" AND INPUTCOUNT < MAXINPUT
    DO   
     INPUTCOUNT			= INPUTCOUNT + 1
     INPUTFORM(INPUTCOUNT)	= ENTERLINE(0)
    END
   CALL GETPOSTBACK3     
  END [while screenord=3]
END  [screen 3]

PROCEDURE SCREEN4
 WHILE SCREENORD=4
  DO
   [If crediting isn't already blocked, go through the transactions and check for more exclusions; 
    prepare to give credit if none are found]
    
   [Block HSA accounts from provisional credit - these need to be manually posted with special codes]
   IF ACCOUNT:TYPE=17 THEN [HSA]
    DO
     GIVECREDIT(PINBASED)=FALSE
     GIVECREDIT(SIGBASED)=FALSE
     NOCREDITREASON(PINBASED)="No automatic credits on HSA accounts"
     DBNOCREDITREASON(PINBASED)="No auto credit: HSA account"
     NOCREDITREASON(SIGBASED)="No automatic credits on HSA accounts"
     DBNOCREDITREASON(SIGBASED)="No auto credit: HSA account"
    END
    
    
   [PIN TRANS] 
   IF NEWPINCLAIM<>"" AND 
      GIVECREDIT(PINBASED)<>FALSE THEN  
    DO
     IF SHARELIST(SELECTEDSID,SINDICATOR)="V" OR
        RCUCARDNUM<>"" THEN  [NO CREDITS ON VISA]
      DO
       GIVECREDIT(PINBASED)=FALSE
       NOCREDITREASON(PINBASED)="No automatic credits on Visa cards"
       DBNOCREDITREASON(PINBASED)="No automatic credits on Visa cards"
      END
     IF GIVECREDIT(PINBASED)<>FALSE THEN
      DO      
       OLDESTDATE=SYSTEMDATE
       IF PBSELECT6=1 THEN CREDITTYPE(PINBASED)=FRAUD
       IF PBSELECT6=2 THEN CREDITTYPE(PINBASED)=DISPUTE
       FOR T=1 TO 200
        DO
         IF TSELECT(T)=TRUE AND CHARACTERSEARCH(TXN(T,TTYPE),"PIN")>0 THEN 
          DO         
           IF DATEVALUE(TXN(T,TDATE))<OLDESTDATE THEN OLDESTDATE=DATEVALUE(TXN(T,TDATE))
           CLAIMTOT(PINBASED)=CLAIMTOT(PINBASED)+MONEY(VALUE(TXN(T,TAMT)))  [FOR PINBASED, DISPUTED AMT IS SAME AS TXN AMT]
          END
         IF TSELECT(T)=TRUE AND
            CHARACTERSEARCH(TXN(T,TTYPE),"RCU ATM")>0 AND
            CREDITTYPE(PINBASED)=DISPUTE THEN [WE ONLY CARE ABOUT THIS IF IT'S A DISPUTE; DOESN'T MATTER FOR FRAUD]
          DO 
           GIVECREDIT(PINBASED)=FALSE
           NOCREDITREASON(PINBASED)="No automatic credit on RCU ATM disputes"
           DBNOCREDITREASON(PINBASED)="No automatic credit on RCU ATM disputes"
          END          
        END
       IF OLDESTDATE<(SYSTEMDATE-60) AND ISBUSINESS=FALSE THEN 
        DO
         GIVECREDIT(PINBASED)=FALSE
         NOCREDITREASON(PINBASED)="No automatic credits for disputed transactions 60+ days old on Consumer accounts"
         DBNOCREDITREASON(PINBASED)="No auto credit: trans 60+ days old"
        END
       IF OLDESTDATE<(SYSTEMDATE-30) AND ISBUSINESS=TRUE THEN 
        DO
         GIVECREDIT(PINBASED)=FALSE
         NOCREDITREASON(PINBASED)="No automatic credits for disputed transactions 30+ days old on Business accounts"
         DBNOCREDITREASON(PINBASED)="No auto credit: trans 30+ days old"
        END        
       IF CREDITTYPE(PINBASED)=FRAUD AND CLAIMTOT(PINBASED)>FRAUDLIMIT THEN
        DO
         GIVECREDIT(PINBASED)=FALSE
         NOCREDITREASON(PINBASED)="No automatic credits on fraud claims over "+FORMAT("$#,##9.99",FRAUDLIMIT)
         DBNOCREDITREASON(PINBASED)="No auto credit: fraud over "+FORMAT("$#,##9.99",FRAUDLIMIT)
        END
       IF CREDITTYPE(PINBASED)=DISPUTE AND CLAIMTOT(PINBASED)>DISPUTELIMIT THEN
        DO
         GIVECREDIT(PINBASED)=FALSE
         NOCREDITREASON(PINBASED)="No automatic credits on dispute claims over "+FORMAT("$#9.99",DISPUTELIMIT)
         DBNOCREDITREASON(PINBASED)="No auto credit: dispute over"+FORMAT("$#9.99",DISPUTELIMIT)
        END
      END
    END  [pin claims]
    
   [SIG FRAUD]         
   IF NEWSIGFRAUDCLAIM<>"" AND  
      GIVECREDIT(SIGBASED)<> FALSE THEN
    DO
     IF SHARELIST(SELECTEDSID,SINDICATOR)="V" OR
        RCUCARDNUM<>""  THEN  [NO CREDITS ON VISA]
      DO
       GIVECREDIT(SIGBASED)=FALSE
       NOCREDITREASON(SIGBASED)="No automatic credits on Visa cards"
       DBNOCREDITREASON(SIGBASED)="No automatic credits on Visa cards"
      END   
     IF GIVECREDIT(SIGBASED)<>FALSE THEN
      DO
       OLDESTDATE=SYSTEMDATE  
       FOR T=1 TO 200
        DO    
         IF TSELECT(T)=TRUE AND CHARACTERSEARCH(TXN(T,TTYPE),"Signature")>0 THEN 
          DO                         
           IF DATEVALUE(TXN(T,TDATE))<OLDESTDATE THEN
             OLDESTDATE=DATEVALUE(TXN(T,TDATE))         
           CLAIMTOT(SIGBASED)=CLAIMTOT(SIGBASED)+MONEY(VALUE(TXN(T,TAMT)))
          END
        END
       IF OLDESTDATE<(SYSTEMDATE-60) AND ISBUSINESS=FALSE THEN 
        DO
         GIVECREDIT(SIGBASED)=FALSE
         NOCREDITREASON(SIGBASED)="No automatic credits for disputed transactions 60+ days old on Consumer accounts"
         DBNOCREDITREASON(SIGBASED)="No auto credit: trans 60+ days old"
        END
       IF OLDESTDATE<(SYSTEMDATE-30) AND ISBUSINESS=TRUE THEN 
        DO
         GIVECREDIT(SIGBASED)=FALSE
         NOCREDITREASON(SIGBASED)="No automatic credits for disputed transactions 30+ days old on Business accounts"
         DBNOCREDITREASON(SIGBASED)="No auto credit: trans 30+ days old"
        END        
       IF CLAIMTOT(SIGBASED)>FRAUDLIMIT THEN
        DO
         GIVECREDIT(SIGBASED)=FALSE
         NOCREDITREASON(SIGBASED)="No automatic credits on fraud claims over "+FORMAT("$#,##9.99",FRAUDLIMIT)
         DBNOCREDITREASON(SIGBASED)="No auto credit: fraud over "+FORMAT("$#,##9.99",FRAUDLIMIT)
        END
       CREDITTYPE(SIGBASED)=FRAUD 
      END     
    END [SIG FRAUD]
   
   IF NEWSIGDISPUTECLAIM<>"" AND  [SIG DISPUTE]
      GIVECREDIT(SIGBASED)<> FALSE THEN
    DO
   
     IF SHARELIST(SELECTEDSID,SINDICATOR)="V" OR
        RCUCARDNUM<>""  THEN  [NO CREDITS ON VISA]
      DO
       GIVECREDIT(SIGBASED)=FALSE
       NOCREDITREASON(SIGBASED)="No automatic credits on Visa cards"
       DBNOCREDITREASON(SIGBASED)="No automatic credits on Visa cards"
      END    
     IF GIVECREDIT(SIGBASED)<>FALSE THEN
      DO  
       OLDESTDATE=SYSTEMDATE
       FOR T=1 TO 200
        DO    
         IF TSELECT(T)=TRUE AND CHARACTERSEARCH(TXN(T,TTYPE),"Signature")>0 THEN 
          DO            
           IF DATEVALUE(TXN(T,TDATE))<OLDESTDATE THEN OLDESTDATE=DATEVALUE(TXN(T,TDATE))
           IF TXN(T,TDAMT)<>"" THEN                                   
            CLAIMTOT(SIGBASED)=CLAIMTOT(SIGBASED)+MONEY(VALUE(TXN(T,TDAMT)))  [ADD UP DISPUTED AMOUNT, NOT TXN AMT]
           ELSE
            CLAIMTOT(SIGBASED)=CLAIMTOT(SIGBASED)+MONEY(VALUE(TXN(T,TAMT)))  [ADD UP TXN AMT IF A SPECIFIC AMT IS NOT DISPUTED]            
          END
        END
       IF OLDESTDATE<(SYSTEMDATE-60) AND ISBUSINESS=FALSE THEN 
        DO
         GIVECREDIT(SIGBASED)=FALSE
         NOCREDITREASON(SIGBASED)="No automatic credits for disputed transactions 60+ days old on Consumer accounts"
         DBNOCREDITREASON(SIGBASED)="No auto credit: trans 60+ days old"
        END  
       IF OLDESTDATE<(SYSTEMDATE-30) AND ISBUSINESS=TRUE THEN 
        DO
         GIVECREDIT(SIGBASED)=FALSE
         NOCREDITREASON(SIGBASED)="No automatic credits for disputed transactions 30+ days old on Business accounts"
         DBNOCREDITREASON(SIGBASED)="No auto credit: trans 30+ days old"
        END              
       IF CLAIMTOT(SIGBASED)>DISPUTELIMIT THEN
        DO
         GIVECREDIT(SIGBASED)=FALSE
         NOCREDITREASON(SIGBASED)="No automatic credits on dispute claims over "+FORMAT("$#9.99",DISPUTELIMIT)
         DBNOCREDITREASON(SIGBASED)="No auto credit: dispute over"+FORMAT("$#9.99",DISPUTELIMIT)
        END
       CREDITTYPE(SIGBASED)=DISPUTE
      END             
    END [SIG DISPUTE]
    
   [No auto credits on employee accounts - check this last so it won't overwrite other more pertinent 'reasons']
   IF ISEMPLOYEE=TRUE THEN
    DO   
     IF GIVECREDIT(PINBASED)<>FALSE THEN [isn't already flagged for another reason]
      DO
       GIVECREDIT(PINBASED)=FALSE
       NOCREDITREASON(PINBASED)="No automatic credits on Employee Accounts"
       DBNOCREDITREASON(PINBASED)="No automatic credits on Employee Accounts"
      END
     IF GIVECREDIT(SIGBASED)<>FALSE THEN [isn't already flagged for another reason]
      DO
       GIVECREDIT(SIGBASED)=FALSE
       NOCREDITREASON(SIGBASED)="No automatic credits on Employee Accounts"
       DBNOCREDITREASON(SIGBASED)="No automatic credits on Employee Accounts"
      END       
    END    
    
   FOR X=PINBASED TO SIGBASED
    DO
     IF GIVECREDIT(X)<>FALSE AND NOCREDITREASON(X)="" AND CLAIMTOT(X)>$0.00 THEN GIVECREDIT(X)=TRUE
    END
    
   THISACCOUNT=ACCOUNT:NUMBER
  
  [Posting for pinbased]
  COULDNOTPOST(PINBASED)=""  [IF CAN'T POST, REASON WILL GO HERE]
  IF GIVECREDIT(PINBASED)=TRUE THEN
   DO
    FOR EACH SHARE WITH SHARE:ID=SHARELIST(SELECTEDSID,SID)
     DO
      IF SHARE:CLOSEDATE<>'--/--/--' THEN 
       DO
        COULDNOTPOST(PINBASED)="Share is closed"
        GIVECREDIT(PINBASED)=FALSE
        [load trancomment so email will have claim #]
        TRANCOMMENT=NEWPINCLAIM
       END
     END
    IF COULDNOTPOST(PINBASED)="" THEN
     DO
      IF (CREDITTYPE(PINBASED)=DISPUTE OR
          CREDITTYPE(PINBASED)=FRAUD) AND 
         CLAIMTOT(PINBASED)<=DISPUTELIMIT THEN
       DO
        TRANCOMMENT=NEWPINCLAIM
[DEBUG
IF SYSSYMDIRECTORY<>0 THEN
 DO
  POPUPMESSAGE(1,"Posting to "+SEGMENT(CLAIMGL,1,6))
  popupmessage(1,"GL comment: "+TRANCAM1+" "+TRANCOMMENT) 
 END
/DEBUG]        
        TRANPERFORM D (0,SQ1,SQ2,CK1,CK2,TRANERR)  
         DO
          SET AMOUNT TO CLAIMTOT(PINBASED)
          SET TOACCT TO THISACCOUNT  [ACCOUNT:NUMBER]
          SET TOID TO SHARELIST(SELECTEDSID,SID)
          SET TOTYPE TO "S"
          SET GLCODE TO SWEEPGLCODE  [ LOSSGLCODE]    [CLAIMGLCODE]
          SET EFFECTIVEDATE TO SYSTEMDATE
          SET COMMENT:1 TO "ADJ PENDING INVESTIGATION CLAIM#"
          SET COMMENT:2 TO TRANCOMMENT
         END   
        IF TRANERR="" THEN  [IF POSTED OK, NOW POST GL-TO-GL OFFSET]
         DO
          TRANPERFORM GL (0,SQ1,SQ2,CK1,CK2,TRANERR) 
           DO 
            SET FMACCT TO CLAIMGL
            SET TOACCT TO SWEEPGL
            SET AMOUNT TO CLAIMTOT(PINBASED)
            SET COMMENT:1 TO TRANCAM1+" "+TRANCOMMENT  [CAM1 ]
           END
          IF TRANERR<>"" THEN POPUPMESSAGE(1,"GL offset failed: "+TRANERR) 
         END           
        IF TRANERR="" THEN 
         DO      
          POPUPMESSAGE(1,"Provisional credit posted to member share")
          TEMPVAL=FORMAT("#,###,##9.99",CLAIMTOT(PINBASED))
          CALL NICEMONEYDEP
          IIAMOUNT=NICEMONEY
          CALL INFOIMAGERESOLUTION
          CREDITAMT(PINBASED)=CLAIMTOT(PINBASED)
          IF CREDITTYPE(PINBASED)=FRAUD THEN CALLCREATECARD=TRUE          
         END
        IF TRANERR<>"" THEN [SHARE DEPOSIT FAILED]
         DO
          COULDNOTPOST(PINBASED)="Transaction posting failed. Error: "+TRANERR
         END
       END
      IF CREDITTYPE(PINBASED)=FRAUD AND CLAIMTOT(PINBASED)>DISPUTELIMIT THEN
       DO
        TRANCOMMENT=NEWPINCLAIM
[DEBUG
IF SYSSYMDIRECTORY<>0 THEN
 DO
  POPUPMESSAGE(1,"Posting to "+SEGMENT(LOSSGL,1,6))
  popupmessage(1,"GL comment: "+TRANCAM1+" "+TRANCOMMENT)
 END
/DEBUG]         
        TRANPERFORM D (0,SQ1,SQ2,CK1,CK2,TRANERR)  
         DO
          SET AMOUNT TO CLAIMTOT(PINBASED)
          SET TOACCT TO THISACCOUNT  [ACCOUNT:NUMBER]
          SET TOID TO SHARELIST(SELECTEDSID,SID)
          SET TOTYPE TO "S"
          SET GLCODE TO SWEEPGLCODE  [ LOSSGLCODE]    [CLAIMGLCODE]
          SET EFFECTIVEDATE TO SYSTEMDATE
          SET COMMENT:1 TO "ADJ PENDING INVESTIGATION CLAIM#"
          SET COMMENT:2 TO TRANCOMMENT
         END   
        IF TRANERR="" THEN  [IF POSTED OK, NOW POST GL-TO-GL OFFSET]
         DO
          TRANPERFORM GL (0,SQ1,SQ2,CK1,CK2,TRANERR) 
           DO 
            SET FMACCT TO LOSSGL
            SET TOACCT TO SWEEPGL
            SET AMOUNT TO CLAIMTOT(PINBASED)
            SET COMMENT:1 TO TRANCAM1+" "+TRANCOMMENT  [CAM1 ]
           END
          IF TRANERR<>"" THEN POPUPMESSAGE(1,"GL offset failed: "+TRANERR) 
         END         
        [TRANPERFORM D (0,SQ1,SQ2,CK1,CK2,TRANERR)  
         DO
          SET AMOUNT TO CLAIMTOT(PINBASED)
          SET TOACCT TO THISACCOUNT  [ACCOUNT:NUMBER]
          SET TOID TO SHARELIST(SELECTEDSID,SID)
          SET TOTYPE TO "S"
          SET GLCODE TO CLAIMGLCODE
          SET EFFECTIVEDATE TO SYSTEMDATE
          SET COMMENT:1 TO "ADJ PENDING INVESTIGATION CLAIM#"
          SET COMMENT:2 TO TRANCOMMENT
         END ]  
        IF TRANERR="" THEN 
         DO
          POPUPMESSAGE(1,"Provisional credit posted to member share")
          TEMPVAL=FORMAT("#,###,##9.99",CLAIMTOT(PINBASED))
          CALL NICEMONEYDEP
          IIAMOUNT=NICEMONEY
          CALL INFOIMAGEPROVISIONAL
          CREDITAMT(PINBASED)=CLAIMTOT(PINBASED)
          CALLCREATECARD=TRUE  [REMIND TO RUN CREATE CARD]
         END
        IF TRANERR<>"" THEN [SHARE DEPOSIT FAILED]
         DO
          COULDNOTPOST(PINBASED)="Transaction posting failed. Error: "+TRANERR
         END                    
       END
     END
   END
                    
 [Posting for sigbased]
  COULDNOTPOST(SIGBASED)=""  [IF CAN'T POST, REASON WILL GO HERE]
  IF GIVECREDIT(SIGBASED)=TRUE THEN
   DO
    FOR EACH SHARE WITH SHARE:ID=SHARELIST(SELECTEDSID,SID)
     DO
      IF SHARE:CLOSEDATE<>'--/--/--' THEN 
       DO
        COULDNOTPOST(SIGBASED)="Share is closed"
        GIVECREDIT(SIGBASED)=FALSE
        [still load trancomment so claim # can be in email]
        IF CREDITTYPE(SIGBASED)=FRAUD THEN TRANCOMMENT=NEWSIGFRAUDCLAIM
        IF CREDITTYPE(SIGBASED)=DISPUTE THEN TRANCOMMENT=NEWSIGDISPUTECLAIM
       END
     END
    IF COULDNOTPOST(SIGBASED)="" THEN
     DO  
      IF (CREDITTYPE(SIGBASED)=DISPUTE OR
          CREDITTYPE(SIGBASED)=FRAUD) AND 
          CLAIMTOT(SIGBASED)<=DISPUTELIMIT THEN
       DO
        IF CREDITTYPE(SIGBASED)=FRAUD THEN TRANCOMMENT=NEWSIGFRAUDCLAIM
        IF CREDITTYPE(SIGBASED)=DISPUTE THEN TRANCOMMENT=NEWSIGDISPUTECLAIM
[DEBUG
IF SYSSYMDIRECTORY<>0 THEN
 DO
  POPUPMESSAGE(1,"Posting to "+SEGMENT(CLAIMGL,1,6))
  popupmessage(1,"GL comment: "+TRANCAM1+" "+TRANCOMMENT)
 END
/DEBUG]          
        TRANPERFORM D (0,SQ1,SQ2,CK1,CK2,TRANERR)  
         DO
          SET AMOUNT TO CLAIMTOT(SIGBASED)
          SET TOACCT TO THISACCOUNT  [ACCOUNT:NUMBER]
          SET TOID TO SHARELIST(SELECTEDSID,SID)
          SET TOTYPE TO "S"
          SET GLCODE TO SWEEPGLCODE  [LOSSGLCODE]  [CLAIMGLCODE]
          SET EFFECTIVEDATE TO SYSTEMDATE
          SET COMMENT:1 TO "ADJ PENDING INVESTIGATION CLAIM#"
          SET COMMENT:2 TO TRANCOMMENT
         END  
        IF TRANERR="" THEN  [IF POSTED OK, NOW POST GL-TO-GL OFFSET]
         DO
          TRANPERFORM GL (0,SQ1,SQ2,CK1,CK2,TRANERR) 
           DO 
            SET FMACCT TO CLAIMGL
            SET TOACCT TO SWEEPGL
            SET AMOUNT TO CLAIMTOT(SIGBASED)
            SET COMMENT:1 TO TRANCAM1+" "+TRANCOMMENT  [CAM1 ]
           END
          IF TRANERR<>"" THEN POPUPMESSAGE(1,"GL offset failed: "+TRANERR) 
         END              
        IF TRANERR="" THEN 
         DO              
          POPUPMESSAGE(1,"Provisional credit posted to member share")
          TEMPVAL=FORMAT("#,###,##9.99",CLAIMTOT(SIGBASED))
          CALL NICEMONEYDEP
          IIAMOUNT=NICEMONEY
          CALL INFOIMAGERESOLUTION
          CREDITAMT(SIGBASED)=CLAIMTOT(SIGBASED)
          [REMIND TO LAUNCH CREATE CARD RG FOR FRAUD, TO CAPTURE CARD]
          IF CREDITTYPE(SIGBASED)=FRAUD THEN CALLCREATECARD=TRUE
         END
        IF TRANERR<>"" THEN [SHARE DEPOSIT FAILED]
         DO
          COULDNOTPOST(SIGBASED)="Transaction posting failed. Error: "+TRANERR
          POPUPMESSAGE(1,COULDNOTPOST(SIGBASED))
         END
       END
      IF CREDITTYPE(SIGBASED)=FRAUD AND CLAIMTOT(SIGBASED)>DISPUTELIMIT THEN
       DO
        TRANCOMMENT=NEWSIGFRAUDCLAIM 
[DEBUG
IF SYSSYMDIRECTORY<>0 THEN
 DO
  POPUPMESSAGE(1,"Posting to "+SEGMENT(LOSSGL,1,6))
  popupmessage(1,"GL comment: "+TRANCAM1+" "+TRANCOMMENT)
 END
/DEBUG]             
        TRANPERFORM D (0,SQ1,SQ2,CK1,CK2,TRANERR)  
         DO
          SET AMOUNT TO CLAIMTOT(SIGBASED)
          SET TOACCT TO THISACCOUNT  [ACCOUNT:NUMBER]
          SET TOID TO SHARELIST(SELECTEDSID,SID)
          SET TOTYPE TO "S"
          SET GLCODE TO SWEEPGLCODE  [LOSSGLCODE]  [CLAIMGLCODE]
          SET EFFECTIVEDATE TO SYSTEMDATE
          SET COMMENT:1 TO "ADJ PENDING INVESTIGATION CLAIM#"
          SET COMMENT:2 TO TRANCOMMENT
         END  
        IF TRANERR="" THEN  [IF POSTED OK, NOW POST GL-TO-GL OFFSET]
         DO
          TRANPERFORM GL (0,SQ1,SQ2,CK1,CK2,TRANERR) 
           DO 
            SET FMACCT TO LOSSGL
            SET TOACCT TO SWEEPGL
            SET AMOUNT TO CLAIMTOT(SIGBASED)
            SET COMMENT:1 TO TRANCAM1+" "+TRANCOMMENT  [CAM1 ]
           END
          IF TRANERR<>"" THEN POPUPMESSAGE(1,"GL offset failed: "+TRANERR) 
         END            
        IF TRANERR="" THEN 
         DO
          POPUPMESSAGE(1,"Provisional credit posted to member share")
          TEMPVAL=FORMAT("#,###,##9.99",CLAIMTOT(SIGBASED))
          CALL NICEMONEYDEP
          IIAMOUNT=NICEMONEY
          CALL INFOIMAGEPROVISIONAL
          CREDITAMT(SIGBASED)=CLAIMTOT(SIGBASED)
          CALLCREATECARD=TRUE [REMIND TO RUN CREATE CARD]
         END
        IF TRANERR<>"" THEN [SHARE DEPOSIT FAILED]
         DO
          COULDNOTPOST(SIGBASED)="Transaction posting failed. Error: "+TRANERR
          POPUPMESSAGE(1,COULDNOTPOST(SIGBASED))  
         END                    
       END
     END
   END          

[DEBUG       
POPUPMESSAGE(1,"TRANCOMMENT="+TRANCOMMENT)
POPUPMESSAGE(1,"COULDNOTPOST(SIGBASED)="+COULDNOTPOST(SIGBASED))
POPUPMESSAGE(1,"NOCREDITREASON(SIGBASED)="+NOCREDITREASON(SIGBASED))
POPUPMESSAGE(1,"FORMTOUSE(SIGBASED)="+FORMTOUSE(SIGBASED))
POPUPMESSAGE(1,"NEWSIGFRAUDCLAIM="+NEWSIGFRAUDCLAIM)
POPUPMESSAGE(1,"NEWSIGDISPUTECLAIM="+NEWSIGDISPUTECLAIM)
POPUPMESSAGE(1,"CREDITTYPE(SIGBASED)="+format("99",CREDITTYPE(SIGBASED)))
/debug]


  
   FOR X=PINBASED TO SIGBASED
    DO
     IF (COULDNOTPOST(X)<>"" OR
         NOCREDITREASON(X)<>"") AND
        FORMTOUSE(X)<>"" THEN  [MAKE SURE ACTUALLY A CLAIM FOR THIS TYPE; TO PREVENT 2ND EMAIL W/NO CLAIM INFO]
      DO
       IF TRANCOMMENT="" THEN  [IF CLAIM # NOT ALREADY STORED IN THIS VARIABLE, FIGURE IT OUT & STORE IT FOR EMAIL]
        DO
         IF X=PINBASED AND NOCREDITREASON(PINBASED)<>"" THEN TRANCOMMENT=NEWPINCLAIM
         IF X=SIGBASED AND NOCREDITREASON(SIGBASED)<>"" THEN 
          DO
           IF NEWSIGFRAUDCLAIM<>"" THEN TRANCOMMENT=NEWSIGFRAUDCLAIM
           IF NEWSIGDISPUTECLAIM<>"" THEN TRANCOMMENT=NEWSIGDISPUTECLAIM
          END
        END
      
       MESSAGE=""
       IF COULDNOTPOST(X)<>"" THEN
        MESSAGE="The repgen attempted to post credit but could not. Error returned was: "+COULDNOTPOST(X)
       IF NOCREDITREASON(X)<>"" THEN
        MESSAGE="This claim did not qualify for instant credit because: "+NOCREDITREASON(X)
       IF MESSAGE<>"" THEN POPUPMESSAGE(1,MESSAGE) 
         
       IF (COULDNOTPOST(X)<>"" OR
           NOCREDITREASON(X)="No automatic credits on Employee Accounts" OR    [only send email for certain 'no credit' reasons]
           NOCREDITREASON(X)="No automatic credits for disputed transactions 60+ days old on Consumer accounts" OR 
           NOCREDITREASON(X)="No automatic credits for disputed transactions 30+ days old on Business accounts" OR 
           NOCREDITREASON(X)="3 or more claims in last 30 days") AND   
           FORMTOUSE(X)<>"" THEN  [MAKE SURE ACTUALLY A CLAIM FOR THIS TYPE; TO PREVENT 2ND EMAIL W/NO CLAIM INFO]
        DO   
         IF COULDNOTPOST(X)<>"" THEN EMAILSUBJ="Auto Credit Failed"
         IF NOCREDITREASON(X)<>"" THEN EMAILSUBJ="Not eligible for credit"
         EMAILSTART("noreply@Redwoodcu.org",CREDITEMAIL,EMAILSUBJ, EMAILERR)  
         EMAILLINE("A claim # "+TRANCOMMENT+" on account "+LU20+" did not receive credit.",EMAILERR)
         EMAILLINE("",EMAILERR)
         IF COULDNOTPOST(X)<>"" THEN
          DO
           EMAILLINE("The repgen attempted to post credit but could not. Error returned was: ",EMAILERR)
           EMAILLINE(COULDNOTPOST(X),EMAILERR)
          END
         IF NOCREDITREASON(X)<>"" THEN
          DO
           EMAILLINE("This claim did not qualify for instant credit because: ",EMAILERR)
           EMAILLINE(NOCREDITREASON(X),EMAILERR)
          END
         EMAILLINE("",EMAILERR)     
         EMAILSEND(EMAILERR)
         IF EMAILERR<>"" THEN POPUPMESSAGE(1,"Email to "+CREDITEMAIL+" failed: "+EMAILERR)                
        END
      END
    END   
   
   [WRITE NOTES & COMMENTS TO ACCT]
   IF NEWPINCLAIM<>"" AND INDEXACCT<>"0000316052" THEN  [NOT ON CORP CARD 'DUMMY' ACCT]
    DO
     NEWCLAIMNUM=NEWPINCLAIM
     IF SHARELIST(SELECTEDSID,SINDICATOR)="V" THEN
      CALL CREATEVISACLAIMNOTE
     ELSE
      CALL CREATECLAIMNOTE
     CALL CREATECOMMENT
    END
   IF FMERR<>"" THEN 
    DO
     DIALOGSTART("FM error!",100%,0)
     DIALOGINTROTEXT("There was an error creating the PIN claim note(s):" +FMERR) 
     DIALOGDISPLAY
     DIALOGCLOSE
    END
        
   IF NEWSIGFRAUDCLAIM<>"" AND INDEXACCT<>"0000316052" THEN  [NOT ON CORP CARD 'DUMMY' ACCT]
    DO
     NEWCLAIMNUM=NEWSIGFRAUDCLAIM
     IF SHARELIST(SELECTEDSID,SINDICATOR)="V" THEN
      CALL CREATEVISACLAIMNOTE
     ELSE
      CALL CREATECLAIMNOTE
     CALL CREATECOMMENT
    END 
   IF FMERR<>"" THEN 
    DO
     DIALOGSTART("FM error!",100%,0)
     DIALOGINTROTEXT("There was an error creating the Signature claim note(s):" +FMERR) 
     DIALOGDISPLAY
     DIALOGCLOSE
    END    
       
   IF NEWSIGDISPUTECLAIM<>"" AND INDEXACCT<>"0000316052" THEN  [NOT ON CORP CARD 'DUMMY' ACCT] 
    DO
     NEWCLAIMNUM=NEWSIGDISPUTECLAIM
     IF SHARELIST(SELECTEDSID,SINDICATOR)="V" THEN
      CALL CREATEVISACLAIMNOTE
     ELSE
      CALL CREATECLAIMNOTE 
     CALL CREATECOMMENT   
    END    
   IF FMERR<>"" THEN 
    DO
     DIALOGSTART("FM error!",100%,0)
     DIALOGINTROTEXT("There was an error creating the Signature claim note(s):" +FMERR) 
     DIALOGDISPLAY
     DIALOGCLOSE
    END    
[   
   DIALOGSTART("Sending Data",100%,0)
   DIALOGINTROTEXT("Your screen may flash several times before forms display.")
   DIALOGINTROTEXT("This is normal!")
   DIALOGINTROTEXT("Please be patient as your claim data is submitted.")
   DIALOGDISPLAY
   DIALOGCLOSE  ]  
   
   [LAUNCH FORM(S) OUTSIDE OF THE HTMLVIEW CODE]
   CALL RESETSYMFORMS  [reset this before each form]
   HEADERFLAG=""
   IF FORMTOUSE(PINBASED)="AS1307" AND FORMTYPES(PINBASED)<>FALSE THEN 
    DO
     HEADERFLAG="PIN"
     IF NEWPINCLAIM<>"" THEN CALL SENDDBHEADER  [ONLY SEND CLAIM 'HEADER' RECORD IF NEW CLAIM]
     TRANCTR=0
     FOR T=1 TO 200
      DO    
       IF TSELECT(T)=TRUE AND CHARACTERSEARCH(TXN(T,TTYPE),"PIN")>0 THEN 
        DO
         [remove apostrophes & quotes from tran desc]  
         RAWCHAR=""       
         RAWCHAR=TXN(T,TDESC)
         CALL REMOVEFORBIDDENCHARS
         TXN(T,TDESC)=FIXEDCHAR
         
         TRANCTR=TRANCTR+1
         CALL SENDPINTRANS
        END
      END
      
     IF PBSELECT6=2 THEN CALL CHECKFORRCUATM   [LOOKS FOR RCU ATM TRANSACTIONS IF DISPUTE; SENDS EMAIL IF FOUND] 

     CALL LAUNCHAS1307   [CONSUMER PIN-BASED FRAUD/DISPUTE]             
    END
   IF FORMTOUSE(PINBASED)="AS1312" AND FORMTYPES(PINBASED)<>FALSE THEN 
    DO
     HEADERFLAG="PIN"
     IF NEWPINCLAIM<>"" THEN CALL SENDDBHEADER  [ONLY SEND CLAIM 'HEADER' RECORD IF NEW CLAIM]
     TRANCTR=0
     FOR T=1 TO 200
      DO    
       IF TSELECT(T)=TRUE AND CHARACTERSEARCH(TXN(T,TTYPE),"PIN")>0 THEN 
        DO
         [remove apostrophes & quotes from tran desc]  
         RAWCHAR=""       
         RAWCHAR=TXN(T,TDESC)
         CALL REMOVEFORBIDDENCHARS
         TXN(T,TDESC)=FIXEDCHAR
                 
         TRANCTR=TRANCTR+1
         CALL SENDPINTRANS
        END
      END
     IF PBSELECT6=2 THEN CALL CHECKFORRCUATM   [LOOKS FOR RCU ATM TRANSACTIONS IF DISPUTE; SENDS EMAIL IF FOUND] 
     CALL LAUNCHAS1312   [BUSINESS PIN-BASED FRAUD/DISPUTE]
    END   
    
   CALL RESETSYMFORMS 
   HEADERFLAG=""
   IF FORMTOUSE(SIGBASED)="AS1306" AND FORMTYPES(SIGBASED)<>FALSE THEN 
    DO
     HEADERFLAG="SIGDISPUTE"
     IF NEWSIGDISPUTECLAIM<>"" THEN CALL SENDDBHEADER  [ONLY SEND CLAIM 'HEADER' RECORD IF NEW CLAIM]
     TRANCTR=0
     FOR T=1 TO 200
      DO    
       IF TSELECT(T)=TRUE AND CHARACTERSEARCH(TXN(T,TTYPE),"Signature")>0 THEN 
        DO
         [remove apostrophes & quotes from tran desc]  
         RAWCHAR=""       
         RAWCHAR=TXN(T,TDESC)
         CALL REMOVEFORBIDDENCHARS
         TXN(T,TDESC)=FIXEDCHAR
                 
         TRANCTR=TRANCTR+1
         CALL SENDCREDDISPTRANS
        END
      END
     CALL LAUNCHAS1306    [CONSUMER SIG-BASED DISPUTE]
    END     
   IF FORMTOUSE(SIGBASED)="AS1310" AND FORMTYPES(SIGBASED)<>FALSE THEN 
    DO
     HEADERFLAG="SIGDISPUTE"
     IF NEWSIGDISPUTECLAIM<>"" THEN CALL SENDDBHEADER  [ONLY SEND CLAIM 'HEADER' RECORD IF NEW CLAIM]
     TRANCTR=0
     FOR T=1 TO 200
      DO    
       IF TSELECT(T)=TRUE AND CHARACTERSEARCH(TXN(T,TTYPE),"Signature")>0 THEN 
        DO
        [remove apostrophes & quotes from tran desc]  
         RAWCHAR=""       
         RAWCHAR=TXN(T,TDESC)
         CALL REMOVEFORBIDDENCHARS
         TXN(T,TDESC)=FIXEDCHAR
                 
         TRANCTR=TRANCTR+1
         CALL SENDCREDDISPTRANS
        END
      END
     CALL LAUNCHAS1310    [BUSINESS SIG-BASED DISPUTE]
    END
   
   CALL RESETSYMFORMS
   HEADERFLAG="" 
   IF FORMTOUSE(SIGBASED)="LP1308" AND FORMTYPES(SIGBASED)<>FALSE THEN 
    DO
     HEADERFLAG="SIGFRAUD"
     IF NEWSIGFRAUDCLAIM<>"" THEN CALL SENDDBHEADER  [ONLY SEND CLAIM 'HEADER' RECORD IF NEW CLAIM]
     TRANCTR=0
     FOR T=1 TO 200
      DO    
       IF TSELECT(T)=TRUE AND CHARACTERSEARCH(TXN(T,TTYPE),"Signature")>0 THEN 
        DO 
         [remove apostrophes & quotes from tran desc]  
         RAWCHAR=""       
         RAWCHAR=TXN(T,TDESC)
         CALL REMOVEFORBIDDENCHARS
         TXN(T,TDESC)=FIXEDCHAR
                          
         TRANCTR=TRANCTR+1
         CALL SENDCREDFRAUDTRANS
        END
      END  
     CALL LAUNCHLP1308    [CONSUMER SIG-BASED FRAUD]
    END     
   IF FORMTOUSE(SIGBASED)="LP1311" AND FORMTYPES(SIGBASED)<>FALSE THEN
    DO
     HEADERFLAG="SIGFRAUD"
     IF NEWSIGFRAUDCLAIM<>"" THEN CALL SENDDBHEADER  [ONLY SEND CLAIM 'HEADER' RECORD IF NEW CLAIM]
     TRANCTR=0
     FOR T=1 TO 200
      DO    
       IF TSELECT(T)=TRUE AND CHARACTERSEARCH(TXN(T,TTYPE),"Signature")>0 THEN 
        DO
         [remove apostrophes & quotes from tran desc]  
         RAWCHAR=""       
         RAWCHAR=TXN(T,TDESC)
         CALL REMOVEFORBIDDENCHARS
         TXN(T,TDESC)=FIXEDCHAR
                 
         TRANCTR=TRANCTR+1
         CALL SENDCREDFRAUDTRANS
        END
      END
     CALL LAUNCHLP1311    [BUSINESS SIG-BASED FRAUD]
    END    
    
   IF FORMTOUSE(DRAFT)="ES315" AND FORMTYPES(DRAFT)<>FALSE THEN
    DO
     DRAFTTRAN=0
     FORMLAUNCH=1
     CALL RESETREPTRANARRAY
     FOR T=1 TO 200
      DO  
       IF TSELECT(T)=TRUE AND CHARACTERSEARCH(TXN(T,TTYPE),"Draft")>0 THEN 
        DO
         DRAFTTRAN=DRAFTTRAN+1
         IF MOD(DRAFTTRAN,4)=0 THEN 
          DO
           FORMLAUNCH=FORMLAUNCH+1   [every 4TH tran adds a form]                    
           DRAFTTRAN=1  [RESET TO ONE]
          END         
         REPTRANARRAY(FORMLAUNCH,DRAFTTRAN,TDATE)=TXN(T,TDATE)
         REPTRANARRAY(FORMLAUNCH,DRAFTTRAN,TAMT)=TXN(T,TAMT)
         REPTRANARRAY(FORMLAUNCH,DRAFTTRAN,TDESC)=SEGMENT(TXN(T,TDESC),1,12)
         REPTRANARRAY(FORMLAUNCH,DRAFTTRAN,TPAYEE)=TXN(T,TPAYEE) 
        END
      END   
  
     DRAFTFORMCOUNT=FORMLAUNCH
  
     IF FORMLAUNCH>1 THEN
      DO
       DIALOGSTART("Draft Affidavit",100%,0)
       DIALOGINTROTEXT("Only 3 drafts can fit on each form; due to the number of drafts you have selected, "+FORMAT("#9",FORMLAUNCH)+" copies of this form will print.")
       DIALOGINTROTEXT("Please note that this form must be signed and notarized.")
       DIALOGDISPLAY
       DIALOGCLOSE
      END    
          
     FOR T=1 TO FORMLAUNCH
      DO 
       CALL RESETSYMFORMS
       INITSUBROUTINE(SUBERR)
       @ENVARGCODE1=VALUE(NAMEINFO(SELECTEDNAME,TNLOC))
       [CHECKBOXES:]
       IF DRAFT1<>"" THEN @ENVARGCODE2=1
       IF DRAFT2<>"" THEN @ENVARGCODE2=2
       IF DRAFT3<>"" THEN @ENVARGCODE2=3
       IF DRAFT4<>"" THEN @ENVARGCODE2=4
       IF DRAFT5<>"" THEN 
        DO
         @ENVARGCODE2=5
         @ENVARGCHAR4=DR1
         @ENVARGCHAR5=DR2
        END
       IF REPTRANARRAY(T,1,TDATE)<>"" THEN
        DO
         @ENVARGDATE1=DATEVALUE(REPTRANARRAY(T,1,TDATE))
         @ENVARGNUMBER1=VALUE(REPTRANARRAY(T,1,TDESC))
         @ENVARGMONEY1=MONEY(VALUE(REPTRANARRAY(T,1,TAMT)))
         @ENVARGCHAR1=REPTRANARRAY(T,1,TPAYEE)
        END
       IF REPTRANARRAY(T,2,TDATE)<>"" THEN
        DO
         @ENVARGDATE2=DATEVALUE(REPTRANARRAY(T,2,TDATE))
         @ENVARGNUMBER2=VALUE(REPTRANARRAY(T,2,TDESC))
         @ENVARGMONEY2=MONEY(VALUE(REPTRANARRAY(T,2,TAMT)))
         @ENVARGCHAR2=REPTRANARRAY(T,2,TPAYEE)
        END
       IF REPTRANARRAY(T,3,TDATE)<>"" THEN
        DO
         @ENVARGDATE3=DATEVALUE(REPTRANARRAY(T,3,TDATE))
         @ENVARGNUMBER3=VALUE(REPTRANARRAY(T,3,TDESC))
         @ENVARGMONEY3=MONEY(VALUE(REPTRANARRAY(T,3,TAMT)))
         @ENVARGCHAR3=REPTRANARRAY(T,3,TPAYEE)
        END                
       EXECUTE("ES315",SUBERR)
       IF SUBERR<>"" THEN 
        DO
         POPUPMESSAGE(1,"ERROR ON ES315!")
         POPUPMESSAGE(1,SUBERR)
        END
      END  [T=1 TO FORMLAUNCH]        
    END
       
   IF FORMTOUSE(ACH)="AS316" AND FORMTYPES(ACH)<>FALSE THEN
    DO
     ACHTRAN=0
     FORMLAUNCH=1
     CALL RESETREPTRANARRAY
     FOR T=1 TO 200
      DO  
       IF TSELECT(T)=TRUE AND CHARACTERSEARCH(TXN(T,TTYPE),"Unauthorized")>0 THEN 
        DO
         ACHTRAN=ACHTRAN+1
         IF MOD(ACHTRAN,5)=0 THEN 
          DO
           FORMLAUNCH=FORMLAUNCH+1   [every 5TH tran adds a form]                    
           ACHTRAN=1  [RESET TO ONE]
          END         
         REPTRANARRAY(FORMLAUNCH,ACHTRAN,TDATE)=TXN(T,TDATE)
         REPTRANARRAY(FORMLAUNCH,ACHTRAN,TAMT)=TXN(T,TAMT)
         REPTRANARRAY(FORMLAUNCH,ACHTRAN,TDESC)=SEGMENT(TXN(T,TDESC),1,12)
        END
      END   
      
     ACHFORMCOUNT=FORMLAUNCH
   
     IF FORMLAUNCH>1 THEN
      DO
       DIALOGSTART("Unauthorized ACH Debit Form",100%,0)
       DIALOGINTROTEXT("Only 4 transactions can fit on each form; due to the number of transactions you have selected, "+FORMAT("#9",FORMLAUNCH)+" copies of this form will print.")
       DIALOGDISPLAY
       DIALOGCLOSE       
      END    
          
     FOR T=1 TO FORMLAUNCH
      DO 
       CALL RESETSYMFORMS
       INITSUBROUTINE(SUBERR)
       @ENVARGCODE1=VALUE(NAMEINFO(SELECTEDNAME,TNLOC))
       [CHECKBOXES:]
       IF ACH1<>"" THEN @ENVARGCODE2=1
       IF ACH2<>"" THEN @ENVARGCODE2=2
       IF ACH3<>"" THEN @ENVARGCODE2=3
       IF ACH4<>"" THEN @ENVARGCODE2=4
       IF ACH5<>"" THEN @ENVARGCODE2=5
       IF ACH6<>"" THEN 
        DO
         @ENVARGCODE2=6
         @ENVARGCHAR5=ACHOTHER1
         @ENVARGCHAR6=ACHOTHER2
         @ENVARGCHAR7=ACHOTHER3
        END 
       @ENVARGNUMBER1=ACHSELECT1
       @ENVARGCHAR8=SHARELIST(SELECTEDSID,SID)
 
       IF REPTRANARRAY(T,1,TDATE)<>"" THEN
        DO
         @ENVARGDATE1=DATEVALUE(REPTRANARRAY(T,1,TDATE))
         @ENVARGMONEY1=MONEY(VALUE(REPTRANARRAY(T,1,TAMT)))
         @ENVARGCHAR1=SEGMENT(REPTRANARRAY(T,1,TDESC),1,30)
        END
       IF REPTRANARRAY(T,2,TDATE)<>"" THEN
        DO
         @ENVARGDATE2=DATEVALUE(REPTRANARRAY(T,2,TDATE))
         @ENVARGMONEY2=MONEY(VALUE(REPTRANARRAY(T,2,TAMT)))
         @ENVARGCHAR2=SEGMENT(REPTRANARRAY(T,2,TDESC),1,30)
        END
       IF REPTRANARRAY(T,3,TDATE)<>"" THEN
        DO
         @ENVARGDATE3=DATEVALUE(REPTRANARRAY(T,3,TDATE))
         @ENVARGMONEY3=MONEY(VALUE(REPTRANARRAY(T,3,TAMT)))
         @ENVARGCHAR3=SEGMENT(REPTRANARRAY(T,3,TDESC),1,30)
        END    
       IF REPTRANARRAY(T,4,TDATE)<>"" THEN
        DO
         @ENVARGDATE4=DATEVALUE(REPTRANARRAY(T,4,TDATE))
         @ENVARGMONEY4=MONEY(VALUE(REPTRANARRAY(T,4,TAMT)))
         @ENVARGCHAR4=SEGMENT(REPTRANARRAY(T,4,TDESC),1,30)
        END                     
       EXECUTE("AS316",SUBERR)
       IF SUBERR<>"" THEN 
        DO
         POPUPMESSAGE(1,"ERROR ON AS316!")
         POPUPMESSAGE(1,SUBERR)
        END
      END  [T=1 TO FORMLAUNCH]              
    END
    
   IF CALLCREATECARD=TRUE THEN  [REMIND TO LAUNCH CREATE CARD TO CANCEL CARDS FOR FRAUD CLAIMS]
    DO
     DIALOGSTART("Capture Card",100%,0)
     DIALOGINTROTEXT("If it hasn't been done already, please remember to capture all cards that have had Fraud associated with them.")
     DIALOGINTROTEXT("")
     DIALOGINTROTEXT("IMPORTANT: please make sure you are capturing the correct card!!")
     DIALOGINTROTEXT("")
     DIALOGINTROTEXT("ALSO IMPORTANT: Please check the member's share for FEES that need to be reversed!")
     DIALOGDISPLAY
     DIALOGCLOSE
    END 
  
   HTMLVIEWOPEN  								
   HTMLVIEWLINE("<HTML>")      
   HTMLVIEWLINE("<HEAD>")
   HTMLVIEWLINE(" <TITLE>Dispute/Fraud</TITLE>")
   HTMLVIEWLINE("</HEAD>")
 
   [BASIC STYLE]
   HTMLVIEWLINE("<STYLE>")
   HTMLVIEWLINE(" body {font: 12px Arial, sans-serif;}")
   HTMLVIEWLINE(" table {font: 12px Arial, sans-serif;}")
   HTMLVIEWLINE(" h1 {font: bold 26px Arial, sans-serif; margin-bottom: 0;color: #015F44}")
   HTMLVIEWLINE(" h2 {font: bold 14px Arial, sans-serif; margin-bottom: 0;color: #015F44}")
   HTMLVIEWLINE(" h3 {font: bold 11px Arial, sans-serif; margin-bottom: 0;color: #015F44}")
   HTMLVIEWLINE(" hr {color: #015F44}")
   HTMLVIEWLINE(" B {color: #015F44}")
   HTMLVIEWLINE("</STYLE>")
   HTMLVIEWLINE("<BODY BGCOLOR=#FFFFFF>")

   HTMLVIEWLINE("<form name='FraudDispute' METHOD=POST ACTION=symitar://HTMLView~Action=Post>  ")
   HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")
   HTMLVIEWLINE(" <thead>")
   HTMLVIEWLINE("  <tr>")
   HTMLVIEWLINE("   <th align=center>")
   HTMLVIEWLINE("    <IMG SRC=RCULOGO.JPG>")
   HTMLVIEWLINE("   </th>")
   HTMLVIEWLINE("  </tr>")
   
   HTMLVIEWLINE("<SCRIPT SRC='showhideoffcheckbx.js'></SCRIPT>") 
   HTMLVIEWLINE("<SCRIPT SRC='DATEFORMAT.js'></SCRIPT>")
   HTMLVIEWLINE("<SCRIPT SRC='AUTOCURRENCY.js'></SCRIPT>")
   HTMLVIEWLINE("<SCRIPT SRC='RCU_AUTOCURRENCY.js'></SCRIPT>")

   CALL LOADCSS   

   HTMLVIEWLINE("  <tr>")
   HTMLVIEWLINE("   <td align=center>")
   HTMLVIEWLINE("    <h1>Dispute/Fraud Claim</h1>")
   HTMLVIEWLINE(" <hr/>")
   HTMLVIEWLINE("   </td>")
   HTMLVIEWLINE("  </tr>")
   
   HTMLVIEWLINE(" </thead>")
   HTMLVIEWLINE("</table>")
   HTMLVIEWLINE("<body>")  
        
   HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")
   
   HTMLVIEWLINE("<tr><td align=center colspan=2><b>Success!!!</b>  Your claim information has been submitted successfully.</td></tr>")
   
   IF NEWPINCLAIM<>"" THEN 
    DO
     HTMLVIEWLINE("<tr><td align=center colspan=2>New PIN-based claim number "+NEWPINCLAIM+" has been created and logged.</td></tr>")
     NEWCLAIMNUM=NEWPINCLAIM
    END
   IF FMERR<>"" THEN 
    DO
     HTMLVIEWLINE("<TR><TD align=center colspan=2><B>There was an error creating the PIN claim note(s)" +FMERR+"</B></TD></TR>") 
    END
   IF PINCLAIM<>"" THEN HTMLVIEWLINE("<tr><td align=center colspan=2>Appending to PIN-based claim number: "+PINCLAIM+".</td></tr>") 
   IF CREDITAMT(PINBASED)>$0.00 THEN
    DO
     HTMLVIEWLINE("<TR><TD align=center>Provisional credit for this claim has been automatically posted to the member's account. ")
     HTMLVIEWLINE("They will receive a letter by mail.</td></tr>")
     IF CREDITTYPE(PINBASED)=FRAUD THEN
      DO
       HTMLVIEWLINE("<TR><TD align=center><FONT COLOR=RED><STRONG>")
       HTMLVIEWLINE("Please check the member's account for any fees that need to be reversed!</strong></font></td></tr>")
      END
    END
    
   IF MESSAGE<>"" THEN
    DO
     HTMLVIEWLINE("<TR><TD ALIGN=CENTER><FONT COLOR=RED>")
     HTMLVIEWLINE(MESSAGE)
     HTMLVIEWLINE("</FONT></td></tr>")
    END 
        
   IF NEWSIGFRAUDCLAIM<>"" THEN 
    DO
     HTMLVIEWLINE("<tr><td align=center colspan=2>New signature-based fraud claim number: "+NEWSIGFRAUDCLAIM+" has been created and logged.</td></tr>")  
     NEWCLAIMNUM=NEWSIGFRAUDCLAIM
    END     
   IF FMERR<>"" THEN 
    DO
     HTMLVIEWLINE("<TR><TD align=center colspan=2><B>There was an error creating the Signature claim note(s)" +FMERR+"</B></TD></TR>") 
    END 
       
   IF NEWSIGDISPUTECLAIM<>"" THEN 
    DO
     HTMLVIEWLINE("<tr><td align=center colspan=2>New Signature-based dispute number: "+NEWSIGDISPUTECLAIM+" has been created and logged.</td></tr>")   
     NEWCLAIMNUM=NEWSIGDISPUTECLAIM
    END    
   IF FMERR<>"" THEN 
    DO
     HTMLVIEWLINE("<TR><TD align=center colspan=2><B>There was an error creating the Sig claim note(s)" +FMERR+"</B></TD></TR>") 
    END
   IF SIGFRAUDCLAIM<>"" THEN HTMLVIEWLINE("<tr><td align=center colspan=2>Appending to Signature-based fraud claim number: "+SIGFRAUDCLAIM+".</td></tr>")
   IF SIGDISPUTECLAIM<>"" THEN HTMLVIEWLINE("<tr><td align=center colspan=2>Appending to Signature-based dispute claim number: "+SIGDISPUTECLAIM+".</td></tr>")
   IF CREDITAMT(SIGBASED)>$0.00 THEN
    DO
     HTMLVIEWLINE("<TR><TD align=center>Provisional credit for this claim has been automatically posted to the member's account. ")
     HTMLVIEWLINE("They will receive a letter by mail.</td></tr>")
     IF CREDITTYPE(SIGBASED)=FRAUD THEN
      DO
       HTMLVIEWLINE("<TR><TD align=center><FONT COLOR=RED><STRONG>")
       HTMLVIEWLINE("Please check the member's account for any fees that need to be reversed!</strong></font></td></tr>")
      END
    END        
    
   IF NEWPINCLAIM<>"" OR NEWSIGFRAUDCLAIM<>"" OR NEWSIGDISPUTECLAIM<>"" OR
      PINCLAIM<>"" OR SIGFRAUDCLAIM<>"" OR SIGDISPUTECLAIM<>"" THEN
    DO
     HTMLVIEWLINE("<tr><td align=center colspan=2>Please reference the appropriate claim number on any documentation that is")  
     HTMLVIEWLINE(" scanned over to "+DEPARTMENTNAME+".</td></tr>")
    END 
    
   IF DRAFTFORMCOUNT>0 THEN
    DO
     HTMLVIEWLINE("<tr><td align=center colspan=2></br>Draft Affidavit (Form "+FORMTOUSE(DRAFT)+") should have ")
     IF DRAFTFORMCOUNT>1 THEN HTMLVIEWLINE("printed "+FORMAT("#9",DRAFTFORMCOUNT)+" times.</td></tr>")
     IF DRAFTFORMCOUNT=1 THEN HTMLVIEWLINE("printed.</td></tr>")
     HTMLVIEWLINE("<tr><td align=center colspan=2><B>Please remind the member that this form must be notarized.</B></td></tr>")
    END
    
   IF ACHFORMCOUNT>0 THEN
    DO
     HTMLVIEWLINE("<tr><td align=center colspan=2></br>Unauthorized ACH Debit (Form "+FORMTOUSE(ACH)+") should have ")
     IF ACHFORMCOUNT>1 THEN HTMLVIEWLINE("launched "+FORMAT("#9",ACHFORMCOUNT)+" times.</td></tr>")
     IF ACHFORMCOUNT=1 THEN HTMLVIEWLINE("launched.</td></tr>")
    END    
   
   HTMLVIEWLINE("</table>") 
   
   HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")
   
   HTMLVIEWLINE("<tr>")
   HTMLVIEWLINE("<td align=center><input type='submit' name='quit' value='Click To Exit' class='rcubutton'></td>")
   HTMLVIEWLINE("</tr>")    
    
   HTMLVIEWLINE("</table>")   
   
   
   HTMLVIEWLINE("</body></html>")   
     
   HTMLVIEWDISPLAY


   INPUTCOUNT	= 0
   FOR I = 1 TO MAXINPUT
    DO
     INPUTFORM(I)	= ""
    END
   WHILE	INPUTFORM(INPUTCOUNT)	<> "EOD" AND INPUTCOUNT < MAXINPUT
    DO   
     INPUTCOUNT			= INPUTCOUNT + 1
     INPUTFORM(INPUTCOUNT)	= ENTERLINE(0)
    END
   CALL GETPOSTBACK4    
   
  END
END  [screenord 4]


PROCEDURE SCREEN99
 WHILE SCREENORD=99
  DO
   HTMLVIEWOPEN  								
   HTMLVIEWLINE("<HTML>")      
   HTMLVIEWLINE("<HEAD>")
   HTMLVIEWLINE(" <TITLE>Dispute/Fraud</TITLE>")
   HTMLVIEWLINE("</HEAD>")
 
   [BASIC STYLE]
   HTMLVIEWLINE("<STYLE>")
   HTMLVIEWLINE(" body {font: 12px Arial, sans-serif;}")
   HTMLVIEWLINE(" table {font: 12px Arial, sans-serif;}")
   HTMLVIEWLINE(" h1 {font: bold 26px Arial, sans-serif; margin-bottom: 0;color: #015F44}")
   HTMLVIEWLINE(" h2 {font: bold 14px Arial, sans-serif; margin-bottom: 0;color: #015F44}")
   HTMLVIEWLINE(" h3 {font: bold 11px Arial, sans-serif; margin-bottom: 0;color: #015F44}")
   HTMLVIEWLINE(" hr {color: #015F44}")
   HTMLVIEWLINE(" B {color: #015F44}")
   HTMLVIEWLINE("</STYLE>")
   HTMLVIEWLINE("<BODY BGCOLOR=#FFFFFF>")

   HTMLVIEWLINE("<form name='FraudDispute' METHOD=POST ACTION=symitar://HTMLView~Action=Post>  ")
   HTMLVIEWLINE("<table border=0 align=center cellspacing=0 CELLPADDING=5 width=90%>")
   HTMLVIEWLINE(" <thead>")
   HTMLVIEWLINE("  <tr>")
   HTMLVIEWLINE("   <th align=center>")
   HTMLVIEWLINE("    <IMG SRC=RCULOGO.JPG>")
   HTMLVIEWLINE("   </th>")
   HTMLVIEWLINE("  </tr>")
   
   HTMLVIEWLINE("<SCRIPT SRC='showhideoffcheckbx.js'></SCRIPT>") 
   HTMLVIEWLINE("<SCRIPT SRC='DATEFORMAT.js'></SCRIPT>")
   HTMLVIEWLINE("<SCRIPT SRC='AUTOCURRENCY.js'></SCRIPT>")
   HTMLVIEWLINE("<SCRIPT SRC='RCU_AUTOCURRENCY.js'></SCRIPT>")
  

   CALL LOADCSS   

   HTMLVIEWLINE("  <tr>")
   HTMLVIEWLINE("   <td align=center>")
   HTMLVIEWLINE("    <h1>Dispute/Fraud Claim</h1>")
   HTMLVIEWLINE(" <hr/>")
   HTMLVIEWLINE("   </td>")
   HTMLVIEWLINE("  </tr>")
   
   HTMLVIEWLINE(" </thead>")
   HTMLVIEWLINE("</table>")
   HTMLVIEWLINE("<body>")  
   
   
   HTMLVIEWLINE("</body></html>")   
     
   HTMLVIEWDISPLAY


   INPUTCOUNT	= 0
   FOR I = 1 TO MAXINPUT
    DO
     INPUTFORM(I)	= ""
    END
   WHILE	INPUTFORM(INPUTCOUNT)	<> "EOD" AND INPUTCOUNT < MAXINPUT
    DO   
     INPUTCOUNT			= INPUTCOUNT + 1
     INPUTFORM(INPUTCOUNT)	= ENTERLINE(0)
    END
   CALL GETPOSTBACK99    
   
  END
END  [screenord 99]

[-----------------------------------------START OF POSTBACK SECTION-------------------------------------------]

PROCEDURE GETPOSTBACK1
[ debug
 FOR X = 1 TO INPUTCOUNT
  DO    
   POPUPMESSAGE(1,INPUTFORM(X))
  END
 /debug]
 
 [This loop removes apostrophes & quotes from input]
 FOR X=1 TO INPUTCOUNT
  DO
   RAWCHAR=""
   RAWCHAR=INPUTFORM(X)
   CALL REMOVEFORBIDDENCHARS
   INPUTFORM(X)=FIXEDCHAR
  END
 
 [initialize]
 WHILELIMIT=1000000
 CONTINUE=FALSE
 RESREQ=FALSE
 LAUNCHCLAIMS=FALSE
 MISSINGATM=FALSE
 SERVCENTER=FALSE
 ECOUNT=0
 EXIT=FALSE
 RCUCORP=FALSE
 CREDITOVERRIDE=UNCHECKED
 
 
 FOR X=1 TO MAXERROR
  DO
   RETURNERROR(X)=FALSE
  END
 
 FOR X=1 TO INPUTCOUNT
  DO
   IF CHARACTERSEARCH(INPUTFORM(X),"Continue") <> 0 THEN CONTINUE=TRUE   
   IF CHARACTERSEARCH(INPUTFORM(X),"quit") <> 0 THEN EXIT=TRUE 
 
   IF CHARACTERSEARCH(INPUTFORM(X),"nameChoice")<>0 THEN 
     SELECTEDNAME=VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))

   IF CHARACTERSEARCH(INPUTFORM(X),"SHARELIST")<>0 THEN
    DO
     TEMPCHAR=""
     TEMPCHAR=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
     SELECTEDSID=VALUE(TEMPCHAR)
    END
   
   IF CHARACTERSEARCH(INPUTFORM(X),"launchClaims")<>0 THEN LAUNCHCLAIMS=TRUE
   IF CHARACTERSEARCH(INPUTFORM(X),"missingATM")<>0 THEN MISSINGATM=TRUE
   IF CHARACTERSEARCH(INPUTFORM(X),"resReq")<>0 THEN RESREQ=TRUE 
   IF CHARACTERSEARCH(INPUTFORM(X),"servCenter")<>0 THEN SERVCENTER=TRUE
   
   IF CHARACTERSEARCH(INPUTFORM(X),"LPContinue") <> 0 THEN SPECIALHANDLING=TRUE
   
   IF CHARACTERSEARCH(INPUTFORM(X),"CorpContinue") <> 0 THEN 
    DO
     RCUCORP=TRUE
     CONTINUE=FALSE  [THIS PREVENTS REGULAR VALIDATION]
    END
    
   IF CHARACTERSEARCH(INPUTFORM(X),"corpnamefirst")<>0 THEN 
     RCUNAMEF=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))  
   IF CHARACTERSEARCH(INPUTFORM(X),"corpnamelast")<>0 THEN 
     RCUNAMEL=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"corpcardnum")<>0 THEN 
     RCUCARDNUM=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"dummyAcct")<>0 THEN 
     DUMMYSELECT=VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))
     
   IF CHARACTERSEARCH(INPUTFORM(X),"creditOverride")<>0 AND ISFRAUDDEPT=TRUE THEN
    CREDITOVERRIDE=CHECKED 
  END

 IF CONTINUE=TRUE THEN 
  DO
   CARDTRUNC=FORMAT("99999999",VALUE(SEGMENT(CARDDESC(SELECTEDNAME),17,26))) 
   IF CARDTRUNC="00000000" THEN [MUST BE VISA]
    CARDTRUNC=FORMAT("XXXX9999",VALUE(SHARELIST(SELECTEDSID,SDESC))) 
   [IF CREDITOVERRIDE=CHECKED AND ISFRAUDDEPT=TRUE THEN 
    DO
     GIVECREDIT(PINBASED)=-1  [SET BACK TO 'NEUTRAL' - NEITHER TRUE NOR FALSE]
     GIVECREDIT(SIGBASED)=-1
     NOCREDITREASON(PINBASED)=""
     NOCREDITREASON(SIGBASED)=""
    END ]
   IF CREDITOVERRIDE=UNCHECKED AND ISFRAUDDEPT=TRUE THEN
    DO
     GIVECREDIT(PINBASED)=FALSE
     GIVECREDIT(SIGBASED)=FALSE
     NOCREDITREASON(PINBASED)="Claim manually entered by Fraud staff."
     DBNOCREDITREASON(PINBASED)="Claim manually entered by Fraud staff."
     NOCREDITREASON(SIGBASED)="Claim manually entered by Fraud staff." 
     DBNOCREDITREASON(SIGBASED)="Claim manually entered by Fraud staff."   
    END         
  END
    
 IF RCUCORP=TRUE THEN
  DO
   CARDTRUNC=FORMAT("99999999",VALUE(SEGMENT(RCUCARDNUM,9,16)))
   RCUNAME=RCUNAMEF + " "+RCUNAMEL
  END
  
[debug
popupmessage(1,"CREDITOVERRIDE="+CREDITOVERRIDE)  ]
  
 IF RESREQ=TRUE THEN
  DO    
   INITSUBROUTINE(SUBERR)
   EXECUTE("SW.RES.REQ",SUBERR)
   IF SUBERR<>"" THEN POPUPMESSAGE(2,"Repgen launch error:  "+SUBERR)  
   ALLDONE=TRUE
   SCREENORD=0
  END  
 
 IF LAUNCHCLAIMS=TRUE THEN
 DO
     INITSUBROUTINE(SUBERR)
     EXECUTE("CS.CLAIMS", SUBERR)
     IF SUBERR<>"" THEN POPUPMESSAGE(2,"Repgen launch error:  "+SUBERR)  
 END
 
 IF MISSINGATM=TRUE THEN
  DO    
   INITSUBROUTINE(SUBERR)
   EXECUTE("JIB.MISSINGATMDEP",SUBERR)
   IF SUBERR<>"" THEN POPUPMESSAGE(2,"Repgen launch error:  "+SUBERR)  
   
[COPIED FROM JIB.DISPUTE]   
   IF	@ENVARGCHAR1	 = "Print Form"	THEN
    DO
     ADJAMT			= @ENVARGMONEY1
     INITSUBROUTINE(ERRORTEXT)
     @ENVARGMONEY1	= ADJAMT
     EXECUTE("LR1314", ERRORTEXT)
     IF ERRORTEXT <> "" THEN
      DO
       POPUPMESSAGE(1, ERRORTEXT)
      END
     ELSE
      DO
       DIALOGSTART("Notice of Provisional Credit", 100%, 0)
        DIALOGTEXTLISTSTART("")
         DIALOGTEXTLISTOPTION("The Notice of Provisional Credit letter has been printed.  ")
         DIALOGTEXTLISTOPTION("Please give this letter to the Member.")
         DIALOGTEXTLISTOPTION("If the Member is not present, please mail the letter.")
        DIALOGTEXTLISTEND
       DIALOGDISPLAY
       DIALOGCLOSE
      END
    END
        
[END CODE FROM JIB.DISPUTE]   
   ALLDONE=TRUE
   SCREENORD=0
  END    
  

  
 IF SERVCENTER=TRUE THEN
  DO    
   INITSUBROUTINE(SUBERR)
   EXECUTE("CS230",SUBERR)
   IF SUBERR<>"" THEN POPUPMESSAGE(2,"Repgen launch error:  "+SUBERR)     
   ALLDONE=TRUE
   SCREENORD=0
  END   
  
  
 IF CONTINUE=TRUE AND 
    SELECTEDNAME=0 THEN
  DO
   ECOUNT=ECOUNT+1
   RETURNERROR(MISSINGMEMBER)=TRUE
   SCREENORD=1
  END

 IF CONTINUE=TRUE AND 
    SELECTEDSID=0 THEN
  DO
   ECOUNT=ECOUNT+1
   RETURNERROR(MISSINGID)=TRUE
   SCREENORD=1
  END  
  
 [TEST TO MAKE SURE THE TWO PROMPTS MAKE SENSE TOGETHER; DIDN'T SELECT VISA *AND* A DEBIT CARD] 
 IF CONTINUE=TRUE AND
    SELECTEDSID<>0 AND
    SELECTEDNAME<>0 THEN
  DO
   IF SHARELIST(SELECTEDSID,SINDICATOR)="V" AND
      CHARACTERSEARCH(CARDDESC(SELECTEDNAME),"Visa")=0 THEN
    DO
     ECOUNT=ECOUNT+1
     RETURNERROR(SELECTIONMISMATCH)=TRUE
     SCREENORD=1
    END
  END
 
 IF CONTINUE=TRUE AND
    ECOUNT=0 THEN
   SCREENORD=2   
   
 IF SHARELIST(SELECTEDSID,SINDICATOR)="V" OR 
    CHARACTERSEARCH(CARDDESC(SELECTEDNAME),"Debit")>0 OR
    CHARACTERSEARCH(CARDDESC(SELECTEDNAME),"ATM")>0 THEN
  VERIFYCARD=TRUE  
  
 IF SCREENORD=2 AND VERIFYCARD=TRUE THEN  [SECONDARY POPUP TO VERIFY CARD NUMBER; DOESN'T APPLY TO CORP CARD LOOP BELOW]
  DO
   LAST4SHOULDBE=SEGMENT(CARDTRUNC,5,8)
   DIALOGSTART("Verify Card Number",100%,0)
   DIALOGINTROTEXT("It is critical that the correct card number is associated with this claim.")
   DIALOGINTROTEXT("Incorrect card numbers will cause the wrong card to be blocked and captured.")
   DIALOGINTROTEXT("Please enter the last 4 digits of the Member's card for verification.")
   DIALOGPROMPTCHAR("Last 4 digits: ",4,"XXXX")
   DIALOGDISPLAY
   LAST4ENTERED=ENTERCHARACTER("Last 4 digits: ",4,"XXXX")
   DIALOGCLOSE
   [  Stop checking last 4 for credit cards.  Any 4 digits will pass.
   IF LAST4SHOULDBE<>LAST4ENTERED THEN
    DO
     DIALOGSTART("Card mismatch",100%,0)
     DIALOGINTROTEXT("Your entry does not match the last 4 digits of the selected card.")
     DIALOGINTROTEXT("Please double check your selection and re-enter.")
     DIALOGDISPLAY
     DIALOGCLOSE
     CONTINUE=FALSE
     SCREENORD=1
    END
   ]
   IF LAST4SHOULDBE=LAST4ENTERED THEN  [HOPEFULLY THIS MEANS THEY'VE PICKED THE RIGHT CARD NOW]
    DO
     CALL GETCAMS  [FIND ANY CAMS COMMENTS ASSOCIATED WITH THIS CARD; LOAD THE 2 MOST RECENT]
    END    
  END
   
 [INDEXING INFO - ASSUME FOR MOST IT WILL BE THIS MEMBER ACCT INFO]   
 INDEXACCT=ACCOUNT:NUMBER  
 INDEXNAME=NLONGNAME(0)
 INDEXSSN=NSSN(0)
  
 IF RCUCORP=TRUE THEN
  DO
   IF RCUNAME<>"" AND
      RCUCARDNUM<>"" THEN
    DO
     [THIS IS WEIRD, BUT GETS ENTERED MEMBER NAME INTO THE SYSTEM PROPERLY FOR FORMS ETC.]
     CARDCOUNT=CARDCOUNT+1
     SELECTEDNAME=CARDCOUNT
     NAMEINFO(SELECTEDNAME,TNLONGNAME)=RCUNAME
     NAMEINFO(SELECTEDNAME,TNFIRSTNAME)=RCUNAMEF
     NAMEINFO(SELECTEDNAME,TNLASTNAME)=RCUNAMEL
     NAMEINFO(SELECTEDNAME,TNSSN)="999-99-9999"
     CARDNUMS(SELECTEDNAME)=RCUCARDNUM
     IF DUMMYSELECT<>1 THEN [MBR IS NOT ON THIS ACCT]
      DO
       INDEXACCT="0000316052"  [USE RCU VISA CLEARING ACCT FOR NON-MEMBERS]
       INDEXNAME="RCU VISA CREDIT BALANCE CLEARING"
       INDEXSSN="941244186"
      END
     SCREENORD=2
    END
   IF RCUNAME="" THEN
    DO
     ECOUNT=ECOUNT+1
     RETURNERROR(MISSINGMEMBER)=TRUE
     SCREENORD=1
    END   
   IF RCUCARDNUM="" THEN
    DO
     ECOUNT=ECOUNT+1
     RETURNERROR(MISSINGID)=TRUE
     SCREENORD=1
    END      
  END
     
 IF EXIT=TRUE THEN 
  DO
   SCREENORD=0
   ALLDONE=TRUE
  END
END  [GETPOSTBACK 1]

PROCEDURE GETPOSTBACK2
[ debug
 FOR X = 1 TO INPUTCOUNT
  DO    
   POPUPMESSAGE(1,INPUTFORM(X))
  END
 /debug]
 
 [This loop removes apostrophes & quotesfrom input]
 FOR X=1 TO INPUTCOUNT
  DO
   RAWCHAR=""
   RAWCHAR=INPUTFORM(X)
   CALL REMOVEFORBIDDENCHARS 
   INPUTFORM(X)=FIXEDCHAR
  END 
 
 [initialize]
 WHILELIMIT=1000000
 CONTINUE=FALSE
 EXIT=FALSE
 TXNSEARCH=FALSE
 VFLAG=FALSE
 TFLAG=FALSE
 ECOUNT=0

 
 FOR X=1 TO MAXERROR
  DO
   RETURNERROR(X)=FALSE
  END  
 FOR X=1 TO 200
  DO
   TSELECT(X)=FALSE
  END 

 FOR X=1 TO INPUTCOUNT
  DO
   IF CHARACTERSEARCH(INPUTFORM(X),"Continue") <> 0 THEN CONTINUE=TRUE  
   IF CHARACTERSEARCH(INPUTFORM(X),"quit") <> 0 THEN EXIT=TRUE 
   
   IF CHARACTERSEARCH(INPUTFORM(X),"TContinue") <> 0 THEN 
    DO
     TFLAG=TRUE 
     TXNSEARCH=TRUE
    END
   IF CHARACTERSEARCH(INPUTFORM(X),"VContinue") <> 0 THEN 
    DO
     VFLAG=TRUE  
    END
         
   IF CHARACTERSEARCH(INPUTFORM(X),"Search")<>0 THEN TXNSEARCH=TRUE  
   IF CHARACTERSEARCH(INPUTFORM(X),"startDate")>0 THEN
    DO
     SEARCHSTARTDATE=DATEVALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))
    END
   IF CHARACTERSEARCH(INPUTFORM(X),"endDate")>0 THEN
    DO
     SEARCHENDDATE=DATEVALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))
    END     
    
   IF CHARACTERSEARCH(INPUTFORM(X),"TSelect")>0 THEN
    DO
     THISLINE=VALUE(SEGMENT(INPUTFORM(X),2,4))  
     TSELECT(THISLINE)=TRUE      
    END
    
   IF CHARACTERSEARCH(INPUTFORM(X),"vDate")>0 THEN
    DO
     THISLINE=VALUE(SEGMENT(INPUTFORM(X),6,7))     
     TXN(THISLINE,TDATE)=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
     IF TXN(THISLINE,TDATE)<>"" THEN 
      DO
       TSELECT(THISLINE)=TRUE
       TXN(THISLINE,TTYPE)="Signature Based"      
      END
     [here - JZR]
     IF (DATEVALUE(TXN(THISLINE,TDATE))<LOWDATE OR
        DATEVALUE(TXN(THISLINE,TDATE))>HIGHDATE) and DATEVALUE(TXN(THISLINE,TDATE)) <> '--/--/--' AND TXN(THISLINE,TAMT) <> "" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(BADDATE)=TRUE
      END 
    END
   IF CHARACTERSEARCH(INPUTFORM(X),"vAmt")>0 THEN
    DO
     THISLINE=VALUE(SEGMENT(INPUTFORM(X),5,6))     
     TXN(THISLINE,TAMT)=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
     IF TXN(THISLINE,TAMT)<>"" THEN
      DO
       TSELECT(THISLINE)=TRUE
       TXN(THISLINE,TTYPE)="Signature Based"      
      END    
    END       
   IF CHARACTERSEARCH(INPUTFORM(X),"vdescr")>0 THEN
    DO
     THISLINE=VALUE(SEGMENT(INPUTFORM(X),7,8))     
     TXN(THISLINE,TDESC)=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
     IF TXN(THISLINE,TDESC)<>"" THEN
      DO
       TSELECT(THISLINE)=TRUE
       TXN(THISLINE,TTYPE)="Signature Based"     
      END      
    END                            
  END  [GOING THROUGH INPUT FIELDS]
  
  
 [CHECK FOR VARIOUS ERRORS]
 
 IF SEARCHENDDATE='--/--/--' THEN SEARCHENDDATE=SYSTEMDATE
 
 IF SEARCHSTARTDATE='--/--/--' AND TFLAG=TRUE THEN 
  DO
   ECOUNT=ECOUNT+1
   RETURNERROR(MISSINGSTARTDATE)=TRUE
  END
 IF SEARCHSTARTDATE>SEARCHENDDATE THEN 
  DO
   ECOUNT=ECOUNT+1
   RETURNERROR(DATEINCONSISTENCY)=TRUE
  END 
 
 IF TFLAG=TRUE THEN
  DO
   RETURNERROR(NOSELECTION)=TRUE
   FOR T=1 TO 200
    DO
     IF TSELECT(T)=TRUE THEN 
      DO
       RETURNERROR(NOSELECTION)=FALSE
      END
    END
   IF RETURNERROR(NOSELECTION)=TRUE THEN ECOUNT=ECOUNT+1 
  END
  
 IF VFLAG=TRUE THEN
  DO
   [FIRST CLEAR ANY LINES WHERE ALL VISIBLE ENTRIES ARE REMOVED]
   FOR T=1 TO 20
    DO
     IF TXN(T,TTYPE)="Signature Based" AND
        TXN(T,TDATE)="" AND
        TXN(T,TAMT)="" AND
        TXN(T,TDESC)="" THEN
      TXN(T,TTYPE)=""
    END
   FOR T=1 TO 20
    DO
     IF TXN(T,TTYPE)="Signature Based" THEN   [THIS LINE HAS AT LEAST ONE BIT OF DATA]
      DO
       TSELECT(T)=TRUE             
       IF TXN(T,TDATE)="" THEN
        DO
         ECOUNT=ECOUNT+1
         RETURNERROR(MISSINGDATE)=TRUE
        END
       IF TXN(T,TAMT)="" THEN
        DO
         ECOUNT=ECOUNT+1
         RETURNERROR(MISSINGAMOUNT)=TRUE
        END
       IF TXN(T,TDESC)="" THEN
        DO
         ECOUNT=ECOUNT+1
         RETURNERROR(MISSINGDESCRIPTION)=TRUE
        END
       IF LENGTH(TXN(T,TAMT))>10 THEN   [DOLLAR AMOUNT ENTERED IS TOO LARGE]
        DO
         ECOUNT=ECOUNT+1 
         RETURNERROR(AMOUNTTOOLARGE)=TRUE
        END
      END
    END
    
   RETURNERROR(NOVISATRAN)=TRUE
   FOR T=1 TO 20
    DO
     IF TSELECT(T)=TRUE THEN 
      DO     
       RETURNERROR(NOVISATRAN)=FALSE
      END
    END    
   IF RETURNERROR(NOVISATRAN)=TRUE THEN ECOUNT=ECOUNT+1   
   
   IF ECOUNT=0 THEN
    DO
     CALL FINDVISANOTES 
    END
  END
 
 IF TXNSEARCH=TRUE AND CONTINUE=FALSE THEN
  DO
   CALL INITIALIZETXNARRAYS
   CALL FINDTRANSACTIONS
  END 
  
 IF (TFLAG=TRUE OR VFLAG=TRUE) AND ECOUNT>0 THEN SCREENORD=2
 IF (TFLAG=TRUE OR VFLAG=TRUE) AND ECOUNT=0 THEN 
  DO
   SCREENORD=3
   
   CALL PREPFORMTYPES
   
   FOR T=1 TO 200
    DO    
     IF TSELECT(T)=TRUE THEN
      DO      
       IF CHARACTERSEARCH(TXN(T,TTYPE),"PIN")>0 THEN FORMTYPES(PINBASED)=FORMTYPES(PINBASED)+1
       IF CHARACTERSEARCH(TXN(T,TTYPE),"Signature")>0 THEN FORMTYPES(SIGBASED)=FORMTYPES(SIGBASED)+1
       IF CHARACTERSEARCH(TXN(T,TTYPE),"Research")>0 THEN FORMTYPES(RESHREQ)=TRUE
       IF CHARACTERSEARCH(TXN(T,TTYPE),"Draft")>0 THEN FORMTYPES(DRAFT)=FORMTYPES(DRAFT)+1
       IF CHARACTERSEARCH(TXN(T,TTYPE),"Unauthorized")>0 THEN FORMTYPES(ACH)=FORMTYPES(ACH)+1
       IF CHARACTERSEARCH(TXN(T,TTYPE),"Missing")>0 THEN FORMTYPES(ATMDEP)=TRUE
      END
    END  
  END    
   
 IF EXIT=TRUE THEN 
  DO
   SCREENORD=0
   ALLDONE=TRUE
  END   
   
END  [GETPOSTBACK 2]

PROCEDURE GETPOSTBACK3
[ debug
 FOR X = 1 TO INPUTCOUNT
  DO    
   POPUPMESSAGE(1,INPUTFORM(X))
  END
 /debug]

 [This loop removes apostrophes & quotes from input]
 FOR X=1 TO INPUTCOUNT
  DO
   RAWCHAR=""
   RAWCHAR=INPUTFORM(X)
   CALL REMOVEFORBIDDENCHARS 
   INPUTFORM(X)=FIXEDCHAR
  END
  
[run this again; to clear any forms that were flagged but transactions have since been de-selected]
   CALL PREPFORMTYPES
   
   FOR T=1 TO 200
    DO    
     IF TSELECT(T)=TRUE THEN
      DO      
       IF CHARACTERSEARCH(TXN(T,TTYPE),"PIN")>0 THEN FORMTYPES(PINBASED)=FORMTYPES(PINBASED)+1
       IF CHARACTERSEARCH(TXN(T,TTYPE),"Signature")>0 THEN FORMTYPES(SIGBASED)=FORMTYPES(SIGBASED)+1
       IF CHARACTERSEARCH(TXN(T,TTYPE),"Research")>0 THEN FORMTYPES(RESHREQ)=TRUE
       IF CHARACTERSEARCH(TXN(T,TTYPE),"Draft")>0 THEN FORMTYPES(DRAFT)=FORMTYPES(DRAFT)+1
       IF CHARACTERSEARCH(TXN(T,TTYPE),"Unauthorized")>0 THEN FORMTYPES(ACH)=FORMTYPES(ACH)+1
       IF CHARACTERSEARCH(TXN(T,TTYPE),"Missing")>0 THEN FORMTYPES(ATMDEP)=TRUE
      END
    END
 
 [initialize]
 WHILELIMIT=1000000
 CONTINUE=FALSE
 GOBACK=FALSE
 GOWAYBACK=FALSE
 EXIT=FALSE
 ECOUNT=0
 THISLINE=0
 
 [TEMAIL=FALSE]
  
 FOR X=1 TO MAXERROR
  DO
   RETURNERROR(X)=FALSE
  END 
 ACH1=""
 ACH2=""
 ACH3=""
 ACH4=""
 ACH5=""
 ACH6=""
 
 SIGAPPEND=FALSE
 PINAPPEND=FALSE 
 
 FOR X=1 TO INPUTCOUNT
  DO
   IF CHARACTERSEARCH(INPUTFORM(X),"Continue") <> 0 THEN CONTINUE=TRUE  
   IF CHARACTERSEARCH(INPUTFORM(X),"quit") <> 0 THEN EXIT=TRUE 
   IF CHARACTERSEARCH(INPUTFORM(X),"goback") <> 0 THEN GOBACK=TRUE 
   IF CHARACTERSEARCH(INPUTFORM(X),"gowayback")<>0 THEN GOWAYBACK=TRUE 
   
   [IF CHARACTERSEARCH(INPUTFORM(X),"TemailForms") <> 0 THEN 
    DO
     TEMAIL=TRUE   
    END]
         
   
   IF CHARACTERSEARCH(INPUTFORM(X),"fraudbutton")<>0 THEN 
    DO
     BUTTONCLICKED=1 
    END
   IF CHARACTERSEARCH(INPUTFORM(X),"disputebutton")<>0 THEN 
    DO
     BUTTONCLICKED=2 
    END
   
   IF CHARACTERSEARCH(INPUTFORM(X),"dispute01")<>0 THEN DISPUTEBUTTON=1
   IF CHARACTERSEARCH(INPUTFORM(X),"dispute02")<>0 THEN DISPUTEBUTTON=2
   IF CHARACTERSEARCH(INPUTFORM(X),"dispute03")<>0 THEN DISPUTEBUTTON=3
   IF CHARACTERSEARCH(INPUTFORM(X),"dispute04")<>0 THEN DISPUTEBUTTON=4
   IF CHARACTERSEARCH(INPUTFORM(X),"dispute05")<>0 THEN DISPUTEBUTTON=5
   IF CHARACTERSEARCH(INPUTFORM(X),"dispute06")<>0 THEN DISPUTEBUTTON=6
   IF CHARACTERSEARCH(INPUTFORM(X),"dispute07")<>0 THEN DISPUTEBUTTON=7
   IF CHARACTERSEARCH(INPUTFORM(X),"dispute08")<>0 THEN DISPUTEBUTTON=8
   IF CHARACTERSEARCH(INPUTFORM(X),"dispute09")<>0 THEN DISPUTEBUTTON=9
   IF CHARACTERSEARCH(INPUTFORM(X),"dispute10")<>0 THEN DISPUTEBUTTON=10
   IF CHARACTERSEARCH(INPUTFORM(X),"dispute11")<>0 THEN DISPUTEBUTTON=11
   IF CHARACTERSEARCH(INPUTFORM(X),"dispute12")<>0 THEN DISPUTEBUTTON=12
 
   [sig based stuff - both]
   IF CHARACTERSEARCH(INPUTFORM(X),"sappendClaim")<>0 AND
      VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))>0 THEN 
    DO
     SAPPENDCLAIM=VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))) 
    END     
     
   [SIG based stuff - dispute]  
   IF CHARACTERSEARCH(INPUTFORM(X),"sd01")<>0 THEN
    SD01=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sd02")<>0 THEN
    SD02=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sd03")<>0 THEN
    SD03=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sd04")<>0 THEN
    SD04=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sd06")<>0 THEN
    SD06=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))    
   IF CHARACTERSEARCH(INPUTFORM(X),"sd07")<>0 THEN
    SD07=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))    
   IF CHARACTERSEARCH(INPUTFORM(X),"sd09")<>0 THEN
    SD09=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sd10")<>0 THEN
    SD10=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sd11")<>0 THEN
    SDSELECT11=VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))        
   IF CHARACTERSEARCH(INPUTFORM(X),"sd12")<>0 THEN
    SD12=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))    
   IF CHARACTERSEARCH(INPUTFORM(X),"sd14")<>0 THEN
    SD14=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sd15")<>0 THEN
    SD15=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sd16")<>0 THEN
    SD16=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sd17")<>0 THEN
    SD17=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))    
   IF CHARACTERSEARCH(INPUTFORM(X),"sd18")<>0 THEN
    SD18=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))    
   IF CHARACTERSEARCH(INPUTFORM(X),"sd19")<>0 THEN
    SD19=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sd20")<>0 THEN
    SD20=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sd22")<>0 THEN
    SD22=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))    
   IF CHARACTERSEARCH(INPUTFORM(X),"sd23")<>0 THEN
    SD23=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))    
   IF CHARACTERSEARCH(INPUTFORM(X),"sd24")<>0 THEN
    SDSELECT24=VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))
   IF CHARACTERSEARCH(INPUTFORM(X),"sd25")<>0 THEN
    SD25=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sd26")<>0 THEN
    SD26=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sd27")<>0 THEN
    SD27=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))    
   IF CHARACTERSEARCH(INPUTFORM(X),"sd28")<>0 THEN
    SDSELECT28=VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))    
   IF CHARACTERSEARCH(INPUTFORM(X),"sd29")<>0 THEN
    SD29=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sd30")<>0 THEN
    SD30=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sd31")<>0 THEN
    SD31=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sd32")<>0 THEN
    SD32=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))    
   IF CHARACTERSEARCH(INPUTFORM(X),"sd33")<>0 THEN
    SD33=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))  
   IF CHARACTERSEARCH(INPUTFORM(X),"vdAmt")>0 THEN
    DO
     THISLINE=VALUE(SEGMENT(INPUTFORM(X),6,7))     
     TXN(THISLINE,TDAMT)=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
    END       
           
   [sig-based stuff - fraud]
   IF CHARACTERSEARCH(INPUTFORM(X),"sb1")<>0 THEN
    SBSELECT1=VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))
   IF CHARACTERSEARCH(INPUTFORM(X),"sb2")<>0 THEN
    SB2=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))    
   IF CHARACTERSEARCH(INPUTFORM(X),"sb3")<>0 THEN
    SBSELECT3=VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))
   IF CHARACTERSEARCH(INPUTFORM(X),"sb4a")<>0 THEN
    SBSELECT4=VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))
   IF CHARACTERSEARCH(INPUTFORM(X),"sb4b")<>0 THEN
    SB4=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"sb5")<>0 THEN
    SB5=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"sb6")<>0 THEN
    SB6=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"sb7")<>0 THEN
    SB7=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"sb8")<>0 THEN
    SB8=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"sb9")<>0 THEN
    SB9=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"sb_10")<>0 THEN
    SB10=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"sb_11")<>0 THEN
    SB11=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sb_12")<>0 THEN
    SB12=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"sb_13")<>0 THEN
    SB13=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
  
   [pin-based stuff]
   IF CHARACTERSEARCH(INPUTFORM(X),"pappendClaim")<>0 AND
      VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))>0 THEN 
    PAPPENDCLAIM=VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))    
   IF CHARACTERSEARCH(INPUTFORM(X),"pbdesc1")<>0 THEN 
    PBDESC1=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"pbdesc2")<>0 THEN 
    PBDESC2=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"pbdesc3")<>0 THEN 
    PBDESC3=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))     
   IF CHARACTERSEARCH(INPUTFORM(X),"pb6")<>0 THEN
    PBSELECT6=VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))
   IF CHARACTERSEARCH(INPUTFORM(X),"pb1")<>0 THEN
    PBSELECT1=VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))
   IF CHARACTERSEARCH(INPUTFORM(X),"pb2=")<>0 THEN
    PBSELECT2=VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))
   IF CHARACTERSEARCH(INPUTFORM(X),"pb2a1")<>0 THEN
    PB2A1=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"pb2a2")<>0 THEN
    PB2A2=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"pb2a3")<>0 THEN
    PB2A3=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"pb2b")<>0 THEN
    PB2B=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"pb2c1")<>0 THEN
    PB2C1=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"pb2c2")<>0 THEN
    PB2C2=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"pb2d")<>0 THEN
    PB2D=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))        
   IF CHARACTERSEARCH(INPUTFORM(X),"pb2e")<>0 THEN
    PB2E=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"pb3")<>0 THEN
    PBSELECT3=VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))
   IF CHARACTERSEARCH(INPUTFORM(X),"pb4a")<>0 THEN
    PBSELECT4=VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))
   IF CHARACTERSEARCH(INPUTFORM(X),"pb4b")<>0 THEN
    PB4B=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"pb5a")<>0 THEN
    PBSELECT5=VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))))
   IF CHARACTERSEARCH(INPUTFORM(X),"pb5b")<>0 THEN
    PB5B=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
    [end of pin-based entries]
    
    [draft affidavit entries]
   IF CHARACTERSEARCH(INPUTFORM(X),"dPayee")<>0 THEN
    DO
     THISLINE=VALUE(SEGMENT(INPUTFORM(X),7,8))
     DPAYEE(THISLINE)=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
     TXN(THISLINE,TPAYEE)=DPAYEE(THISLINE)
     IF THISLINE>MAXLINE THEN MAXLINE=THISLINE
    END
   IF CHARACTERSEARCH(INPUTFORM(X),"draft1")<>0 THEN
    DRAFT1=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"draft2")<>0 THEN
    DRAFT2=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"draft3")<>0 THEN
    DRAFT3=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"draft4")<>0 THEN
    DRAFT4=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"draft5")<>0 THEN
    DRAFT5=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))  
   IF CHARACTERSEARCH(INPUTFORM(X),"dr1")<>0 THEN
    DR1=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"dr2")<>0 THEN
    DR2=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))   
   [end of draft entries]  
   
   [unauth ach entries]
   IF CHARACTERSEARCH(INPUTFORM(X),"achOpt1")<>0 THEN
    ACH1=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"achOpt2")<>0 THEN
    ACH2=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"achOpt3")<>0 THEN
    ACH3=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"achOpt4")<>0 THEN
    ACH4=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"achOpt5")<>0 THEN
    ACH5=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"achOpt6")<>0 THEN
    ACH6=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"achstop")<>0 THEN
    ACHSELECT1=VALUE(SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"achother1")<>0 THEN
    ACHOTHER1=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
   IF CHARACTERSEARCH(INPUTFORM(X),"achother2")<>0 THEN
    ACHOTHER2=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X)))
   IF CHARACTERSEARCH(INPUTFORM(X),"achother3")<>0 THEN
    ACHOTHER3=SEGMENT(INPUTFORM(X),CHARACTERSEARCH(INPUTFORM(X),"=")+1,LENGTH(INPUTFORM(X))) 
    
   [end unauth ach entries]
  END   [end of input records]   
 
 
  [ACH ERROR CHECK]
 IF FORMTYPES(ACH)<>FALSE AND CONTINUE=TRUE THEN
  DO  
    SELECTCOUNT=0 
    IF ACH1<>"" THEN SELECTCOUNT=SELECTCOUNT+1
    IF ACH2<>"" THEN SELECTCOUNT=SELECTCOUNT+1
    IF ACH3<>"" THEN SELECTCOUNT=SELECTCOUNT+1
    IF ACH4<>"" THEN SELECTCOUNT=SELECTCOUNT+1
    IF ACH5<>"" THEN SELECTCOUNT=SELECTCOUNT+1
    IF ACH6<>"" THEN SELECTCOUNT=SELECTCOUNT+1
    IF SELECTCOUNT=0 THEN
     DO
      ECOUNT=ECOUNT+1
      RETURNERROR(ASELECTONE)=TRUE
     END
    IF SELECTCOUNT>1 THEN
     DO
      ECOUNT=ECOUNT+1
      RETURNERROR(ASELECTONLYONE)=TRUE
     END  
    IF ACH6<>"" AND ACHOTHER1="" AND ACHOTHER2="" AND ACHOTHER3="" THEN
     DO
      ECOUNT=ECOUNT+1
      RETURNERROR(AOTHER)=TRUE
     END
    IF ACH2<>"" AND ACHSELECT1=0 THEN
     DO
      ECOUNT=ECOUNT+1
      RETURNERROR(ASTOP)=TRUE
     END 
   END
   
  [END ACH ERROR CHECK]

 [draft error check]
 IF FORMTYPES(DRAFT)<>FALSE AND CONTINUE=TRUE THEN
  DO
   FOR T=1 TO MAXLINE
    DO
     IF TSELECT(T)=TRUE AND CHARACTERSEARCH(TXN(T,TTYPE),"Draft")>0 AND DPAYEE(T)="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(DMISSINGPAYEE)=TRUE
      END
    END  
   SELECTCOUNT=0 
   IF DRAFT1<>"" THEN SELECTCOUNT=SELECTCOUNT+1
   IF DRAFT2<>"" THEN SELECTCOUNT=SELECTCOUNT+1
   IF DRAFT3<>"" THEN SELECTCOUNT=SELECTCOUNT+1
   IF DRAFT4<>"" THEN SELECTCOUNT=SELECTCOUNT+1
   IF DRAFT5<>"" THEN SELECTCOUNT=SELECTCOUNT+1         
   IF SELECTCOUNT=0 THEN
    DO
     ECOUNT=ECOUNT+1
     RETURNERROR(DSELECT)=TRUE
    END
   IF DRAFT5<>"" AND [OTHER]
      DR1="" AND DR2="" THEN
    DO
     ECOUNT=ECOUNT+1
     RETURNERROR(DOTHER)=TRUE
    END
  END 
  
 [sig based error check]
[ IF FORMTYPES(SIGBASED)<>FALSE AND TEMAIL=TRUE THEN
  DO
   IF BUTTONCLICKED=0 THEN  [NEITHER FRAUD NOR DISPUTE SELECTED - NEED THIS SO PROPER FORM WILL EMAIL]
    DO
     ECOUNT=ECOUNT+1
     RETURNERROR(SCLAIMTYPE)=TRUE
    END   
  END]
 
 IF FORMTYPES(SIGBASED)<>FALSE AND CONTINUE=TRUE THEN
  DO
   IF BUTTONCLICKED=0 THEN  [NEITHER FRAUD NOR DISPUTE SELECTED]
    DO
     ECOUNT=ECOUNT+1
     RETURNERROR(SCLAIMTYPE)=TRUE
    END
   IF BUTTONCLICKED=1 THEN [FRAUD]
    DO
 
     NEEDSIGFRAUDCLAIM=TRUE  [ALWAYS CREATE A NEW SIG FRAUD CLAIM NUMBER]     
     IF SAPPENDCLAIM>0 AND SAPPENDCLAIM<99 THEN  
      DO
       SIGAPPEND=TRUE 
       TEMPCHAR=CLAIMNUM(SAPPENDCLAIM)
      [ GIVECREDIT(SIGBASED)=FALSE
       NOCREDITREASON(SIGBASED)="No automatic credits on appended claims"]   [removed this - now allowing credit on "appends"]
       IF SEGMENT(TEMPCHAR,8,8)="D" THEN SIGDISPUTECLAIM=TEMPCHAR
       IF SEGMENT(TEMPCHAR,8,8)="F" THEN SIGFRAUDCLAIM=TEMPCHAR
      END        
            
     IF FOUNDSIGFRAUDNOTE=TRUE AND SAPPENDCLAIM=0 THEN  [NO OPTION SELECTED]
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SCLAIMSELECT)=TRUE    
      END            
     IF SBSELECT1=0 THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SREQUESTED)=TRUE
      END      
     IF (SB2="" OR VALUE(SB2)=0) AND SBSELECT1=1 THEN  [MEMBER REQUESTED CARD BUT NO QTY ENTERED]
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SNUMCARDS)=TRUE
      END
     FOR L=1 TO LENGTH(SB2) 
      DO
       IF CHARACTERSEARCH("0123456789",SEGMENT(SB2,L,L))=0 THEN
        DO
         ECOUNT=ECOUNT+1
         RETURNERROR(SNUMCARDS)=TRUE
        END
      END
     IF SBSELECT3=0 THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SCARDWAS)=TRUE
      END
     IF SBSELECT4=0 THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SPOLICE)=TRUE
      END
     IF SBSELECT4=1 AND SB4="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SPOLICENUM)=TRUE
      END
     IF SB5="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SLOSSDATE)=TRUE
      END
     IF SB5<>"" AND
        DATEVALUE(SB5)<LOWDATE OR
        DATEVALUE(SB5)>HIGHDATE THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(BADDATE)=TRUE
      END   
     IF SB6="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SREPORTDATE)=TRUE
      END
     IF SB6<>"" AND
        DATEVALUE(SB6)<LOWDATE OR
        DATEVALUE(SB6)>HIGHDATE THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(BADDATE)=TRUE
      END      
     IF SB7="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SFRAUDDATE)=TRUE
      END
     IF SB7<>"" AND
        DATEVALUE(SB7)<LOWDATE OR
        DATEVALUE(SB7)>HIGHDATE THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(BADDATE)=TRUE
      END      
      
     IF FORMTYPES(SIGBASED)>18 THEN  [TOO MANY TXNS FOR FORM]
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SFTOOMANYTXNS)=TRUE 
      END
    [sb8-13 are not validated for blank entries; are "if known" fields]           
    
    [validate phone number format if entered]
     IF SB9<>"" THEN
      DO
       FOR L=1 TO LENGTH(SB9) 
        DO
         IF CHARACTERSEARCH("0123456789()-+",SEGMENT(SB9,L,L))=0 THEN
          DO
           ECOUNT=ECOUNT+1
           RETURNERROR(BADPHONE)=TRUE
          END
        END 
      END   
    
    END  [SIG BASED FRAUD]
   IF BUTTONCLICKED=2 THEN [DISPUTE]
    DO
     NEEDSIGDISPUTECLAIM=TRUE  [THIS WILL TRIGGER CREATION OF A NEW SIG DISPUTE CLAIM NUMBER]
    
     IF SAPPENDCLAIM>0 AND SAPPENDCLAIM<99 THEN [IS APPENDING]
      DO
       SIGAPPEND=TRUE 
       TEMPCHAR=CLAIMNUM(SAPPENDCLAIM)
       [GIVECREDIT(SIGBASED)=FALSE
       NOCREDITREASON(SIGBASED)="No automatic credits on appended claims"]
       IF SEGMENT(TEMPCHAR,8,8)="D" THEN SIGDISPUTECLAIM=TEMPCHAR
       IF SEGMENT(TEMPCHAR,8,8)="F" THEN SIGFRAUDCLAIM=TEMPCHAR
      END        
     
     IF FOUNDSIGDISPUTENOTE=TRUE AND SAPPENDCLAIM=0 THEN  [NO OPTION SELECTED]
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SCLAIMSELECT)=TRUE    
      END  
      
     IF FORMTYPES(SIGBASED)>28 THEN  [TOO MANY TXNS FOR FORM]
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SDTOOMANYTXNS)=TRUE 
      END 
      
     FOR T=1 TO 200
      DO
       IF CHARACTERSEARCH(TXN(T,TTYPE),"Signature")>0  AND
          MONEY(VALUE(TXN(T,TDAMT)))>MONEY(VALUE(TXN(T,TAMT))) THEN
        DO
         ECOUNT=ECOUNT+1
         RETURNERROR(SDISPUTEAMT)=TRUE
        END
      END                            
    END
   IF DISPUTEBUTTON=1 THEN  [BILLED MULTIPLE TIMES]
    DO
     IF SD01="" OR SD02="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SMULTI)=TRUE
      END
     IF SD02<>"" AND 
        DATEVALUE(SD02)<LOWDATE OR
        DATEVALUE(SD02)>HIGHDATE THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(BADDATE)=TRUE
      END      
    END
   IF DISPUTEBUTTON=6 THEN  [MEMBERSHIP CANCELLATION]
    DO
     IF SD06="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SCONTACT)=TRUE
      END
     IF SD06<>"" AND 
        DATEVALUE(SD06)<LOWDATE OR
        DATEVALUE(SD06)>HIGHDATE THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(BADDATE)=TRUE
      END      
     IF SD07="" THEN 
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SREASON)=TRUE
      END
     IF SD09="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SCANCELDATE)=TRUE
      END
     IF SD09<>"" AND 
        DATEVALUE(SD09)<LOWDATE OR
        DATEVALUE(SD09)>HIGHDATE THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(BADDATE)=TRUE
      END      
     IF SD10="" THEN
      DO 
       ECOUNT=ECOUNT+1
       RETURNERROR(SCANCELNUM)=TRUE
      END
     IF SDSELECT11=0 THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SCANCELPOLICY)=TRUE
      END
     IF SDSELECT11=1 AND SD12="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SMBRTOLD)=TRUE
      END
    END
   IF DISPUTEBUTTON=7 THEN   [MERCHANDISE RETURNED/DAMAGED/DEFECTIVE]
    DO
     IF SD14="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SPURCH)=TRUE
      END
     IF SD15="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SRECEIVED)=TRUE
      END
     IF SD16="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SRETREASON)=TRUE 
      END
     IF SD17="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SWHYBAD)=TRUE
      END
     IF SD18="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SMERCHRESPONSE)=TRUE
      END
    END
   IF DISPUTEBUTTON=8 THEN    [MERCH NOT RECEIVED]
    DO
     IF SD19="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SCONTACT)=TRUE
      END
     IF SD19<>"" AND 
        DATEVALUE(SD19)<LOWDATE OR
        DATEVALUE(SD19)>HIGHDATE THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(BADDATE)=TRUE
      END      
     IF SD20="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SMERCHOUTCOME)=TRUE
      END
     IF SD22="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SDELIVERY)=TRUE
      END
     IF SD22<>"" AND 
        DATEVALUE(SD22)<LOWDATE OR
        DATEVALUE(SD22)>HIGHDATE THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(BADDATE)=TRUE
      END      
     IF SD23="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SPICKUP)=TRUE
      END
     IF SD23<>"" AND 
        DATEVALUE(SD23)<LOWDATE OR
        DATEVALUE(SD23)>HIGHDATE THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(BADDATE)=TRUE
      END      
     IF SDSELECT24=0 THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SDIDCANCEL)=TRUE
      END
     IF SDSELECT24=1 AND SD25="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SCANCELDATE)=TRUE
      END
     IF SD25<>"" AND 
        DATEVALUE(SD25)<LOWDATE OR
        DATEVALUE(SD25)>HIGHDATE THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(BADDATE)=TRUE
      END      
     IF SDSELECT24=1 AND SD26="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SCANCELHOW)=TRUE
      END
     IF SD27="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SPURCH)=TRUE
      END
    END
   IF DISPUTEBUTTON=9 THEN  [PAID BY OTHER MEANS]
    DO
     IF SD03="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SCONTACT)=TRUE
      END
     IF SD03<>"" AND 
        DATEVALUE(SD03)<LOWDATE OR
        DATEVALUE(SD03)>HIGHDATE THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(BADDATE)=TRUE
      END      
     IF SD04="" THEN  
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SMERCHOUTCOME)=TRUE
      END
    END
   IF DISPUTEBUTTON=10 THEN  [HOTEL CANCELLATION]
    DO
     IF SDSELECT28=0 THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SCANCELPOLICY)=TRUE
      END
     IF SDSELECT28=1 AND SD29="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SPOLICY)=TRUE
      END
     IF SD30="" THEN
      DO 
       ECOUNT=ECOUNT+1
       RETURNERROR(SCANCELNUM)=TRUE
      END
     IF SD31="" THEN 
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SCANCELDATE)=TRUE
      END
     IF SD31<>"" AND 
        DATEVALUE(SD31)<LOWDATE OR
        DATEVALUE(SD31)>HIGHDATE THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(BADDATE)=TRUE
      END      
    END
   IF DISPUTEBUTTON=11 THEN [MEMBER DOESN'T RECOGNIZE TXN]
    DO
     IF SD32="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SCONTACT)=TRUE
      END
     IF SD32<>"" AND 
        DATEVALUE(SD32)<LOWDATE OR
        DATEVALUE(SD32)>HIGHDATE THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(BADDATE)=TRUE
      END      
     IF SD33="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(SMERCHOUTCOME)=TRUE
      END
    END  
    
   IF DISPUTEBUTTON=0 AND BUTTONCLICKED=2 THEN  [NOTHING WAS SELECTED]
    DO
     ECOUNT=ECOUNT+1
     RETURNERROR(SDISPUTETYPE)=TRUE
    END         
  END [SIG BASED ERROR CHECK, CONTINUE=TRUE]  

 [PIN BASED STUFF; ERROR CHECK, ETC.]
 [IF FORMTYPES(PINBASED)<>FALSE AND TEMAIL=TRUE THEN
  DO
   IF PBSELECT6=0 THEN    [DID NOT INDICATE FRAUD OR NOT - NEED THIS SO PROPER FORM LAUNCHES]
    DO
     ECOUNT=ECOUNT+1
     RETURNERROR(PTYPESELECT)=TRUE
    END  
  END ]
 
 
 
 IF FORMTYPES(PINBASED)<>FALSE AND CONTINUE=TRUE THEN
  DO

   NEEDPINCLAIM=TRUE  [ALWAYS CREATE A NEW PIN CLAIM NUMBER]
   
   IF PAPPENDCLAIM>0 AND PAPPENDCLAIM<99 THEN
    DO
     PINCLAIM=SEGMENT(CLAIMNUM(PAPPENDCLAIM),2,31)
     PINAPPEND=TRUE
     [GIVECREDIT(PINBASED)=FALSE
     NOCREDITREASON(PINBASED)="No automatic credits on appended claims"]
    END  
   
   IF SEGMENT(PINCLAIM,8,8)="F" AND
      PBSELECT6<>1 THEN     [IS NOT FRAUD]
    DO
     ECOUNT=ECOUNT+1
     RETURNERROR(PMISMATCH)=TRUE
    END
   IF SEGMENT(PINCLAIM,8,8)="D" AND
      PBSELECT6=1 THEN     [IS FRAUD]
    DO
     ECOUNT=ECOUNT+1
     RETURNERROR(PMISMATCH)=TRUE
    END    
   
   IF FOUNDPINNOTE=TRUE AND PAPPENDCLAIM=0 THEN  [NO OPTION SELECTED]
    DO
     ECOUNT=ECOUNT+1
     RETURNERROR(PCLAIMSELECT)=TRUE    
    END
    
   IF PBSELECT6=0 THEN
    DO
     ECOUNT=ECOUNT+1
     RETURNERROR(PTYPESELECT)=TRUE
    END
    
   IF PBDESC1="" AND PBDESC2="" AND PBDESC3="" THEN
    DO
     ECOUNT=ECOUNT+1
     RETURNERROR(PNODESC)=TRUE
    END 
    
   IF FORMTYPES(PINBASED)>29 THEN  [TOO MANY TXNS FOR FORM]
    DO
     ECOUNT=ECOUNT+1
     RETURNERROR(PTOOMANYTXNS)=TRUE 
    END    
    
   IF PBSELECT6=1 THEN  [YES - IS FRAUD; ONLY VALIDATE QUESTIONS IF FRAUD]
    DO
     IF PBSELECT1=0 THEN  [was card lost]
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(PLOST)=TRUE
      END 
     IF PBSELECT2=0 THEN  [WAS CARD STOLEN]
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(PSTOLEN)=TRUE
      END
     IF PBSELECT1=1 OR PBSELECT2=1 THEN  [CARD WAS EITHER LOST OR STOLEN; VALIDATE MORE QUESTIONS]
      DO
       IF PB2A1="" THEN
        DO
         ECOUNT=ECOUNT+1
         RETURNERROR(PDATE)=TRUE
        END
       IF PB2A1<>"" AND 
          DATEVALUE(PB2A1)<LOWDATE OR
          DATEVALUE(PB2A1)>HIGHDATE THEN
        DO
         ECOUNT=ECOUNT+1
         RETURNERROR(BADDATE)=TRUE
        END        
       IF PB2A2="" THEN
        DO
         ECOUNT=ECOUNT+1
         RETURNERROR(PTIME)=TRUE
        END
       IF PB2A3="" THEN
        DO
         ECOUNT=ECOUNT+1
         RETURNERROR(PLOCATION)=TRUE
        END
       IF PB2B="" THEN
        DO
         ECOUNT=ECOUNT+1
         RETURNERROR(PLASTAUTH)=TRUE
        END
       IF PB2B<>"" AND 
          DATEVALUE(PB2B)<LOWDATE OR
          DATEVALUE(PB2B)>HIGHDATE THEN
        DO
         ECOUNT=ECOUNT+1
         RETURNERROR(BADDATE)=TRUE
        END 
        
       [no validation for questions c & d]
       IF PB2E="" THEN
        DO
         ECOUNT=ECOUNT+1
         RETURNERROR(POTHER)=TRUE
        END
      END  [END OF QUESTIONS FOR IF LOST OR STOLEN = TRUE]
     IF PBSELECT3=0 THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(PINWITHCARD)=TRUE  
      END
     IF PBSELECT4=0 THEN  [WAS PIN WRITTEN DOWN]
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(PINWRITTEN)=TRUE
      END
     IF PBSELECT4=1 AND
        PB4B="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(PINWRITTENWHERE)=TRUE
      END
     IF PBSELECT5=0 THEN  [MBR AUTH SOMEONE ELSE TO USE CARD]
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(PCARDAUTH)=TRUE
      END
     IF PBSELECT5=1 AND
        PB5B="" THEN
      DO
       ECOUNT=ECOUNT+1
       RETURNERROR(PCARDWHO)=TRUE
      END
    END  [ERROR CHECK FRAUD QUESTIONS]
  END  [ERROR CHECK PIN BASED]   
 
 
[pdf email stuff - removed per ticket 25369
 IF TEMAIL=TRUE AND ECOUNT=0 THEN 
  DO
   CALL PREPFORMTYPES
   
   FOR T=1 TO 200
    DO    
     IF TSELECT(T)=TRUE THEN
      DO      
       IF CHARACTERSEARCH(TXN(T,TTYPE),"PIN")>0 THEN FORMTYPES(PINBASED)=FORMTYPES(PINBASED)+1
       IF CHARACTERSEARCH(TXN(T,TTYPE),"Signature")>0 THEN FORMTYPES(SIGBASED)=FORMTYPES(SIGBASED)+1
       IF CHARACTERSEARCH(TXN(T,TTYPE),"Research")>0 THEN FORMTYPES(RESHREQ)=TRUE
       IF CHARACTERSEARCH(TXN(T,TTYPE),"Draft")>0 THEN FORMTYPES(DRAFT)=FORMTYPES(DRAFT)+1
       IF CHARACTERSEARCH(TXN(T,TTYPE),"Unauthorized")>0 THEN FORMTYPES(ACH)=FORMTYPES(ACH)+1
       IF CHARACTERSEARCH(TXN(T,TTYPE),"Missing")>0 THEN FORMTYPES(ATMDEP)=TRUE
      END
    END
 
   IF FORMTYPES(ATMDEP)=TRUE OR  [SHOULDN'T BE]
      FORMTYPES(ACH)=TRUE OR     [COULD BE]
      FORMTYPES(DRAFT)=TRUE OR   [COULD BE]
      FORMTYPES(RESHREQ)=TRUE THEN  [SHOULDN'T BE]
    DO
     HTMLVIEWOPEN
     HTMLVIEWLINE("<HTML><HEAD><TITLE>Blank ACH/Draft forms</TITLE>")
     HTMLVIEWLINE("<STYLE>")
     HTMLVIEWLINE("</STYLE>")
     HTMLVIEWLINE("</HEAD>")
     HTMLVIEWLINE("<BODY BGCOLOR=WHITE>") 
     HTMLVIEWLINE("<CENTER><STRONG>Blank ACH/Draft forms</STRONG></CENTER><BR/><BR/>") 
     HTMLVIEWLINE("<BR/>")
     HTMLVIEWLINE("<CENTER>To print ")
     IF FORMTYPES(ACH)=FALSE OR FORMTYPES(DRAFT)=FALSE THEN HTMLVIEWLINE(" a ")
     HTMLVIEWLINE(" blank ")  
     IF FORMTYPES(ACH)=TRUE THEN HTMLVIEWLINE("Unauthorized ACH")
     IF FORMTYPES(ACH)=TRUE AND FORMTYPES(DRAFT)=TRUE THEN HTMLVIEWLINE(" and ")
     IF FORMTYPES(DRAFT)=TRUE THEN HTMLVIEWLINE("Sharedraft Affidavit")
     IF FORMTYPES(ACH)=TRUE AND FORMTYPES(DRAFT)=TRUE THEN 
      HTMLVIEWLINE(" forms, ")
     ELSE
      HTMLVIEWLINE(" form, ")
     HTMLVIEWLINE("please go to the Electronic Services Department Page.</CENTER>")
     HTMLVIEWLINE("<BR/><br/>") 
     HTMLVIEWLINE("</BODY>")
     HTMLVIEWDISPLAY 
    END  [HANDLING FOR FORMS BESIDES SIG-BASED & PIN-BASED]     
 
   IF FORMTYPES(PINBASED)<>FALSE OR FORMTYPES(SIGBASED)<>FALSE THEN
    DO
     CALL PREPFOREMAIL
     IF ACCOUNT:TYPE=8 THEN 
      FORMTYPE=BUSINESS
     ELSE
      FORMTYPE=CONSUMER
     
     IF FORMTYPES(PINBASED)<>FALSE THEN
      DO
       IF PBSELECT6=1 THEN FORMTOSEND=PINFRAUD 
       IF PBSELECT6=2 THEN FORMTOSEND=PINNONFRAUD      
       CALL LAUNCHEMAILTEMPLATE
       CALL EMAILNOTE       
      END
      
     IF FORMTYPES(SIGBASED)<>FALSE THEN
      DO
       IF BUTTONCLICKED=1 THEN FORMTOSEND=SIGFRAUD
       IF BUTTONCLICKED=2 THEN FORMTOSEND=SIGNONFRAUD   
       CALL LAUNCHEMAILTEMPLATE
       CALL EMAILNOTE          
      END            

     SCREENORD=0
     ALLDONE=TRUE
    END 
 
  END  TEMAIL/VEMAIL LOOP - removed per ticket 25369] 
 
 IF CONTINUE=TRUE AND ECOUNT>0 THEN
  DO
   SCREENORD=3  [STAY ON THIS SCREEN]
  END
  
 IF CONTINUE=TRUE AND ECOUNT=0 THEN
  DO
   IF NEEDPINCLAIM=TRUE OR
      NEEDSIGFRAUDCLAIM=TRUE OR
      NEEDSIGDISPUTECLAIM=TRUE THEN 
    CALL CREATECLAIMNUMBER
   SCREENORD=4
  END
  
 IF GOBACK=TRUE THEN SCREENORD=2
 
 IF GOWAYBACK=TRUE THEN SCREENORD=1
 
 IF EXIT=TRUE THEN 
  DO
   ALLDONE=TRUE
   SCREENORD=0 
  END
  
END  [GETPOSTBACK 3]

PROCEDURE GETPOSTBACK4
 SCREENORD=0
 ALLDONE=TRUE
END  [GETPOSTBACK99]

PROCEDURE GETPOSTBACK99
 SCREENORD=0
 ALLDONE=TRUE
END  [GETPOSTBACK99]



 #INCLUDE"SW.DISPUTE.PRO"


[INCLUDES FOR SYMFORMS BEGIN HERE]
  #INCLUDE "RD.SYMFORM.PRO"
  #INCLUDE "RD.NAME.AND.ACCOUNT.PRO"
  #INCLUDE "RD.STICKYNOTESACCOUNT.PRO"
  #INCLUDE "SW.SYMFORM.PROC"
  #INCLUDE "DISPUTE.SYMFORM.PROC"
  
  #INCLUDE "AS1307.DRIVER"  
  #INCLUDE "AS1307.INC"
  #INCLUDE "AS1307.SYMFORM"
  
  #INCLUDE "AS1312.DRIVER"  
  #INCLUDE "AS1312.INC"
  #INCLUDE "AS1312.SYMFORM"  
  
  #INCLUDE "AS1310.DRIVER"  
  #INCLUDE "AS1310.INC"
  #INCLUDE "AS1310.SYMFORM" 
  
  #INCLUDE "AS1306.DRIVER"  
  #INCLUDE "AS1306.INC"
  #INCLUDE "AS1306.SYMFORM"  
  
  #INCLUDE "LP1311.DRIVER"
  #INCLUDE "LP1311.INC"
  #INCLUDE "LP1311.SYMFORM"  

  #INCLUDE "LP1308.DRIVER"
  #INCLUDE "LP1308.INC"
  #INCLUDE "LP1308.SYMFORM"
